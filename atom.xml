<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>BoobooWei</title>
  
  <subtitle>A fast, simple &amp; powerful blog framework powered by Node.js.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.toberoot.com/"/>
  <updated>2020-10-14T03:19:37.753Z</updated>
  <id>http://www.toberoot.com/</id>
  
  <author>
    <name>é­äºšè</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ€è€ƒï¼šèŠä¸€èŠæ²»ç—…æ•‘äººä¸ç³»ç»Ÿè¿ç»´</title>
    <link href="http://www.toberoot.com/news/2020/10/14/devops-thinking/"/>
    <id>http://www.toberoot.com/news/2020/10/14/devops-thinking/</id>
    <published>2020-10-14T00:00:00.000Z</published>
    <updated>2020-10-14T03:19:37.753Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h1><p>æ²»ç—…æ•‘äººï¼Œè¯Šæ²»å¯¹è±¡ï¼šäººç±»ï¼›ä»·å€¼ï¼šâ€ç”Ÿå‘½â€œ æ— ä»·ï¼›è¯Šæ²»æ–¹æ³•ï¼šåŒ»ç”Ÿå’ŒåŒ»ç–—è®¾å¤‡<br>ç³»ç»Ÿè¿ç»´ï¼Œè¯Šæ²»å¯¹è±¡ï¼šç³»ç»Ÿï¼›ä»·å€¼ï¼šâ€ç”Ÿå‘½â€œ æ— ä»·ï¼›è¯Šæ²»æ–¹æ³•ï¼šè¿ç»´äººå‘˜å’Œè¿ç»´ç³»ç»Ÿ</p><p>æˆ‘å°†ä» ä¸ºä»€ä¹ˆè¦è¯Šæ²»ï¼Ÿè¯Šæ²»çš„æ˜¯è°ï¼Ÿ å¦‚ä½•è¯Šæ²»ï¼Ÿä¸‰ä¸ªæ–¹é¢æ¥å¯¹æ¯”æ€è€ƒã€‚</p><h1 id="è¯Šæ²»çš„ä»·å€¼"><a href="#è¯Šæ²»çš„ä»·å€¼" class="headerlink" title="è¯Šæ²»çš„ä»·å€¼"></a>è¯Šæ²»çš„ä»·å€¼</h1><ul><li><p>äººç±»æ˜¯åŸºå› çš„ç§‘æŠ€äº§ç‰©</p></li><li><p>ç³»ç»Ÿæ˜¯äººç±»çš„ç§‘æŠ€äº§ç‰©</p></li></ul><blockquote><p> ç†è§£äº†ç”Ÿç‰©ä½“å’ŒåŸºå› çš„å…³ç³»ï¼Œæˆ‘ä»¬ä¼šæ›´å¥½åœ°ç†è§£ç§‘æŠ€å’Œäººçš„å…³ç³»ã€‚æ¨èã€Šè‡ªç§çš„åŸºå› ã€‹ï¼Œå¯ä»¥å¸®æˆ‘ä»¬æ›´æ·±åˆ»åœ°ç†è§£ç”Ÿå‘½çš„å®šä¹‰ã€‚ç”Ÿå‘½çš„å†…æ ¸æ˜¯åŸºå› ï¼Œä¸€ç»„ä¿¡æ¯ç¼–ç ã€‚åŸºå› è‡ªæœ‰å…¶æ„å¿—ï¼Œç”Ÿç‰©çš„å¾ˆå¤šè¡Œä¸ºå¯¹å…¶è‡ªèº«æ˜¯ç—›è‹¦çš„ï¼Œä½†å¯¹åŸºå› æœ‰åˆ©ï¼Œæ¯”å¦‚è³è‚çš„è‡ªæˆ‘ç‰ºç‰²ï¼Œå†æ¯”å¦‚èŠ‚è‚²æªæ–½å‘æ˜å‰ï¼Œå¤šå°‘ç©·äººå…»ä¸èµ·å­©å­ï¼Œæ ¹æœ¬ä¸æƒ³ç”Ÿé‚£ä¹ˆå¤šå­©å­ï¼Œå´ä¸æ–­ç”Ÿå‡ºå­©å­ã€‚</p></blockquote><p>æ¢ä¸ªè§†è§’ï¼Œç”Ÿç‰©ä½“ç”¨ç´«è‰²ç´ è·å¾—è§†è§‰ã€ç”¨ç‰™é½¿è·å¾—åš¼ç¢é£Ÿç‰©åŠŸèƒ½ï¼Œä½•å°ä¸æ˜¯ç§‘æŠ€ï¼Ÿåªä¸è¿‡ï¼Œè¿™ç§ç§‘æŠ€ä¸æ˜¯ç”¨ä¹¦æœ¬è®°å½•ï¼Œè€Œæ˜¯ç”¨åŸºå› è®°å½•ã€‚ä¸æ˜¯é å­¦æœ¯è®ºæ–‡å‡çº§ï¼Œè€Œæ˜¯é ç‰©ç§ç«äº‰å‡çº§ã€‚ç§‘æŠ€ï¼Œè¿™æ ·çœ‹ï¼Œç”šè‡³å¹¶éæºäºäººç±»ï¼Œå®ƒå’ŒåŸºå› åƒæ˜¯ä¸¤ç§æ›´å¤è€å’Œæ’ä¹…çš„ç”Ÿå‘½ã€‚</p><p>åŸºå› è®¤ä¸ºäººç±»æ´»ç€æœ€é‡è¦ï¼Œäººç±»è®¤ä¸ºç³»ç»ŸæœåŠ¡é«˜å¯ç”¨å’Œæ•°æ®é«˜å¯é æ€§æœ€é‡è¦ã€‚</p><h1 id="è¯Šæ²»çš„å¯¹è±¡"><a href="#è¯Šæ²»çš„å¯¹è±¡" class="headerlink" title="è¯Šæ²»çš„å¯¹è±¡"></a>è¯Šæ²»çš„å¯¹è±¡</h1><blockquote><p>äººè‹¥ä½œä¸ºç¤¾ä¼šå·¥å…·æ¥çœ‹ï¼Œå·¥ä½œç§ç±»çš„ä¸åŒï¼Œç¤¾ä¼šåœ°ä½ä¹Ÿä¸åŒï¼Œäº§ç”Ÿçš„ç¤¾ä¼šä»·å€¼å„ä¸ç›¸åŒï¼Œæ¯”è¾ƒä»·å€¼æ²¡æœ‰æ„ä¹‰ï¼›</p><p>ç³»ç»ŸåŒæ ·ä¹Ÿæ˜¯ä¸€ç§å·¥å…·ï¼Œå¯èƒ½æ˜¯æœåŠ¡äºå…¬ç›Šçš„ï¼Œå¯èƒ½æ˜¯æœåŠ¡äºæŸä¸ªå…¬å¸èµšé’±çš„ï¼Œè¿™ä¸ªä»·å€¼ä¹Ÿæ˜¯ä¸èƒ½æ¯”è¾ƒçš„ã€‚</p></blockquote><p>æœ‰äººä¼šè¯´ï¼Œæˆ‘ç»´æŠ¤çš„æ˜¯é“¶è¡Œç³»ç»Ÿå…¨ä¸–ç•Œçš„äººéƒ½ä¼šç”¨åˆ°ï¼Œä½ ç»´æŠ¤çš„æ˜¯ä¸ªåŠå…¬OAç³»ç»Ÿï¼Œé“¶è¡Œç³»ç»Ÿçš„ä»·å€¼æ¯”OAç³»ç»Ÿçš„ä»·å€¼å¥½å¤šäº†ã€‚ä»æœåŠ¡çš„é«˜å¯ç”¨å’Œæ•°æ®çš„é«˜å¯é æ€§ä¸Šå»æ¯”è¾ƒä¸€ä¸‹ã€‚é“¶è¡Œç³»ç»Ÿä¸­æ–­1åˆ†é’Ÿå°†ä¼šå¸¦æ¥å¾ˆå¤§çš„æŸå¤±ï¼Œè€ŒOAç³»ç»Ÿæ–­ä¸ªä¸€å¤©ä¹Ÿæ²¡äº‹ã€‚é“¶è¡Œæ•°æ®ä¸¢å¤±å’ŒOAçš„æ•°æ®ä¸¢å¤±å¸¦æ¥çš„å½±å“ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>ç³»ç»Ÿå’Œäººä»æŸç§æ„ä¹‰ä¸Šæ¥çœ‹éƒ½æ˜¯å·¥å…·ã€‚å¯¹äºç¤¾ä¼šçš„ä»·å€¼ä¹Ÿç”±å„è‡ªçš„å·¥å…·å±æ€§å†³å®šäº†ä»·å€¼çš„ä¸åŒï¼Œæ³¨æ„æ˜¯ä¸åŒï¼Œ ä¸æ˜¯ä»·å€¼é«˜ä½ã€‚</p><p>ä¸Šé¢çš„å°æ•…äº‹ä¸­ï¼ŒAéƒ½ç”¨ç°é‡‘é“¶è¡Œç³»ç»ŸæŒ‚äº†å’Œä»–ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯OAç³»ç»Ÿä¸­æœ‰ä»–åˆšåˆšç”³è¯·çš„åˆåŒæµç¨‹ï¼Œç­‰ç€å®¡æ‰¹ï¼Œé‚£ä½ è¯´è¿™ä¸¤ä¸ªç³»ç»Ÿå“ªä¸ªä»·å€¼å¯¹Aæ¥è¯´æ›´é«˜ã€‚</p><p><strong>ä»·å€¼ï¼Œæ˜¯å®¢ä½“çš„å¯¹ä¸»ä½“è€Œè¨€çš„ä»·å€¼ã€‚</strong></p><h1 id="è¯Šæ²»æ–¹æ³•"><a href="#è¯Šæ²»æ–¹æ³•" class="headerlink" title="è¯Šæ²»æ–¹æ³•"></a>è¯Šæ²»æ–¹æ³•</h1><blockquote><p> æ²»ç—…æ•‘äººçš„å‘å±•å†å²è¦æ¯”ç³»ç»Ÿè¿ç»´çš„å†å²é•¿å¾—å¤šï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æ˜¯å¦æœ‰å¯å€Ÿé‰´çš„åœ°æ–¹ã€‚</p></blockquote><h2 id="æ¦‚å¿µå‚è€ƒ"><a href="#æ¦‚å¿µå‚è€ƒ" class="headerlink" title="æ¦‚å¿µå‚è€ƒ"></a>æ¦‚å¿µå‚è€ƒ</h2><p><strong>åŒ»å­¦</strong>æ˜¯é€šè¿‡ç§‘å­¦æˆ–æŠ€æœ¯çš„æ‰‹æ®µå¤„ç†äººä½“çš„å„ç§ç–¾ç—…æˆ–ç—…å˜çš„å­¦ç§‘ã€‚å®ƒæ˜¯ç”Ÿç‰©å­¦çš„åº”ç”¨å­¦ç§‘ï¼Œåˆ†åŸºç¡€åŒ»å­¦ã€ä¸´åºŠåŒ»å­¦ã€‚ä»è§£å‰–å±‚é¢å’Œåˆ†å­é—ä¼ å±‚é¢æ¥å¤„ç†äººä½“ç–¾ç—…çš„é«˜çº§ç§‘å­¦ã€‚å®ƒæ˜¯ä¸€ä¸ªä»é¢„é˜²åˆ°æ²»ç–—ç–¾ç—…çš„ç³»ç»Ÿå­¦ç§‘ï¼Œç ”ç©¶é¢†åŸŸå¤§æ–¹å‘åŒ…æ‹¬åŸºç¡€åŒ»å­¦ã€ä¸´åºŠåŒ»å­¦ã€æ³•åŒ»å­¦ã€æ£€éªŒåŒ»å­¦ã€é¢„é˜²åŒ»å­¦ã€ä¿å¥åŒ»å­¦ã€åº·å¤åŒ»å­¦ç­‰ã€‚</p><p>ä»¥ä¸‹ä»…ä¸ºä¸ªäººå‚è€ƒåŒ»å­¦æ€è€ƒè€Œå¾—çš„â€œè¿ç»´å­¦â€æ¦‚å¿µã€‚ğŸ˜„</p><p><strong>â€œè¿ç»´å­¦â€</strong>æ˜¯é€šè¿‡ç§‘å­¦æˆ–æŠ€æœ¯çš„æ‰‹æ®µå¤„ç†ç³»ç»Ÿçš„å„ç§æ•…éšœæˆ–ç“¶é¢ˆçš„å­¦ç§‘ã€‚å®ƒæ˜¯è®¡ç®—æœºçš„åº”ç”¨å­¦ç§‘ï¼Œåˆ†åŸºç¡€è®¡ç®—æœºç§‘å­¦ã€ç”Ÿäº§è¿ç»´å­¦ã€æ¶æ„ä¼˜åŒ–å­¦ã€è‡ªåŠ¨åŒ–è¿ç»´å­¦ã€é¢„é˜²è¿ç»´å­¦ã€ä¿å¥è¿ç»´å­¦ã€åº·å¤è¿ç»´å­¦ã€‚ä¸€ä¸ªä»é¢„é˜²åˆ°æ²»ç–—çš„ç³»ç»Ÿå­¦ç§‘ã€‚</p><h2 id="å­¦ä¹ æ¸ é“"><a href="#å­¦ä¹ æ¸ é“" class="headerlink" title="å­¦ä¹ æ¸ é“"></a>å­¦ä¹ æ¸ é“</h2><p>è¿ç»´ï¼Œç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿå‘å±•åˆ°ä¸€ä¸ªå­¦ç§‘çš„åœ°æ­¥ï¼Œè‡³å°‘å¤§å­¦ä¸­è¿˜æ²¡æœ‰åƒåŒ»å­¦é‚£æ ·æœ‰ä¸“ä¸šçš„è¿ç»´é™¢æ ¡ï¼Œè¿ç»´ä¸“ä¸šã€‚ç›®å‰å¤§å­¦ä¸­è¿˜æ˜¯è®¡ç®—æœºåŸºç¡€å­¦ç§‘å’Œè®¡ç®—æœºè½¯ä»¶å ä¸»æµã€‚æ„Ÿè§‰å°±åƒæ˜¯å¤§å®¶åªå­¦ä¹ äººä½“ç»„æˆï¼Œé€ äººæŠ€æœ¯ï¼Œå’Œè®©äººåšå·¥çš„å­¦é—®ï¼Œå´ä¸ç ”ç©¶äººç”Ÿç—…å’Œæˆé•¿çš„é—®é¢˜ã€‚<br>ç›¸ä¿¡å°†æ¥ä¸€å®šä¼šæœ‰çš„ï¼<br>ç›®å‰å­¦ä¹ è¿ç»´ä¸»è¦æ˜¯ç¤¾ä¼šåŸ¹è®­æœºæ„å’Œå…¬å¸å®é™…ç”Ÿäº§ç§¯ç´¯ã€‚</p><h2 id="äººä¸ç³»ç»Ÿ"><a href="#äººä¸ç³»ç»Ÿ" class="headerlink" title="äººä¸ç³»ç»Ÿ"></a>äººä¸ç³»ç»Ÿ</h2><p>æˆ‘å°è¯•ä»<strong>åŒ»ç”Ÿ</strong>ä¸<strong>åŒ»ç–—è®¾å¤‡</strong>æ¥çœ‹<strong>è¿ç»´äººå‘˜</strong>ä¸<strong>è¿ç»´ç³»ç»Ÿ</strong>çš„å…³ç³»ã€‚</p><blockquote><p>åŒ»ç”Ÿä¸ç°ä»£åŒ»ç–—å™¨æ¢°å“ªä¸ªæ–¹é¢æ›´é‡è¦ï¼Ÿ<br>è¿ç»´äººå‘˜ä¸è¿ç»´ç³»ç»Ÿå“ªä¸ªæ›´é‡è¦ï¼Ÿ</p></blockquote><p>åœ¨ç›®å‰çš„ç§‘æŠ€å’Œäººæ–‡æ¡ä»¶ä¸‹ï¼ŒçŸ­æ—¶é—´å†…äºŒè€…æ— æ³•ç›¸äº’å–ä»£ã€‚</p><p>åŒ»ç”Ÿå’ŒåŒ»ç–—è®¾å¤‡çš„å…³ç³»ï¼šåŒ»ç”Ÿè´Ÿè´£é€šè¿‡è‡ªå·±çš„çŸ¥è¯†å’Œç»éªŒæ¥å†³å®šæ‚£è€…åº”è¯¥è¿›è¡Œå“ªäº›ä»ªå™¨çš„æ£€æŸ¥ï¼Œå…ˆè¿›çš„åŒ»ç–—å™¨æ¢°è´Ÿè´£å°†ä¼ ç»ŸæŸ¥ä½“å‘ç°ä¸äº†çš„å’Œæ— æ³•å‡†ç¡®è¿›è¡Œæ€§è´¨åŒºåˆ†çš„ç—…å˜æ¸…æ™°çš„ã€å‡†ç¡®çš„æ˜¾ç¤ºå‡ºæ¥ï¼Œå†ç”±åŒ»ç”Ÿå¯¹æœºå™¨ç»™å‡ºçš„ç»“æœè¿›è¡Œåˆ¤è¯»å’Œåˆ†æã€‚<br>åœ¨ç›®å‰çš„ç§‘æŠ€å’Œäººæ–‡æ¡ä»¶ä¸‹ï¼ŒçŸ­æ—¶é—´å†…äºŒè€…æ— æ³•ç›¸äº’å–ä»£ã€‚</p><p>æˆ‘ä»¬å†çœ‹çœ‹è¿ç»´äººå‘˜å’Œè¿ç»´ç³»ç»Ÿ</p><ol><li>è¿ç»´äººå‘˜è´Ÿè´£é€šè¿‡è‡ªå·±çš„çŸ¥è¯†å’Œç»éªŒæ¥å†³å®šæ‚£è€…åº”è¯¥è¿›è¡Œå“ªäº›ç³»ç»Ÿçš„æ£€æŸ¥ã€‚ç”±äºè½¯ä»¶ç³»ç»Ÿçš„å¤æ‚åº¦ç›®å‰è¿˜æ²¡æœ‰èƒ½å¤Ÿåƒäººç±»ç”Ÿå‘½ç³»ç»Ÿé‚£ä¹ˆå¤æ‚ï¼Œå› æ­¤ä½œå‡ºä¸€ä¸ªå…¨é¢æ£€æŸ¥çš„ç³»ç»Ÿè¿˜æ˜¯å¯è¡Œçš„ï¼Œå°†æ¥è¿™éƒ¨åˆ†çš„å·¥ä½œäº¤ç»™ç³»ç»Ÿå»å®Œæˆå³å¯ã€‚</li><li>å…ˆè¿›çš„è¿ç»´ç³»ç»Ÿè´Ÿè´£å°†ä¼ ç»ŸæŸ¥ä½“å‘ç°ä¸äº†çš„å’Œæ— æ³•å‡†ç¡®è¿›è¡Œæ€§è´¨åŒºåˆ†çš„ç—…å˜æ¸…æ™°çš„ã€å‡†ç¡®çš„æ˜¾ç¤ºå‡ºæ¥ï¼Œå†ç”±è¿ç»´äººå‘˜å¯¹æœºå™¨ç»™å‡ºçš„ç»“æœè¿›è¡Œåˆ¤è¯»å’Œåˆ†æã€‚</li></ol><p>ä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤æˆ‘ä»¬ç®€å•åˆ’åˆ†ä¸º è¯Šæ–­ å’Œ æ²»ç–—ã€‚</p><p>è¯Šæ–­æ˜¯æ²»ç–—çš„å‰æï¼Œä½†æ˜¯å•è¯Šæ–­å‡ºé—®é¢˜å´æ— æ³•æ²»ç–—ä¹Ÿæ˜¯å¾’åŠ³ã€‚æ‰€ä»¥äºŒè€…ç›¸è¾…ç›¸æˆï¼Œæ²¡æœ‰ä»·å€¼çš„é«˜ä½ä¹‹åˆ†ã€‚</p><p>ä¸ªäººè€Œè¨€ï¼Œæˆ‘ä¹æ„æé«˜è¿ç»´å·¥å…·çš„èƒ½åŠ›å°†è¯Šæ–­çš„äº‹æƒ…äº¤ç»™æ•ˆç‡æ›´é«˜çš„å·¥å…·æ¥åšï¼Œä¸”èŠ±æ›´å¤šçš„æ—¶é—´å»é’»ç ”â€œæ²»ç–—â€æé«˜è§£å†³ç–‘éš¾æ‚ç—‡çš„èƒ½åŠ›ä»¥åŠä¸šåŠ¡ç³»ç»Ÿä¼˜åŒ–èƒ½åŠ›ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>äº§å“èƒ½æ‹¿ä¸‹èèµ„ï¼Œæ˜¯å› ä¸ºå¯¹äºæŠ•èµ„äººæ¥è¯´ä»–ä»¬è®¤ä¸ºè¿ç»´ç³»ç»Ÿå¯¹ä»–ä»¬æœ‰ä»·å€¼ã€‚</p><p>ä½†ä¸èƒ½ä»£è¡¨è¿ç»´äººå‘˜å¯¹äºå…¶ä»–äººéƒ½æ˜¯æ²¡æœ‰ä»·å€¼çš„ã€‚äººçš„ä»·å€¼è§‚ä¸åŒè€Œå·²ã€‚è¿ç»´äººå‘˜ä¸è¿ç»´ç³»ç»Ÿç›¸è¾…ç›¸æˆã€‚</p><h2 id="å…³äºè‡ªå·±"><a href="#å…³äºè‡ªå·±" class="headerlink" title="å…³äºè‡ªå·±"></a>å…³äºè‡ªå·±</h2><ol><li>å¤§é‡å·¥ä½œæ”¾åœ¨å¦‚ä½•è‡ªåŠ¨åŒ–ï¼Œå¦‚ä½•è‡ªæ²»ç³»ç»Ÿè¿™è¾¹ï¼Œå‚ä¸ç¼–ç æˆ–è®¾è®¡å¹¶ä¼˜åŒ–å„ä¸ªç³»ç»Ÿã€‚</li><li>æ‹¥æŠ±å¼€æºå½¢æˆè‡ªèº«æŠ€æœ¯æ ˆï¼Œæ ‡å‡†åŒ–ä¸€äº›æŠ€æœ¯å»è§£å†³é—®é¢˜ã€‚</li><li>å°†å›½å¤–çš„SREæ€æƒ³å’Œå›½å†…çš„å®é™…ç›¸ç»“åˆï¼Œæ—¶åˆ»ä¿æŒå­¦ä¹ å’Œæ€»ç»“çš„å¿ƒæ€ï¼Œåšå¥½è‡ªå·±çš„å®šä½ã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h1&gt;&lt;p&gt;æ²»ç—…æ•‘äººï¼Œè¯Šæ²»å¯¹è±¡ï¼šäººç±»ï¼›ä»·å€¼ï¼šâ€ç”Ÿå‘½â€œ æ— ä»·ï¼›è¯Šæ²»æ–¹æ³•ï¼šåŒ»ç”Ÿå’ŒåŒ»ç–—è®¾å¤‡&lt;br&gt;ç³»ç»Ÿè¿ç»´ï¼Œè¯Šæ²»å¯¹è±¡ï¼šç³»ç»Ÿï¼›ä»·å€¼ï¼šâ€ç”Ÿå‘½â€œ æ— ä»·ï¼›è¯Šæ²»æ–¹æ³•ï¼šè¿
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Percona Toolkitå·¥å…·æ˜ç»†è¯´æ˜</title>
    <link href="http://www.toberoot.com/news/2020/09/26/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/09/26/tec-mysql/</id>
    <published>2020-09-26T00:00:00.000Z</published>
    <updated>2020-09-01T06:00:10.672Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚"><a href="#æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚" class="headerlink" title="æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚"></a>æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚</h1><table><thead><tr><th>æ•°æ®åº“</th><th>ç‰ˆæœ¬</th><th><em>Percona Toolkit ç‰ˆæœ¬ï¼ˆé‡‡ç”¨æœ€æ–°å°ç‰ˆæœ¬ï¼‰</em></th><th><em>Percona Toolkit å°ç‰ˆæœ¬</em>è¦æ±‚</th></tr></thead><tbody><tr><td>MySQL</td><td>5.5</td><td><em>Percona Toolkit 2.2</em></td><td><em>Percona Toolkit 2.2.1ä»¥ä¸Šç‰ˆæœ¬</em></td></tr><tr><td>MySQL</td><td>5.6</td><td><em>Percona Toolkit 2.2</em></td><td><em>Percona Toolkit 2.2.1ä»¥ä¸Šç‰ˆæœ¬</em></td></tr><tr><td>MySQL</td><td>5.7</td><td><em>Percona Toolkit 2.2</em></td><td><em>Percona Toolkit 2.2.17ä»¥ä¸Šç‰ˆæœ¬</em></td></tr><tr><td>MySQL</td><td>8.0</td><td><em>Percona Toolkit 3.0</em></td><td><em>Percona Toolkit 3.0.1</em></td></tr><tr><td>MariaDB</td><td>MariaDB 10.4</td><td><em>Percona Toolkit 3.0</em></td><td><em>Percona Toolkit 3.2.0</em></td></tr></tbody></table><ul><li><a href="https://www.percona.com/doc/percona-toolkit/LATEST/release_notes.html#v0-9-5-released-2011-08-04" rel="external nofollow noreferrer">Percona Toolkitè¿­ä»£æ—¥å¿—</a></li><li><a href="https://www.percona.com/services/policies/percona-software-platform-lifecycle" rel="external nofollow noreferrer">Percona Toolkitæ”¯æŒçš„å¹³å°å’Œç‰ˆæœ¬</a></li></ul><h1 id="Percona-Toolkitå·¥å…·ç»†èŠ‚è¯´æ˜"><a href="#Percona-Toolkitå·¥å…·ç»†èŠ‚è¯´æ˜" class="headerlink" title="Percona Toolkitå·¥å…·ç»†èŠ‚è¯´æ˜"></a>Percona Toolkitå·¥å…·ç»†èŠ‚è¯´æ˜</h1><p>Percona Toolkit å·¥å…·æ‰§è¡Œéœ€è¦ä¸¤ä¸ªç”¨æˆ·ï¼š</p><ol><li><p>æ•°æ®åº“ç”¨æˆ·ï¼šæˆæƒå¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'solardb'</span>@<span class="string">'%'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'SolarDB@123'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'solardb'</span>@<span class="string">'%'</span> <span class="keyword">with</span> <span class="keyword">grant</span> options;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure></li><li><p>å·¥å…·æ¦‚è§ˆ</p></li></ol><p><a href="https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html" rel="external nofollow noreferrer">https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html</a></p><table><thead><tr><th>å·¥å…·å‘½ä»¤</th><th>å·¥å…·ä½œç”¨</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>å¼€å‘ç±»</td><td>pt-duplicate-key-checker</td><td>åˆ—å‡ºå¹¶åˆ é™¤é‡å¤çš„ç´¢å¼•å’Œå¤–é”®</td></tr><tr><td></td><td>pt-online-schema-change</td><td>åœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„</td></tr><tr><td></td><td>pt-query-advisor</td><td>åˆ†ææŸ¥è¯¢è¯­å¥ï¼Œå¹¶ç»™å‡ºå»ºè®®ï¼Œæœ‰bug å·²åºŸå¼ƒ</td></tr><tr><td></td><td>pt-show-grants</td><td>è§„èŒƒåŒ–å’Œæ‰“å°æƒé™</td></tr><tr><td></td><td>pt-upgrade</td><td>åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šæ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶æ¯”è¾ƒä¸åŒ</td></tr><tr><td>æ€§èƒ½ç±»</td><td>pt-index-usage</td><td>åˆ†ææ—¥å¿—ä¸­ç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‡ºæŠ¥å‘Š</td></tr><tr><td></td><td>pt-pmp</td><td>ä¸ºæŸ¥è¯¢ç»“æœè·Ÿè¸ªï¼Œå¹¶æ±‡æ€»è·Ÿè¸ªç»“æœ</td></tr><tr><td></td><td>pt-visual-explain</td><td>æ ¼å¼åŒ–æ‰§è¡Œè®¡åˆ’</td></tr><tr><td></td><td>pt-table-usage</td><td>åˆ†ææ—¥å¿—ä¸­æŸ¥è¯¢å¹¶åˆ†æè¡¨ä½¿ç”¨æƒ…å†µ pt 2.2æ–°å¢å‘½ä»¤</td></tr><tr><td>é…ç½®ç±»</td><td>pt-config-diff</td><td>æ¯”è¾ƒé…ç½®æ–‡ä»¶å’Œå‚æ•°</td></tr><tr><td></td><td>pt-mysql-summary</td><td>å¯¹mysqlé…ç½®å’Œstatusè¿›è¡Œæ±‡æ€»</td></tr><tr><td></td><td>pt-variable-advisor</td><td>åˆ†æå‚æ•°ï¼Œå¹¶æå‡ºå»ºè®®</td></tr><tr><td>ç›‘æ§ç±»</td><td>pt-deadlock-logger</td><td>æå–å’Œè®°å½•mysqlæ­»é”ä¿¡æ¯</td></tr><tr><td></td><td>pt-fk-error-logger</td><td>æå–å’Œè®°å½•å¤–é”®ä¿¡æ¯</td></tr><tr><td></td><td>pt-mext</td><td>å¹¶è¡ŒæŸ¥çœ‹statusæ ·æœ¬ä¿¡æ¯</td></tr><tr><td></td><td>pt-query-digest</td><td>åˆ†ææŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶äº§ç”ŸæŠ¥å‘Š å¸¸ç”¨å‘½ä»¤</td></tr><tr><td></td><td>pt-trend</td><td>æŒ‰ç…§æ—¶é—´æ®µè¯»å–slowæ—¥å¿—ä¿¡æ¯ å·²åºŸå¼ƒ</td></tr><tr><td>å¤åˆ¶ç±»</td><td>pt-heartbeat</td><td>ç›‘æ§mysqlå¤åˆ¶å»¶è¿Ÿ</td></tr><tr><td></td><td>pt-slave-delay</td><td>è®¾å®šä»è½åä¸»çš„æ—¶é—´</td></tr><tr><td></td><td>pt-slave-find</td><td>æŸ¥æ‰¾å’Œæ‰“å°æ‰€æœ‰mysqlå¤åˆ¶å±‚çº§å…³ç³»</td></tr><tr><td></td><td>pt-slave-restart</td><td>ç›‘æ§salveé”™è¯¯ï¼Œå¹¶å°è¯•é‡å¯salve</td></tr><tr><td></td><td>pt-table-checksum</td><td>æ ¡éªŒä¸»ä»å¤åˆ¶ä¸€è‡´æ€§</td></tr><tr><td></td><td>pt-table-sync</td><td>é«˜æ•ˆåŒæ­¥è¡¨æ•°æ®</td></tr><tr><td>ç³»ç»Ÿç±»</td><td>pt-diskstats</td><td>æŸ¥çœ‹ç³»ç»Ÿç£ç›˜çŠ¶æ€</td></tr><tr><td></td><td>pt-fifo-split</td><td>æ‹Ÿåˆ‡å‰²æ–‡ä»¶å¹¶è¾“å‡º</td></tr><tr><td></td><td>pt-summary</td><td>æ”¶é›†å’Œæ˜¾ç¤ºç³»ç»Ÿæ¦‚å†µ</td></tr><tr><td></td><td>pt-stalk</td><td>å‡ºç°é—®é¢˜æ—¶ï¼Œæ”¶é›†è¯Šæ–­æ•°æ®</td></tr><tr><td></td><td>pt-sift</td><td>æµè§ˆç”±pt-stalkåˆ›å»ºçš„æ–‡ä»¶ pt 2.2æ–°å¢å‘½ä»¤</td></tr><tr><td></td><td>pt-ioprofile</td><td>æŸ¥è¯¢è¿›ç¨‹IOå¹¶æ‰“å°ä¸€ä¸ªIOæ´»åŠ¨è¡¨ pt 2.2æ–°å¢å‘½ä»¤</td></tr><tr><td>å®ç”¨ç±»</td><td>pt-archiver</td><td>å°†è¡¨æ•°æ®å½’æ¡£åˆ°å¦ä¸€ä¸ªè¡¨æˆ–æ–‡ä»¶ä¸­</td></tr><tr><td></td><td>pt-find</td><td>æŸ¥æ‰¾è¡¨å¹¶æ‰§è¡Œå‘½ä»¤</td></tr><tr><td></td><td>pt-kill</td><td>Killæ‰ç¬¦åˆæ¡ä»¶çš„sql å¸¸ç”¨å‘½ä»¤</td></tr><tr><td></td><td>pt-align</td><td>å¯¹é½å…¶ä»–å·¥å…·çš„è¾“å‡º pt 2.2æ–°å¢å‘½ä»¤</td></tr><tr><td></td><td>pt-fingerprint</td><td>å°†æŸ¥è¯¢è½¬æˆå¯†æ–‡ pt 2.2æ–°å¢å‘½ä»¤</td></tr></tbody></table><h1 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h1><h2 id="åœ¨çº¿DDL"><a href="#åœ¨çº¿DDL" class="headerlink" title="åœ¨çº¿DDL"></a>åœ¨çº¿DDL</h2><p>æ³¨æ„:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. &#123;&#123; &#125;&#125; æˆ–è€… xxä»£è¡¨è¦ä¿®æ”¹çš„ä½ç½®</span><br><span class="line">2. --noversion-check å¦‚æœæ˜¯éåŸç”Ÿçš„MySQLï¼Œä¾‹å¦‚å„å¤§äº‘äº§å•†çš„ï¼Œå¿…é¡»è¦ä½¿ç”¨è¯¥å‚æ•°</span><br><span class="line">3. --charset=utf8 æ ¹æ®æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†é€‰æ‹©åˆé€‚çš„ï¼Œå¦åˆ™å®¹æ˜“é€ æˆä¹±ç </span><br><span class="line">4. --alter=<span class="string">"xxx,xxx,xxx"</span> ä¸€å¼ è¡¨å¤šä¸ªå˜æ›´ä½¿ç”¨é€—å·åˆ†å‰²</span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯ä¸€"><a href="#åœºæ™¯ä¸€" class="headerlink" title="åœºæ™¯ä¸€"></a>åœºæ™¯ä¸€</h3><blockquote class="note info"><p>ä¸€å¼ è¡¨å¤šä¸ªå˜æ›´</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@build-center cloudcare_dba]<span class="comment"># cat qinxi/alter_table_hana_20191126.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">host=xx</span><br><span class="line">port=xx</span><br><span class="line">dbname=xx</span><br><span class="line">user=xx</span><br><span class="line">password=xx</span><br><span class="line">  </span><br><span class="line">table=xx</span><br><span class="line">pt-online-schema-change --user=<span class="variable">$&#123;user&#125;</span> --port=<span class="variable">$&#123;port&#125;</span> --host=<span class="variable">$&#123;host&#125;</span> --password=<span class="variable">$&#123;password&#125;</span> --alter=<span class="string">"add column update_time timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,drop index IX_ST_ENTRY_DETAIL_SRCNO_DETAILID,drop index auto_shard_key_ORG_ID,drop index auto_shard_key_WAREHOUSE_ID,drop index IX_ST_ENTRY_DETAIL_ITEMCODE,drop index IX_ST_ENTRY_DETAIL_INOUT_TYPE,drop index IX_ST_ENTRY_DETAIL_TOP_ITEMTYPE_ID,drop index IX_SOURCE_RECEIPT_TYPE,drop index IX_ST_ENTRY_DETAIL_ET_OPER_TIME,drop index IX_ST_ENTRY_DETAIL_ET_CREATE_TIME,drop index IX_ST_ENTRY_DETAIL_CALCULATE_ID,add index index_item_code(ITEM_CODE),add index index_trunk_id(TRUNK_ID),add index index_receipt_id(SOURCE_RECEIPT_ID),add index index_oper_time(OPER_TIME),add index IX_st_entry_detail_et_SOURCE_RECEIPT_NO(SOURCE_RECEIPT_NO),add index IX_st_entry_detail_et_ORG_ID(ORG_ID),add index IX_st_entry_detail_et_WAREHOUSE_ID(WAREHOUSE_ID),add index index_update_time(update_time),add index IX_st_entry_detail_et_IS_BOX(IS_BOX),add index IX_st_entry_detail_et_SOURCE_RECEIPT_TYPE(SOURCE_RECEIPT_TYPE),add index IX_st_entry_detail_et_CREATE_TIME(CREATE_TIME)"</span> D=<span class="variable">$&#123;dbname&#125;</span>,t=<span class="variable">$&#123;table&#125;</span> --no-version-check --execute</span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯2"><a href="#åœºæ™¯2" class="headerlink" title="åœºæ™¯2"></a>åœºæ™¯2</h3><blockquote class="note info"><p>å¤šå¼ è¡¨å˜æ›´</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># pt-osc scripts</span></span><br><span class="line"><span class="comment"># &#123;&#123; time_string &#125;&#125;</span></span><br><span class="line"><span class="comment"># Solar æ··åˆäº‘ç®¡ç†å¹³å°     </span></span><br><span class="line">host=&#123;&#123; host &#125;&#125;</span><br><span class="line">port=&#123;&#123; port &#125;&#125;</span><br><span class="line">dbname=&#123;&#123; dbname &#125;&#125;</span><br><span class="line">user=&#123;&#123; user &#125;&#125;</span><br><span class="line">password=&#123;&#123; password &#125;&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">table=&#123;&#123; sql.table_name1 &#125;&#125;</span><br><span class="line">pt-online-schema-change --user=<span class="variable">$&#123;user&#125;</span> --port=<span class="variable">$&#123;port&#125;</span> --host=<span class="variable">$&#123;host&#125;</span> --password=<span class="variable">$&#123;password&#125;</span> --alter=<span class="string">"&#123;&#123; sql.alter_cmd &#125;&#125;"</span> D=<span class="variable">$&#123;dbname&#125;</span>,t=<span class="variable">$&#123;table&#125;</span> --no-version-check --execute --charset=utf8</span><br><span class="line"></span><br><span class="line">table=&#123;&#123; sql.table_name2 &#125;&#125;</span><br><span class="line">pt-online-schema-change --user=<span class="variable">$&#123;user&#125;</span> --port=<span class="variable">$&#123;port&#125;</span> --host=<span class="variable">$&#123;host&#125;</span> --password=<span class="variable">$&#123;password&#125;</span> --alter=<span class="string">"&#123;&#123; sql.alter_cmd &#125;&#125;"</span> D=<span class="variable">$&#123;dbname&#125;</span>,t=<span class="variable">$&#123;table&#125;</span> --no-version-check --execute --charset=utf8</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯2-1"><a href="#åœºæ™¯2-1" class="headerlink" title="åœºæ™¯2"></a>åœºæ™¯2</h3><blockquote class="note info"><p>ç”Ÿäº§ä½¿ç”¨çš„è‡ªåŠ¨ç”ŸæˆPTè„šæœ¬</p></blockquote><p>pythonè‡ªåŠ¨è½¬æ¢è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf8 -*-</span></span><br><span class="line"><span class="comment"># Build-in Modules</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3rd-part Modules</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sqlparse</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQLParseHelper</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    è§£æSQL</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sql_str=None, split_str=<span class="string">';'</span></span>):</span></span><br><span class="line">        self.sql_str = sql_str</span><br><span class="line">        self.split_str = split_str</span><br><span class="line">        self.sql_list = []</span><br><span class="line">        <span class="keyword">if</span> self.split_str == <span class="string">';'</span>:</span><br><span class="line">            <span class="comment"># print(sqlparse.split(self.sql_str))</span></span><br><span class="line">            self.sql_list = list(filter(</span><br><span class="line">                <span class="keyword">lambda</span> y: y != <span class="string">''</span>, sqlparse.split(self.sql_str)</span><br><span class="line">            ))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.sql_list = list(</span><br><span class="line">                filter(</span><br><span class="line">                    <span class="keyword">lambda</span> y: y != <span class="string">''</span>,</span><br><span class="line">                    map(<span class="keyword">lambda</span> x: x.strip(), self.sql_str.split(self.split_str))</span><br><span class="line">                ))</span><br><span class="line">        <span class="comment"># print(self.sql_list)</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_length</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        sqlæ–‡ä»¶ä¸­çš„SQLæ•°é‡</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> len(self.sql_list)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_format</span>(<span class="params">self, sql</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æ ¹æ®é€‰é¡¹æ ¼å¼åŒ–sqlã€‚</span></span><br><span class="line"><span class="string">        å¯ç”¨é€‰é¡¹è®°å½•åœ¨â€œ SQLè¯­å¥æ ¼å¼â€ä¸­ã€‚</span></span><br><span class="line"><span class="string">        é™¤æ ¼å¼åŒ–é€‰é¡¹å¤–ï¼Œè¯¥å‡½æ•°è¿˜æ¥å—å…³é”®å­—â€œ encodingâ€ï¼Œè¯¥å…³é”®å­—ç¡®å®šè¯­å¥çš„ç¼–ç ã€‚</span></span><br><span class="line"><span class="string">        è¿”å›å€¼ï¼š    æ ¼å¼åŒ–çš„SQLè¯­å¥ä¸ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        format_sql = sqlparse.format(sql, reindent=<span class="literal">True</span>, keyword_case=<span class="string">'upper'</span>, strip_comments=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># print(format_sql)</span></span><br><span class="line">        <span class="keyword">return</span> format_sql</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_init</span>(<span class="params">self, sql</span>):</span></span><br><span class="line">        tokens = []</span><br><span class="line">        parsed = sqlparse.parse(sql)</span><br><span class="line">        stmt = parsed[<span class="number">0</span>].tokens</span><br><span class="line">        <span class="keyword">for</span> token <span class="keyword">in</span> stmt:</span><br><span class="line">            tokens.append([token.ttype, token.value])</span><br><span class="line"> </span><br><span class="line">        sql = sqlparse.sql.Statement(stmt)</span><br><span class="line">        sql_type = sql.get_type()</span><br><span class="line">        <span class="keyword">return</span> sql_type, tokens</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_type</span>(<span class="params">self, tokens</span>):</span></span><br><span class="line">        <span class="comment"># print(tokens)</span></span><br><span class="line">        <span class="keyword">return</span> tokens[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>] <span class="keyword">if</span> len(tokens[<span class="number">0</span>][<span class="number">0</span>]) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">'Others'</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sql_statement</span>(<span class="params">self, tokens</span>):</span></span><br><span class="line">        <span class="keyword">return</span> tokens[<span class="number">0</span>][<span class="number">1</span>] <span class="keyword">if</span> len(tokens[<span class="number">0</span>]) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">'Others'</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_table</span>(<span class="params">self, tokens</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        å¦‚ä½•ä»tokensä¸­è·å–è¡¨åï¼Ÿ</span></span><br><span class="line"><span class="string">        :param tokens:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        tables = []</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æ‰¾åˆ° Keyword ä¸º TABLEçš„å…³é”®å­—çš„ç´¢å¼•ä½ + 2</span></span><br><span class="line">            sql_words = list(map(<span class="keyword">lambda</span> x: x[<span class="number">1</span>], tokens))</span><br><span class="line">            index_num = sql_words.index(<span class="string">'TABLE'</span>)</span><br><span class="line">            table = sql_words[index_num + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(str(e))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tables.append(table)</span><br><span class="line">        <span class="keyword">return</span> tables</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PTHelper</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sql</span>):</span></span><br><span class="line">        self.sql = sql</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">alter_sql_parse</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        å¯¹åŒä¸€å¼ è¡¨æŒ‰ç…§åŸæ¥çš„è¯­å¥é¡ºåºç”¨é€—å·è¿æ¥,æ‰€æœ‰åŒå¼•å·æ›¿æ¢ä¸ºå•å¼•å·</span></span><br><span class="line"><span class="string">        [</span></span><br><span class="line"><span class="string">                &#123;"table_name": "frm_user",</span></span><br><span class="line"><span class="string">                "alter_cmd": "DROP INDEX account_idx,ADD UNIQUE INDEX uniq_account(account)"</span></span><br><span class="line"><span class="string">                "sql_from":[&#123;</span></span><br><span class="line"><span class="string">                    "original_sql": "alter table frm_user drop index account_idx;",</span></span><br><span class="line"><span class="string">                    "format_sql": "ALTER TABLE frm_user\nDROP INDEX account_idx;",</span></span><br><span class="line"><span class="string">                    "sql_type": "DDL",</span></span><br><span class="line"><span class="string">                    "sql_statement": "ALTER"</span></span><br><span class="line"><span class="string">                &#125;,</span></span><br><span class="line"><span class="string">                &#123;</span></span><br><span class="line"><span class="string">                    "original_sql": "alter table frm_user add unique index uniq_account(account);",</span></span><br><span class="line"><span class="string">                    "format_sql": "ALTER TABLE frm_user ADD UNIQUE INDEX uniq_account(account);",</span></span><br><span class="line"><span class="string">                    "sql_type": "DDL",</span></span><br><span class="line"><span class="string">                    "sql_statement": "ALTER"</span></span><br><span class="line"><span class="string">                &#125;]</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.result = []</span><br><span class="line">        <span class="keyword">for</span> _sql <span class="keyword">in</span> self.sql[<span class="string">"data"</span>]:</span><br><span class="line">            <span class="comment"># æ­£åˆ™åŒ¹é…å‡º table_name å’Œ alter_cmd</span></span><br><span class="line">            sql_str = _sql[<span class="string">"format_sql"</span>].replace(<span class="string">'`'</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="comment"># print(sql_str)</span></span><br><span class="line">            match_obj = re.match(</span><br><span class="line">                <span class="string">r'ALTER TABLE(.*)[\n]?(ADD|ALTER|CHANGE|CHARACTER|CONVERT|DISABLE|ENABLE|DROP|FORCE|LOCK|MODIFY|ORDER|RENAME|WITHOUT|WITH)[\n]?(.*);'</span>,</span><br><span class="line">                sql_str)</span><br><span class="line">            <span class="keyword">if</span> match_obj:</span><br><span class="line">                table_name = match_obj.group(<span class="number">1</span>).strip()</span><br><span class="line">                alter_cmd_key = match_obj.group(<span class="number">2</span>).strip()</span><br><span class="line">                alter_cmd_option = match_obj.group(<span class="number">3</span>).strip()</span><br><span class="line">                <span class="comment"># print(table_name)</span></span><br><span class="line">                <span class="comment"># print(alter_cmd_key)</span></span><br><span class="line">                <span class="comment"># print(alter_cmd_option)</span></span><br><span class="line">                self.result.append(</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">"table_name"</span>: table_name.strip(),</span><br><span class="line">                        <span class="string">"alter_cmd"</span>: <span class="string">"&#123;&#125; &#123;&#125;"</span>.format(alter_cmd_key.strip(),</span><br><span class="line">                                                    alter_cmd_option.strip().replace(<span class="string">'"'</span>, <span class="string">"'"</span>)),</span><br><span class="line">                        <span class="string">"sql_from"</span>: _sql</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">"ä¸èƒ½æ­£å¸¸åŒ¹é…"</span>)</span><br><span class="line">                self.result.append(</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">"table_name"</span>: <span class="string">""</span>,</span><br><span class="line">                        <span class="string">"alter_cmd"</span>: <span class="string">""</span>,</span><br><span class="line">                        <span class="string">"sql_from"</span>: _sql</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># print(json.dumps(self.result, indent=2, ensure_ascii=False))</span></span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sql_to_pt</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        ç»„æˆptè„šæœ¬</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        table_names = set(map(<span class="keyword">lambda</span> x: x[<span class="string">"table_name"</span>], self.result))</span><br><span class="line">        <span class="comment"># print(table_names)</span></span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">for</span> table <span class="keyword">in</span> table_names:</span><br><span class="line">            <span class="comment"># print(table)</span></span><br><span class="line">            info = list(filter(<span class="keyword">lambda</span> x: x[<span class="string">"table_name"</span>] == table, self.result))</span><br><span class="line">            <span class="comment"># print(json.dumps(info, indent=2))</span></span><br><span class="line">            out.append(</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"table_name"</span>: table,</span><br><span class="line">                    <span class="string">"alter_cmd"</span>: <span class="string">','</span>.join(list(map(<span class="keyword">lambda</span> x: x[<span class="string">"alter_cmd"</span>], info))),</span><br><span class="line">                    <span class="string">"sql_from"</span>: info</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># print(json.dumps(out, indent=2, ensure_ascii=False))</span></span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetScripts</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sql_list, **kwargs</span>):</span></span><br><span class="line">        self.render_data = &#123;<span class="string">"sql_list"</span>: sql_list,</span><br><span class="line">                            <span class="string">"time_string"</span>: time.strftime(<span class="string">'%Y%m%d%H%M%S'</span>, time.localtime(time.time())),</span><br><span class="line">                            <span class="string">"host"</span>: kwargs[<span class="string">'host'</span>],</span><br><span class="line">                            <span class="string">"port"</span>: kwargs[<span class="string">'port'</span>],</span><br><span class="line">                            <span class="string">"dbname"</span>: kwargs[<span class="string">'dbname'</span>],</span><br><span class="line">                            <span class="string">"user"</span>: kwargs[<span class="string">'user'</span>],</span><br><span class="line">                            <span class="string">"password"</span>: kwargs[<span class="string">'password'</span>],</span><br><span class="line">                            &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_template</span>(<span class="params">self</span>):</span></span><br><span class="line">        template_data = <span class="string">"""#!/bin/bash</span></span><br><span class="line"><span class="string"># pt-osc scripts</span></span><br><span class="line"><span class="string"># &#123;&#123; time_string &#125;&#125;</span></span><br><span class="line"><span class="string"># Solar æ··åˆäº‘ç®¡ç†å¹³å°     </span></span><br><span class="line"><span class="string">host=&#123;&#123; host &#125;&#125;</span></span><br><span class="line"><span class="string">port=&#123;&#123; port &#125;&#125;</span></span><br><span class="line"><span class="string">dbname=&#123;&#123; dbname &#125;&#125;</span></span><br><span class="line"><span class="string">user=&#123;&#123; user &#125;&#125;</span></span><br><span class="line"><span class="string">password=&#123;&#123; password &#125;&#125;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">&#123;% for sql in sql_list %&#125;</span></span><br><span class="line"><span class="string">table=&#123;&#123; sql.table_name &#125;&#125;</span></span><br><span class="line"><span class="string">pt-online-schema-change --user=$&#123;user&#125; --port=$&#123;port&#125; --host=$&#123;host&#125; --password=$&#123;password&#125; --alter="&#123;&#123; sql.alter_cmd &#125;&#125;" D=$&#123;dbname&#125;,t=$&#123;table&#125; --noversion-check --execute --charset=utf8</span></span><br><span class="line"><span class="string">&#123;% endfor %&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">        template = Template(template_data)</span><br><span class="line">        <span class="keyword">return</span> template.render(**self.render_data)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maker</span>(<span class="params">self</span>):</span></span><br><span class="line">        data = self.render_template()</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQLCheck</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    æ£€æµ‹ä¸‰ä¸ªæ¡ä»¶:</span></span><br><span class="line"><span class="string">    1. æ£€æŸ¥è¯­å¥ä¸­æ˜¯å¦åŒ…å«æ•°æ®åº“åï¼Œå¦‚æœåŒ…å«åˆ™Fail;</span></span><br><span class="line"><span class="string">    2. æ£€æŸ¥è¯­å¥ç»“å°¾æ˜¯å¦ä¸ºåˆ†å·ï¼Œå¦‚æœæ˜¯åˆ™Trueï¼›</span></span><br><span class="line"><span class="string">    3. åˆ¤æ–­SQLæ˜¯å¦éƒ½ä¸ºDDL Alter è¯­å¥ï¼Œå¦‚æœæ˜¯åˆ™Trueï¼›</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    [</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        "original_sql": "ALTER TABLE `aia_use_app_tag_log`   ADD  INDEX `idx_app_use_time` (`use_time`)",</span></span><br><span class="line"><span class="string">        "format_sql": "ALTER TABLE `aia_use_app_tag_log` ADD INDEX `idx_app_use_time` (`use_time`)",</span></span><br><span class="line"><span class="string">        "sql_type": "DDL",</span></span><br><span class="line"><span class="string">        "sql_statement": "ALTER",</span></span><br><span class="line"><span class="string">        "check_alter": "Pass",</span></span><br><span class="line"><span class="string">        "check_database": "Pass",</span></span><br><span class="line"><span class="string">        "check_semicolon": "Fail",</span></span><br><span class="line"><span class="string">        "check_comma": "Fail",</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, in_data_list</span>):</span></span><br><span class="line">        self.in_data_list = in_data_list</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_database</span>(<span class="params">self, _data, pass_num, fail_num</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æ£€æŸ¥è¯­å¥ä¸­æ˜¯å¦åŒ…å«æ•°æ®åº“åï¼Œå¦‚æœåŒ…å«åˆ™Fail</span></span><br><span class="line"><span class="string">        è¯­å¥ä¸­ä¸å¯ä»¥åŒ…å«.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> _data[<span class="string">"format_sql"</span>].find(<span class="string">'.'</span>) &lt; <span class="number">0</span>:</span><br><span class="line">            _data[<span class="string">"check_database"</span>] = <span class="string">"Pass"</span></span><br><span class="line">            pass_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _data[<span class="string">"check_database"</span>] = <span class="string">"Fail"</span></span><br><span class="line">            fail_num += <span class="number">1</span></span><br><span class="line">        out_data = _data</span><br><span class="line">        <span class="keyword">return</span> pass_num, fail_num, out_data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_semicolon</span>(<span class="params">self, _data, pass_num, fail_num</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        æ£€æŸ¥è¯­å¥ç»“å°¾æ˜¯å¦ä¸ºåˆ†å·ï¼Œå¦‚æœæ˜¯åˆ™True</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> _data[<span class="string">"format_sql"</span>].find(<span class="string">';'</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">            _data[<span class="string">"check_semicolon"</span>] = <span class="string">"Pass"</span></span><br><span class="line">            pass_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _data[<span class="string">"check_semicolon"</span>] = <span class="string">"Fail"</span></span><br><span class="line">            fail_num += <span class="number">1</span></span><br><span class="line">        out_data = _data</span><br><span class="line">        <span class="keyword">return</span> pass_num, fail_num, out_data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_alter</span>(<span class="params">self, _data, pass_num, fail_num</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        åˆ¤æ–­SQLæ˜¯å¦éƒ½ä¸ºDDL Alter è¯­å¥</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> _data[<span class="string">"sql_type"</span>] == <span class="string">"DDL"</span> <span class="keyword">and</span> _data[<span class="string">"sql_statement"</span>] == <span class="string">"ALTER"</span>:</span><br><span class="line">            _data[<span class="string">"check_alter"</span>] = <span class="string">"Pass"</span></span><br><span class="line">            pass_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _data[<span class="string">"check_alter"</span>] = <span class="string">"Fail"</span></span><br><span class="line">            fail_num += <span class="number">1</span></span><br><span class="line">        out_data = _data</span><br><span class="line">        <span class="keyword">return</span> pass_num, fail_num, out_data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">self</span>):</span></span><br><span class="line">        out_data_list = []</span><br><span class="line">        pass_num = <span class="number">0</span></span><br><span class="line">        fail_num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _data <span class="keyword">in</span> self.in_data_list:</span><br><span class="line">            pass_num, fail_num, out_data = self.check_alter(_data, pass_num, fail_num)</span><br><span class="line">            pass_num, fail_num, out_data = self.check_database(_data, pass_num, fail_num)</span><br><span class="line">            pass_num, fail_num, out_data = self.check_semicolon(_data, pass_num, fail_num)</span><br><span class="line">            out_data_list.append(out_data)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"pass_num"</span>: pass_num,</span><br><span class="line">            <span class="string">"fail_num"</span>: fail_num,</span><br><span class="line">            <span class="string">"data"</span>: out_data_list</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_up</span>(<span class="params">**kwargs</span>):</span></span><br><span class="line">    <span class="comment"># 1. è§£æSQL SQLParseHelper()</span></span><br><span class="line">    api = SQLParseHelper(sql_str=kwargs[<span class="string">"sql_str"</span>], split_str=<span class="string">";"</span>)</span><br><span class="line">    sql_num = api.get_length()</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> sql <span class="keyword">in</span> api.sql_list:</span><br><span class="line">        format_sql = api.get_format(sql)</span><br><span class="line">        result = api.get_init(format_sql)</span><br><span class="line">        data.append(&#123;</span><br><span class="line">            <span class="string">"original_sql"</span>: sql,</span><br><span class="line">            <span class="string">"format_sql"</span>: format_sql.strip(),</span><br><span class="line">            <span class="string">"sql_type"</span>: api.get_type(tokens=result[<span class="number">1</span>]),</span><br><span class="line">            <span class="string">"sql_statement"</span>: api.sql_statement(tokens=result[<span class="number">1</span>]),</span><br><span class="line">        &#125;)</span><br><span class="line">    new_result = &#123;</span><br><span class="line">        <span class="string">"num"</span>: sql_num,</span><br><span class="line">        <span class="string">"data"</span>: data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># print(json.dumps(new_result, indent=2, ensure_ascii=False))</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 2. åˆ¤æ–­SQLæ˜¯å¦éƒ½ä¸ºDDL Alter è¯­å¥ check_alter()</span></span><br><span class="line">    check_api = SQLCheck(new_result[<span class="string">"data"</span>])</span><br><span class="line">    check_result = check_api.main()</span><br><span class="line">    <span class="comment"># print(json.dumps(check_result, indent=2, ensure_ascii=False))</span></span><br><span class="line">    <span class="keyword">if</span> check_result[<span class="string">"fail_num"</span>] &gt; <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"æ£€æµ‹ä¸é€šè¿‡"</span>)</span><br><span class="line">        print(json.dumps(</span><br><span class="line">            list(filter(</span><br><span class="line">                <span class="keyword">lambda</span> x: x[<span class="string">"check_alter"</span>] == <span class="string">'Fail'</span> <span class="keyword">or</span> x[<span class="string">"check_database"</span>] == <span class="string">'Fail'</span> <span class="keyword">or</span> x[</span><br><span class="line">                    <span class="string">"check_semicolon"</span>] == <span class="string">'Fail'</span> <span class="keyword">or</span> x[<span class="string">"check_comma"</span>] == <span class="string">"Fail"</span>,</span><br><span class="line">                check_result[<span class="string">"data"</span>]</span><br><span class="line">            ))</span><br><span class="line">            , indent=<span class="number">2</span>, ensure_ascii=<span class="literal">False</span>))</span><br><span class="line">        <span class="comment"># print(json.dumps(check_result, indent=2, ensure_ascii=False))</span></span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        <span class="comment"># print("æ£€æµ‹é€šè¿‡")</span></span><br><span class="line">        <span class="comment"># print(json.dumps(check_result, indent=2, ensure_ascii=False))</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 3. è½¬PT PTHelper()</span></span><br><span class="line">    pt_api = PTHelper(check_result)</span><br><span class="line">    pt_api.alter_sql_parse()</span><br><span class="line">    pt_sql_list = pt_api.sql_to_pt()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 4. æ¸²æŸ“è„šæœ¬</span></span><br><span class="line">    scripts_api = GetScripts(pt_sql_list, **kwargs)</span><br><span class="line">    data = scripts_api.maker()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">'''MySQL Alterè¯­å¥è‡ªåŠ¨è½¬ PTè„šæœ¬ å°å·¥å…·</span></span><br><span class="line"><span class="string">    æ”¯æŒçš„Alterç±»å‹ï¼šADD|ALTER|CHANGE|CHARACTER|CONVERT|DISABLE|ENABLE|DROP|FORCE|LOCK|MODIFY|ORDER|RENAME|WITHOUT|WITH ï¼›</span></span><br><span class="line"><span class="string">    ä¸æ”¯æŒå¸¦åº“åï¼›</span></span><br><span class="line"><span class="string">    ä¸æ”¯æŒä¸€æ¡sqlå¤šä¸ªå˜ã€‚</span></span><br><span class="line"><span class="string">    è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="string">    #!/bin/bash</span></span><br><span class="line"><span class="string">    # pt-osc scripts</span></span><br><span class="line"><span class="string">    # 20200522190824</span></span><br><span class="line"><span class="string">    # Solar æ··åˆäº‘ç®¡ç†å¹³å°     </span></span><br><span class="line"><span class="string">    host=localhost</span></span><br><span class="line"><span class="string">    port=3306</span></span><br><span class="line"><span class="string">    dbname=test01</span></span><br><span class="line"><span class="string">    user=root</span></span><br><span class="line"><span class="string">    password=lsdkjkdjfkdf</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    table=frm_user</span></span><br><span class="line"><span class="string">    pt-online-schema-change --user=$&#123;user&#125; --port=$&#123;port&#125; --host=$&#123;host&#125; --password=$&#123;password&#125; --alter="DROP INDEX account_idx,ADD UNIQUE INDEX uniq_account(account)" D=$&#123;dbname&#125;,t=$&#123;table&#125; --no-version-check --execute --charset=utf8</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    table=aia_present_point_exchange_user</span></span><br><span class="line"><span class="string">    pt-online-schema-change --user=$&#123;user&#125; --port=$&#123;port&#125; --host=$&#123;host&#125; --password=$&#123;password&#125; --alter="ADD COLUMN end_date DATETIME NULL COMMENT 'æœ‰æ•ˆæœŸç»“æŸ' AFTER start_date" D=$&#123;dbname&#125;,t=$&#123;table&#125; --no-version-check --execute --charset=utf8</span></span><br><span class="line"><span class="string">    "</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    Exampleï¼š</span></span><br><span class="line"><span class="string">    python3 get_sql2pt.py --InFile demo/mysql_alter_demo.sql --OutFile demo/mysql_alter_pt.sh --Host localhost --Port 3306 --DBName test01 --User root --PassWord lsdkjkdjfkdf</span></span><br><span class="line"><span class="string">    '''</span>, formatter_class=argparse.RawTextHelpFormatter)</span><br><span class="line">    parser.add_argument(<span class="string">"--InFile"</span>, help=<span class="string">"MySQL Alter SQLæºæ–‡ä»¶ å¿…è¦å‚æ•°"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--OutFile"</span>,</span><br><span class="line">                        default=<span class="string">'sql2pt-&#123;&#125;'</span>.format(time.strftime(<span class="string">'%Y%m%d%H%M%S'</span>, time.localtime(time.time()))),</span><br><span class="line">                        help=<span class="string">"è½¬æ¢åçš„è„šæœ¬å éå‚æ•°"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--Host"</span>, help=<span class="string">"MySQLæœåŠ¡å™¨è¿æ¥åœ°å€"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--Port"</span>, help=<span class="string">"MySQLæœåŠ¡å™¨ç›‘å¬ç«¯å£"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--DBName"</span>, help=<span class="string">"MySQLè®¿é—®çš„æ•°æ®åº“å"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--User"</span>, help=<span class="string">"MySQLæœåŠ¡å™¨ç™»é™†ç”¨æˆ·å"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--PassWord"</span>, help=<span class="string">"MySQLæœåŠ¡å™¨ç™»é™†ç”¨æˆ·å¯†ç "</span>)</span><br><span class="line"> </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">if</span> args.InFile <span class="keyword">and</span> args.Host <span class="keyword">and</span> args.Port <span class="keyword">and</span> args.DBName <span class="keyword">and</span> args.User <span class="keyword">and</span> args.PassWord:</span><br><span class="line">        sql_str = open(args.InFile, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>).read().replace(<span class="string">'#'</span>, <span class="string">''</span>)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">"sql_str"</span>: sql_str,</span><br><span class="line">            <span class="string">"out_file"</span>: args.OutFile,</span><br><span class="line">            <span class="string">"host"</span>: args.Host,</span><br><span class="line">            <span class="string">"port"</span>: args.Port,</span><br><span class="line">            <span class="string">"dbname"</span>: args.DBName,</span><br><span class="line">            <span class="string">"user"</span>: args.User,</span><br><span class="line">            <span class="string">"password"</span>: args.PassWord</span><br><span class="line">        &#125;</span><br><span class="line">        result = start_up(**params)</span><br><span class="line">        <span class="keyword">with</span> open(args.OutFile, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(result)</span><br></pre></td></tr></table></figure><h2 id="å½’æ¡£"><a href="#å½’æ¡£" class="headerlink" title="å½’æ¡£"></a>å½’æ¡£</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pt-archiver  --<span class="built_in">source</span> h=<span class="variable">$&#123;host&#125;</span>,P=3306,u=<span class="variable">$&#123;user&#125;</span>,p=<span class="variable">$&#123;password&#125;</span>,D=<span class="variable">$&#123;database&#125;</span>,t=<span class="variable">$&#123;table&#125;</span> --dest h=<span class="variable">$&#123;host&#125;</span>,P=3306,u=<span class="variable">$&#123;user&#125;</span>,p=<span class="variable">$&#123;password&#125;</span>,D=<span class="variable">$&#123;database&#125;</span>,t=<span class="variable">$&#123;table&#125;</span>  --no-check-charset --<span class="built_in">where</span> <span class="string">"use_time &lt; '2020-01-01'"</span> --progress 5000 --<span class="built_in">limit</span>=1000 --txn-size=1000 --statistics --bulk-insert --bulk-delete --charset <span class="string">'utf8'</span> --noversion-check</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><p><code>--source</code>: æºç«¯<br><code>--dest</code>: ç›®æ ‡ç«¯<br><code>--dry-run</code>: debugæ¨¡å¼ï¼Œå°è¯•è¿è¡Œã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚&quot;&gt;&lt;a href=&quot;#æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚&quot; class=&quot;headerlink&quot; title=&quot;æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚&quot;&gt;&lt;/a&gt;æ•°æ®åº“ç‰ˆæœ¬å’Œå·¥å…·ç‰ˆæœ¬è¦æ±‚&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ•°æ®åº“&lt;/th&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>MySQL 8.0 Root å¯†ç åœ¨çº¿ç ´è§£</title>
    <link href="http://www.toberoot.com/news/2020/09/24/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/09/24/tec-mysql/</id>
    <published>2020-09-24T00:00:00.000Z</published>
    <updated>2020-09-28T01:20:42.310Z</updated>
    
    <content type="html"><![CDATA[<pre><code class="bash"><span class="comment"># æµ‹è¯•ç”¨æˆ·boobooçš„è´¦å·å¯†ç æƒ…å†µ</span>mysql&gt; select user,host,authentication_string from mysql.user;+------------------+-----------+------------------------------------------------------------------------+| user             | host      | authentication_string                                                  |+------------------+-----------+------------------------------------------------------------------------+| booboo           | %         | <span class="variable">$A</span><span class="variable">$005</span><span class="variable">$z1</span>;I4T4DFutFGI2Bx8I44RVy7oa0lY6paOoRofbbNcnFKUVJ3ojJkDvCw8 |<span class="comment"># ç³»ç»Ÿåº“mysql</span>[root@foundation0 tmp]<span class="comment"># ll /var/lib/mysql/mysql*</span>-rw-r-----. 1 mysql mysql 25165824 9æœˆ  24 17:44 /var/lib/mysql/mysql.ibdsrwxrwxrwx. 1 mysql mysql        0 6æœˆ   1 17:46 /var/lib/mysql/mysql.sock-rw-------. 1 mysql mysql        6 6æœˆ   1 17:46 /var/lib/mysql/mysql.sock.lock/var/lib/mysql/mysql:æ€»ç”¨é‡ 28-rw-r-----. 1 mysql mysql  5594 6æœˆ   1 17:46 general_log_202.sdi-rw-r-----. 1 mysql mysql    35 6æœˆ   1 17:46 general_log.CSM-rw-r-----. 1 mysql mysql     0 6æœˆ   1 17:46 general_log.CSV-rw-r-----. 1 mysql mysql 11803 6æœˆ   1 17:46 slow_log_203.sdi-rw-r-----. 1 mysql mysql    35 6æœˆ   1 17:46 slow_log.CSM-rw-r-----. 1 mysql mysql     0 6æœˆ   1 17:46 slow_log.CSV<span class="comment"># å¤åˆ¶ä¸€ä»½ mysql.ibd</span>cp /var/lib/mysql/mysql.ibd /tmp/mysql.ibd.bac<span class="comment"># hexdump åˆ†æ</span>hexdump -C mysql.ibd.bac  &gt; /tmp/mysql.ibd.hexdump.txt*006912f0  20 20 20 20 20 20 20 20  20 20 71 69 6e 78 69 20  |          qinxi |00691300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |00691310  20 20 20 20 20 20 20 20  20 20 00 00 00 00 14 d7  |          ......|00691320  02 00 00 01 1e 14 56 02  02 02 02 02 02 02 02 02  |......V.........|00691330  02 01 02 02 02 02 02 02  02 02 02 02 02 02 02 02  |................|00691340  02 02 02 02 01 00 00 00  00 00 00 00 00 00 00 00  |................|00691350  00 00 00 00 00 63 61 63  68 69 6e 67 5f 73 68 61  |.....caching_sha|00691360  32 5f 70 61 73 73 77 6f  72 64 20 20 20 20 20 20  |2_password      |00691370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |*00691390  20 20 20 20 20 24 41 24  30 30 35 24 21 3e 13 58  |     <span class="variable">$A</span><span class="variable">$005</span>$!&gt;.X|006913a0  6c 74 5d 39 62 42 2d 25  10 75 06 57 68 46 79 52  |lt]9bB-%.u.WhFyR|006913b0  53 4d 4e 38 39 54 42 68  4a 53 35 67 5a 6c 72 53  |SMN89TBhJS5gZlrS|006913c0  32 4d 55 59 2f 4c 77 4c  38 4c 37 4f 4e 68 47 72  |2MUY/LwL8L7ONhGr|006913d0  67 4a 68 65 36 37 65 39  4c 79 36 01 5f 6a b1 2c  |gJhe67e9Ly6._j.,|006913e0  01 02 02 46 40 00 00 00  20 7c 00 00 60 fe 0c 25  |...F@... |..`..%|006913f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |*006914e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 62 6f  |              bo|006914f0  6f 62 6f 6f 20 20 20 20  20 20 20 20 20 20 20 20  |oboo            |00691500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 00 00  |              ..|00691510  00 00 14 e1 82 00 00 00  9f 01 10 01 01 01 01 01  |................|00691520  01 01 01 01 01 01 01 01  01 01 01 01 01 01 01 01  |................|00691530  01 01 01 01 01 01 01 01  01 00 00 00 00 00 00 00  |................|00691540  00 00 00 00 00 00 00 00  00 63 61 63 68 69 6e 67  |.........caching|00691550  5f 73 68 61 32 5f 70 61  73 73 77 6f 72 64 20 20  |_sha2_password  |00691560  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |*00691580  20 20 20 20 20 20 20 20  20 24 41 24 30 30 35 24  |         <span class="variable">$A</span><span class="variable">$005</span>$|00691590  7a 31 03 3b 1b 71 49 34  1f 54 0e 34 44 46 75 74  |z1.;.qI4.T.4DFut|006915a0  46 47 49 32 42 78 38 49  34 34 52 56 79 37 6f 61  |FGI2Bx8I44RVy7oa|006915b0  30 6c 59 36 70 61 4f 6f  52 6f 66 62 62 4e 63 6e  |0lY6paOoRofbbNcn|006915c0  46 4b 55 56 4a 33 6f 6a  4a 6b 44 76 43 77 38 01  |FKUVJ3ojJkDvCw8.|006915d0  5f 6c 6a 26 01 01 01 00  00 00 00 00 00 00 00 00  |_lj&amp;............|006915e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|*00691580  20 20 20 20 20 24 41 24  30 30 35 24 21 3e 13 58  |     <span class="variable">$A</span><span class="variable">$005</span>$!&gt;.X|00691590  6c 74 5d 39 62 42 2d 25  10 75 06 57 68 46 79 52  |lt]9bB-%.u.WhFyR|006915a0  53 4d 4e 38 39 54 42 68  4a 53 35 67 5a 6c 72 53  |SMN89TBhJS5gZlrS|006915b0  32 4d 55 59 2f 4c 77 4c  38 4c 37 4f 4e 68 47 72  |2MUY/LwL8L7ONhGr|006915c0  67 4a 68 65 36 37 65 39  4c 79 36 01 5f 6a b1 2c  |gJhe67e9Ly6._j.,|006915d0  01 02 02 46 40 00 00 00  20 7c 00 00 60 fe 0c 25  |...F@... |..`..%|006915e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |æµ‹è¯•å‘ç°å¤±è´¥ï¼Œæ¨æµ‹8.0çš„åŠ å¯†ç®—æ³•å·²ä¸å†æ˜¯ä»…ä»…ä½¿ç”¨å¯†ç è¿›è¡ŒåŠ å¯†ã€‚è¿›ä¸€æ­¥å°è¯•ä¿®æ”¹æƒé™æ¥å®ç°ã€‚</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# æµ‹è¯•ç”¨æˆ·boobooçš„è´¦å·å¯†ç æƒ…å†µ&lt;/span&gt;
mysql&amp;gt; select user,host,authentication_string from mysql.user;
+
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>MySQL ä½¿ç”¨æ€§èƒ½æ¨¡å¼è¿›è¡ŒæŸ¥è¯¢åˆ†æ</title>
    <link href="http://www.toberoot.com/news/2020/09/22/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/09/22/tec-mysql/</id>
    <published>2020-09-22T00:00:00.000Z</published>
    <updated>2020-09-22T09:29:24.549Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä½¿ç”¨-Profiles-åˆ†æ-SQL-è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº"><a href="#ä½¿ç”¨-Profiles-åˆ†æ-SQL-è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº" class="headerlink" title="ä½¿ç”¨ Profiles åˆ†æ SQL è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/show-profile.html" rel="external nofollow noreferrer">ä½¿ç”¨ Profiles åˆ†æ SQL è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº</a></h1><blockquote><p>SHOW PROFILE å’Œ SHOW PROFILES è¯­å¥å°†åœ¨æœªæ¥çš„MySQLç‰ˆæœ¬ä¸­åˆ é™¤ã€‚</p></blockquote><ul><li>typeå¯ä»¥æŒ‡å®š å¯é€‰å€¼ä»¥æ˜¾ç¤ºç‰¹å®šçš„å…¶ä»–ä¿¡æ¯ç±»å‹ï¼š</li><li>ALL æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯</li><li>BLOCK IO æ˜¾ç¤ºå—è¾“å…¥å’Œè¾“å‡ºæ“ä½œçš„è®¡æ•°</li><li>CONTEXT SWITCHES æ˜¾ç¤ºè‡ªæ„¿å’Œéè‡ªæ„¿ä¸Šä¸‹æ–‡åˆ‡æ¢çš„è®¡æ•°</li><li>CPU æ˜¾ç¤ºç”¨æˆ·å’Œç³»ç»Ÿçš„CPUä½¿ç”¨æ—¶é—´</li><li>IPC æ˜¾ç¤ºå·²å‘é€å’Œå·²æ¥æ”¶é‚®ä»¶çš„è®¡æ•°</li><li>MEMORY ç›®å‰å°šæœªå®æ–½</li><li>PAGE FAULTS æ˜¾ç¤ºä¸»è¦å’Œæ¬¡è¦é¡µé¢é”™è¯¯çš„è®¡æ•°</li><li>SOURCE æ˜¾ç¤ºæºä»£ç ä¸­çš„å‡½æ•°åç§°ä»¥åŠè¯¥å‡½æ•°æ‰€åœ¨æ–‡ä»¶çš„åç§°å’Œè¡Œå·</li><li>SWAPS æ˜¾ç¤ºæ‰æœŸè®¡æ•°</li></ul><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT @@profiling;</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">| @@profiling |</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">|           0 |</span><br><span class="line">+<span class="comment">-------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">SET</span> profiling = <span class="number">1</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DROP TABLE IF EXISTS t1;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE TABLE T1 (id INT);</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW PROFILES;</span><br><span class="line">+<span class="comment">----------+----------+--------------------------+</span></span><br><span class="line">| Query_ID | Duration | Query                    |</span><br><span class="line">+<span class="comment">----------+----------+--------------------------+</span></span><br><span class="line">|        0 | 0.000088 | <span class="keyword">SET</span> PROFILING = <span class="number">1</span>        |</span><br><span class="line">|        <span class="number">1</span> | <span class="number">0.000136</span> | <span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> t1  |</span><br><span class="line">|        <span class="number">2</span> | <span class="number">0.011947</span> | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (<span class="keyword">id</span> <span class="built_in">INT</span>) |</span><br><span class="line">+<span class="comment">----------+----------+--------------------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">SHOW</span> PROFILE;</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line">| Status               | Duration |</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line">| checking permissions | 0.000040 |</span><br><span class="line">| creating table       | 0.000056 |</span><br><span class="line">| After <span class="keyword">create</span>         | <span class="number">0.011363</span> |</span><br><span class="line">| <span class="keyword">query</span> <span class="keyword">end</span>            | <span class="number">0.000375</span> |</span><br><span class="line">| freeing items        | <span class="number">0.000089</span> |</span><br><span class="line">| <span class="keyword">logging</span> slow <span class="keyword">query</span>   | <span class="number">0.000019</span> |</span><br><span class="line">| cleaning up          | <span class="number">0.000005</span> |</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">SHOW</span> PROFILE <span class="keyword">FOR</span> <span class="keyword">QUERY</span> <span class="number">1</span>;</span><br><span class="line">+<span class="comment">--------------------+----------+</span></span><br><span class="line">| Status             | Duration |</span><br><span class="line">+<span class="comment">--------------------+----------+</span></span><br><span class="line">| query <span class="keyword">end</span>          | <span class="number">0.000107</span> |</span><br><span class="line">| freeing items      | <span class="number">0.000008</span> |</span><br><span class="line">| <span class="keyword">logging</span> slow <span class="keyword">query</span> | <span class="number">0.000015</span> |</span><br><span class="line">| cleaning up        | <span class="number">0.000006</span> |</span><br><span class="line">+<span class="comment">--------------------+----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">SHOW</span> PROFILE CPU <span class="keyword">FOR</span> <span class="keyword">QUERY</span> <span class="number">2</span>;</span><br><span class="line">+<span class="comment">----------------------+----------+----------+------------+</span></span><br><span class="line">| Status               | Duration | CPU_user | CPU_system |</span><br><span class="line">+<span class="comment">----------------------+----------+----------+------------+</span></span><br><span class="line">| checking permissions | 0.000040 | 0.000038 |   0.000002 |</span><br><span class="line">| creating table       | 0.000056 | 0.000028 |   0.000028 |</span><br><span class="line">| After <span class="keyword">create</span>         | <span class="number">0.011363</span> | <span class="number">0.000217</span> |   <span class="number">0.001571</span> |</span><br><span class="line">| <span class="keyword">query</span> <span class="keyword">end</span>            | <span class="number">0.000375</span> | <span class="number">0.000013</span> |   <span class="number">0.000028</span> |</span><br><span class="line">| freeing items        | <span class="number">0.000089</span> | <span class="number">0.000010</span> |   <span class="number">0.000014</span> |</span><br><span class="line">| <span class="keyword">logging</span> slow <span class="keyword">query</span>   | <span class="number">0.000019</span> | <span class="number">0.000009</span> |   <span class="number">0.000010</span> |</span><br><span class="line">| cleaning up          | <span class="number">0.000005</span> | <span class="number">0.000003</span> |   <span class="number">0.000002</span> |</span><br><span class="line">+<span class="comment">----------------------+----------+----------+------------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨æ€§èƒ½æ¨¡å¼è¿›è¡ŒæŸ¥è¯¢åˆ†æ"><a href="#ä½¿ç”¨æ€§èƒ½æ¨¡å¼è¿›è¡ŒæŸ¥è¯¢åˆ†æ" class="headerlink" title="ä½¿ç”¨æ€§èƒ½æ¨¡å¼è¿›è¡ŒæŸ¥è¯¢åˆ†æ"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/performance-schema-query-profiling.html" rel="external nofollow noreferrer">ä½¿ç”¨æ€§èƒ½æ¨¡å¼è¿›è¡ŒæŸ¥è¯¢åˆ†æ</a></h1><p>ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Performance Schemaè¯­å¥äº‹ä»¶å’Œé˜¶æ®µäº‹ä»¶æ¥æ£€ç´¢ä¸SHOW PROFILESå’ŒSHOW PROFILEè¯­å¥æä¾›çš„æ¦‚è¦åˆ†æä¿¡æ¯ç›¸å½“çš„æ•°æ®ã€‚<br>è¯¥setup_actorsè¡¨å¯ç”¨äºé™åˆ¶ä¸»æœºï¼Œç”¨æˆ·æˆ–å¸æˆ·å¯¹å†å²äº‹ä»¶çš„æ”¶é›†ï¼Œä»¥å‡å°‘è¿è¡Œæ—¶å¼€é”€å’Œå†å²è¡¨ä¸­æ”¶é›†çš„æ•°æ®é‡ã€‚è¯¥ç¤ºä¾‹çš„ç¬¬ä¸€æ­¥æ˜¾ç¤ºäº†å¦‚ä½•å°†å†å²äº‹ä»¶çš„æ”¶é›†é™åˆ¶ä¸ºç‰¹å®šç”¨æˆ·ã€‚<br>æ€§èƒ½æ¶æ„ä»¥çš®ç§’ï¼ˆä¸‡äº¿åˆ†ä¹‹ä¸€ç§’ï¼‰ä¸ºå•ä½æ˜¾ç¤ºäº‹ä»¶è®¡æ—¶å™¨ä¿¡æ¯ï¼Œä»¥å°†è®¡æ—¶æ•°æ®æ ‡å‡†åŒ–ä¸ºæ ‡å‡†å•ä½ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œå°† TIMER_WAITå€¼é™¤ä»¥1000000000000ï¼Œä»¥ç§’ä¸ºå•ä½æ˜¾ç¤ºæ•°æ®ã€‚å€¼ä¹Ÿå°†è¢«æˆªæ–­ä¸ºå°æ•°ç‚¹å6ä½ï¼Œä»¥ä¸SHOW PROFILESand SHOW PROFILEè¯­å¥ç›¸åŒçš„æ ¼å¼æ˜¾ç¤ºæ•°æ®ã€‚</p><p>ä½¿ç”¨Performance Schemaè¯­å¥äº‹ä»¶å’Œé˜¶æ®µäº‹ä»¶æ¥æ£€ç´¢ä¸ SHOW PROFILES å’Œ SHOW PROFILE è¯­å¥æä¾›çš„æ¦‚è¦åˆ†æä¿¡æ¯ç›¸å½“çš„æ•°æ®ã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> performance_schema.setup_actors;</span><br><span class="line"><span class="comment"># é€šè¿‡æ›´æ–°setup_instrumentsè¡¨ç¡®ä¿å·²å¯ç”¨è¯­å¥å’Œé˜¶æ®µæ£€æµ‹ ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯èƒ½å·²å¯ç”¨ã€‚</span></span><br><span class="line"><span class="keyword">UPDATE</span> performance_schema.setup_instruments <span class="keyword">SET</span> ENABLED = <span class="string">'YES'</span>, TIMED = <span class="string">'YES'</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> <span class="keyword">LIKE</span> <span class="string">'%statement/%'</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> performance_schema.setup_instruments <span class="keyword">SET</span> ENABLED = <span class="string">'YES'</span>, TIMED = <span class="string">'YES'</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> <span class="keyword">LIKE</span> <span class="string">'%stage/%'</span>;       </span><br><span class="line"><span class="comment"># ç¡®ä¿å·²å¯ç”¨events_statements_*å’Œ events_stages_*ä½¿ç”¨è€…ã€‚</span></span><br><span class="line"><span class="keyword">UPDATE</span> performance_schema.setup_consumers <span class="keyword">SET</span> ENABLED = <span class="string">'YES'</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> <span class="keyword">LIKE</span> <span class="string">'%events_statements_%'</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> performance_schema.setup_consumers <span class="keyword">SET</span> ENABLED = <span class="string">'YES'</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> <span class="keyword">LIKE</span> <span class="string">'%events_stages_%'</span>;</span><br><span class="line"><span class="comment"># è¿è¡Œè¦åˆ†æçš„è¯­å¥</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> x2_user;</span><br><span class="line"><span class="comment"># EVENT_IDé€šè¿‡æŸ¥è¯¢events_statements_history_long è¡¨æ¥ æ ‡è¯†è¯­å¥ ã€‚æ­¤æ­¥éª¤ç±»ä¼¼äºè¿è¡Œ SHOW PROFILESä»¥æ ‡è¯† Query_IDã€‚ä»¥ä¸‹æŸ¥è¯¢äº§ç”Ÿç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„è¾“å‡ºSHOW PROFILESï¼š</span></span><br><span class="line"><span class="keyword">SELECT</span> EVENT_ID, <span class="keyword">TRUNCATE</span>(TIMER_WAIT/<span class="number">1000000000000</span>,<span class="number">6</span>) <span class="keyword">as</span> <span class="keyword">Duration</span>, SQL_TEXT <span class="keyword">FROM</span> performance_schema.events_statements_history_long <span class="keyword">WHERE</span> SQL_TEXT <span class="keyword">like</span> <span class="string">'%user%'</span>;</span><br><span class="line">+<span class="comment">----------+----------+-----------------------+</span></span><br><span class="line">| EVENT_ID | Duration | SQL_TEXT              |</span><br><span class="line">+<span class="comment">----------+----------+-----------------------+</span></span><br><span class="line">|       84 | 0.020524 | <span class="keyword">select</span> * <span class="keyword">from</span> x2_user |</span><br><span class="line">+<span class="comment">----------+----------+-----------------------+       </span></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ events_stages_history_long è¡¨ä»¥æ£€ç´¢è¯­å¥çš„é˜¶æ®µäº‹ä»¶ã€‚é˜¶æ®µä½¿ç”¨äº‹ä»¶åµŒå¥—é“¾æ¥åˆ°è¯­å¥ã€‚æ¯ä¸ªé˜¶æ®µäº‹ä»¶è®°å½•éƒ½æœ‰ä¸€ä¸ªNESTING_EVENT_IDåŒ…å«EVENT_IDçˆ¶è¯­å¥çš„çš„åˆ—ã€‚ </span></span><br><span class="line"><span class="keyword">SELECT</span> event_name <span class="keyword">AS</span> Stage, <span class="keyword">TRUNCATE</span>(TIMER_WAIT/<span class="number">1000000000000</span>,<span class="number">6</span>) <span class="keyword">AS</span> <span class="keyword">Duration</span> <span class="keyword">FROM</span> performance_schema.events_stages_history_long <span class="keyword">WHERE</span> NESTING_EVENT_ID=<span class="number">84</span>;</span><br><span class="line">+<span class="comment">--------------------------------+----------+</span></span><br><span class="line">| Stage                          | Duration |</span><br><span class="line">+<span class="comment">--------------------------------+----------+</span></span><br><span class="line">| stage/sql/starting             | 0.000031 |</span><br><span class="line">| stage/sql/checking permissions | 0.000003 |</span><br><span class="line">| stage/sql/Opening tables       | 0.000769 |</span><br><span class="line">| stage/sql/init                 | 0.000065 |</span><br><span class="line">| stage/sql/System <span class="keyword">lock</span>          | <span class="number">0.000011</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/optimizing           | <span class="number">0.000001</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/<span class="keyword">statistics</span>           | <span class="number">0.000007</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/preparing            | <span class="number">0.000006</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/executing            | <span class="number">0.000212</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/Sending <span class="keyword">data</span>         | <span class="number">0.019388</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/<span class="keyword">end</span>                  | <span class="number">0.000001</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/<span class="keyword">query</span> <span class="keyword">end</span>            | <span class="number">0.000003</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/closing <span class="keyword">tables</span>       | <span class="number">0.000006</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/freeing items        | <span class="number">0.000014</span> |</span><br><span class="line">| stage/<span class="keyword">sql</span>/cleaning up          | <span class="number">0.000001</span> |</span><br><span class="line">+<span class="comment">--------------------------------+----------+</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä½¿ç”¨-Profiles-åˆ†æ-SQL-è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-Profiles-åˆ†æ-SQL-è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ Profiles åˆ†æ SQL è¯­å¥æ‰§è¡Œæ—¶é—´å’Œæ¶ˆè€—èµ„æº&quot;&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>CodeSample å…¨æ°‘èµ›ç </title>
    <link href="http://www.toberoot.com/news/2020/09/05/aliyun-game/"/>
    <id>http://www.toberoot.com/news/2020/09/05/aliyun-game/</id>
    <published>2020-09-05T00:00:00.000Z</published>
    <updated>2020-09-16T03:04:36.650Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¬¡å¤§èµ›ç”±é˜¿é‡Œäº‘å¼€æ”¾å¹³å°&amp;é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº&amp;é˜¿é‡Œäº‘å†…å®¹è®¾è®¡éƒ¨è”åˆä¸¾åŠã€‚</p><h2 id="å¤§èµ›ç®€ä»‹"><a href="#å¤§èµ›ç®€ä»‹" class="headerlink" title="å¤§èµ›ç®€ä»‹"></a>å¤§èµ›ç®€ä»‹</h2><p>é˜¿é‡Œäº‘å¼€æ”¾å¹³å°æºæ‰‹å¼€å‘è€…ç¤¾åŒºã€å†…å®¹è®¾è®¡éƒ¨ï¼Œè”åˆä¸¾åŠâ€œOpenAPI å¼€å‘è€…æŒ‘æˆ˜èµ›ç¬¬ä¸‰æœŸâ€”â€” CodeSample å…¨æ°‘èµ›ç  â€ï¼Œé¢å‘æ•°ä¸‡å¼€å‘è€…ï¼Œæ‹›å‹Ÿé˜¿é‡Œäº‘ OpenAPI ç¤ºä¾‹ä»£ç ï¼ˆCodeSampleï¼‰ã€‚æ— è®ºæ‚¨æ˜¯å…¥é—¨å¼€å‘ï¼Œæˆ–æ˜¯è¿ç»´å¤§ç¥ï¼Œæ— è®ºæ˜¯åˆ©ç”¨ OpenAPI è§£å†³ä¸€ä¸ªè½»é‡åœºæ™¯ï¼Œæˆ–æ˜¯æ»¡è¶³ä¸€ä¸ªå°åŠŸèƒ½ï¼Œé€šé€šåˆ°ç¢—é‡Œæ¥ï¼ç°æŠ¥åé€šé“ç«çƒ­å¼€å¯ï¼Œæ¬¢è¿æŠ¢å…ˆæŠ¥åï¼</p><h3 id="å¤§èµ›è¯¦æƒ…"><a href="#å¤§èµ›è¯¦æƒ…" class="headerlink" title="å¤§èµ›è¯¦æƒ…"></a><a href="https://developer.aliyun.com/topic/codesample/active1" rel="external nofollow noreferrer">å¤§èµ›è¯¦æƒ…</a></h3><h2 id="èµ›äº‹å®‰æ’"><a href="#èµ›äº‹å®‰æ’" class="headerlink" title="èµ›äº‹å®‰æ’"></a>èµ›äº‹å®‰æ’</h2><p>å¤§èµ›æŠ¥åï¼š 2020.08.12â€”2020.09.11<br>ä½œå“æäº¤æˆªæ­¢æ—¥ï¼š2020.09.13<br>ä½œå“è¯„å®¡ï¼š2020.09.17<br>è·å¥–å…¬å¸ƒï¼š2020.09.18</p><h2 id="å¥–é¡¹è®¾ç½®"><a href="#å¥–é¡¹è®¾ç½®" class="headerlink" title="å¥–é¡¹è®¾ç½®"></a>å¥–é¡¹è®¾ç½®</h2><p><strong>ä¸€ç­‰å¥–ï¼š</strong>1 åï¼Œæ¨±æ¡ƒæœºæ¢°é”®ç›˜ + å†…æ¨èµ„æ ¼ + å¼€æ”¾å¹³å°å¤©ä½¿ç”¨æˆ·èµ„æ ¼ + å‚èµ›å¥–ç‰Œï¼›<br><strong>äºŒç­‰å¥–ï¼š</strong>3 åï¼Œå¤§ç–†ç‰¹æ´›ï¼ˆTelloï¼‰èˆªæ‹æ— äººæœº + å†…æ¨èµ„æ ¼ + å‚èµ›å¥–ç‰Œï¼›<br><strong>ä¸‰ç­‰å¥–ï¼š</strong>5 åï¼ŒAlibabaåŒè‚©èƒŒåŒ… + å‚èµ›å¥–ç‰Œï¼›<br><strong>å‚ä¸å¥–ï¼š</strong>20 åï¼Œå¤§èµ›ä¸“å±å¥–ç‰Œã€‚</p><h2 id="å‚èµ›è§„åˆ™"><a href="#å‚èµ›è§„åˆ™" class="headerlink" title="å‚èµ›è§„åˆ™"></a>å‚èµ›è§„åˆ™</h2><p>1ã€å¤§èµ›æŠ¥åï¼šæäº¤å‚èµ›ä½œå“å‰ï¼Œè¯·å…ˆè¿›è¡Œ <strong><a href="https://survey.aliyun.com/apps/zhiliao/YScU_6Lty?spm=a2c6h.17640777.J_1935739830.1.7b0b54e1ceHGoF" rel="external nofollow noreferrer">å¤§èµ›æŠ¥å</a></strong>ï¼Œæœªå®Œæˆå¤§èµ›æŠ¥åçš„é€‰æ‰‹ï¼Œæäº¤çš„å‚èµ›ä½œå“è§†ä¸ºæ— æ•ˆï¼›</p><p>2ã€ä½œå“æäº¤ï¼š<strong><a href="https://api.aliyun.com/?spm=a2c6h.17640777.J_6252052100.1.7b0b54e1CI5grf#/codesample" rel="external nofollow noreferrer">è¿›å…¥ä½œå“æäº¤é¡µé¢</a></strong>ï¼Œç‚¹å‡»â€œå¼€å§‹ç¼–è¾‘â€å³å¯ç¼–è¾‘å’Œé¢„è§ˆ CodeSampleï¼ŒåŒæ—¶å¯ç›´æ¥æäº¤ä½œå“ï¼ˆæœ¬æ¬¡æ´»åŠ¨å”¯ä¸€ä½œå“æäº¤å…¥å£ï¼‰ï¼Œè¯·æŒ‰ç…§é¡µé¢ä¸Šçš„æŒ‡å—æ“ä½œã€‚</p><h2 id="ä½œå“é€‰é¢˜å‚è€ƒ"><a href="#ä½œå“é€‰é¢˜å‚è€ƒ" class="headerlink" title="ä½œå“é€‰é¢˜å‚è€ƒ"></a>ä½œå“é€‰é¢˜å‚è€ƒ</h2><p><img src="https://tianchi-public.oss-cn-hangzhou.aliyuncs.com/public/files/forum/159887018616816301598870183654.jpeg" alt="enter image description here"></p><h2 id="å®ä¾‹-demo-å‚è€ƒ"><a href="#å®ä¾‹-demo-å‚è€ƒ" class="headerlink" title="å®ä¾‹ demo å‚è€ƒ"></a>å®ä¾‹ demo å‚è€ƒ</h2><ul><li><strong><a href="https://developer.aliyun.com/codesample/9?spm=a2c6h.17640777.J_7225173660.1.7b0b54e1wmvdkP" rel="external nofollow noreferrer">è·å– ECS å®ä¾‹é…ç½®</a></strong></li><li><strong><a href="https://developer.aliyun.com/codesample/6?spm=a2c6h.17640777.J_7225173660.2.7b0b54e1wmvdkP" rel="external nofollow noreferrer">åˆ›å»º HTTP ç›‘å¬</a></strong></li><li><strong><a href="https://developer.aliyun.com/codesample/111?spm=a2c6h.17640777.J_7225173660.3.7b0b54e1wmvdkP" rel="external nofollow noreferrer">åˆ›å»º NAT ç½‘å…³</a></strong></li></ul><h2 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h2><p>æœ¬æ¬¡å¤§èµ›é¢å‘æ‰€æœ‰çš„å¼€å‘è€…ï¼Œæ‹›å‹Ÿé˜¿é‡Œäº‘ OpenAPI ç¤ºä¾‹ä»£ç ï¼ˆCodeSampleï¼‰ï¼Œæ— è®ºæ‚¨æ˜¯å…¥é—¨å¼€å‘ï¼Œæˆ–æ˜¯è¿ç»´å¤§ç¥ï¼Œåªè¦æ‚¨å¯¹é˜¿é‡Œäº‘OpenAPI æ„Ÿå…´è¶£ï¼Œå°±å¯æŠ¥åå‚èµ›å¹¶ä¸”æäº¤ä½œå“ã€‚</p><p>1ã€æŠ¥åæ–¹å¼ï¼šç™»å½•æ¯”èµ›å®˜ç½‘ï¼Œç‚¹å‡»æŠ¥åé“¾æ¥ï¼Œå®Œæˆä¸ªäººä¿¡æ¯ç™»è®°åæŠ¥åæˆåŠŸï¼›</p><p>2ã€é€‰æ‰‹ä»¥ä¸ªäººå½¢å¼å‚ä¸ï¼Œå¹¶ç¡®ä¿æŠ¥åä¿¡æ¯å‡†ç¡®æœ‰æ•ˆï¼›</p><p>3ã€é€‰æ‰‹äº¤æµå®˜æ–¹é’‰é’‰ç¾¤ï¼š</p><p><img src="https://tianchi-public.oss-cn-hangzhou.aliyuncs.com/public/files/forum/159886906170617151598869059092.jpeg" alt="enter image description here"></p><h2 id="å¤§èµ›ç»„ç»‡"><a href="#å¤§èµ›ç»„ç»‡" class="headerlink" title="å¤§èµ›ç»„ç»‡"></a>å¤§èµ›ç»„ç»‡</h2><p>ä¸»åŠæ–¹ï¼šé˜¿é‡Œäº‘å¼€æ”¾å¹³å° | é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº | é˜¿é‡Œäº‘å†…å®¹è®¾è®¡éƒ¨</p><hr><h1 id="å¤§å®æŠ¥å"><a href="#å¤§å®æŠ¥å" class="headerlink" title="å¤§å®æŠ¥å"></a>å¤§å®æŠ¥å</h1><p><img src="2020-09-05-aliyun-game/001.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬æ¬¡å¤§èµ›ç”±é˜¿é‡Œäº‘å¼€æ”¾å¹³å°&amp;amp;é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº&amp;amp;é˜¿é‡Œäº‘å†…å®¹è®¾è®¡éƒ¨è”åˆä¸¾åŠã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¤§èµ›ç®€ä»‹&quot;&gt;&lt;a href=&quot;#å¤§èµ›ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;å¤§èµ›ç®€ä»‹&quot;&gt;&lt;/a&gt;å¤§èµ›ç®€ä»‹&lt;/h2&gt;&lt;p&gt;é˜¿é‡Œäº‘å¼€æ”¾å¹³å°æºæ‰‹å¼€å‘
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>MySQLå‚æ•°-sql_auto_is_null</title>
    <link href="http://www.toberoot.com/news/2020/07/14/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/07/14/tec-mysql/</id>
    <published>2020-07-14T00:00:00.000Z</published>
    <updated>2020-07-14T03:43:17.617Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sql-auto-is-null"><a href="#sql-auto-is-null" class="headerlink" title="sql_auto_is_null"></a>sql_auto_is_null</h1><p><a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_sql_auto_is_null" rel="external nofollow noreferrer">sql_auto_is_null</a></p><ul><li><table><thead><tr><th>å±æ€§</th><th>å€¼</th></tr></thead><tbody><tr><td>ç³»ç»Ÿå˜é‡</td><td><code>sql_auto_is_null</code></td></tr><tr><td>èŒƒå›´</td><td>å…¨çƒä¼šè®®</td></tr><tr><td>åŠ¨æ€</td><td>æ˜¯</td></tr><tr><td><a href="https://dev.mysql.com/doc/refman/8.0/en/optimizer-hints.html#optimizer-hints-set-var" rel="external nofollow noreferrer"><code>SET_VAR</code></a> æç¤ºé€‚ç”¨</td><td>æ˜¯</td></tr><tr><td>ç±»å‹</td><td>å¸ƒå°”å‹</td></tr><tr><td>é»˜è®¤å€¼</td><td><code>OFF</code></td></tr></tbody></table><p>å¦‚æœå¯ç”¨äº†æ­¤å˜é‡ï¼Œåˆ™åœ¨æˆåŠŸæ’å…¥è‡ªåŠ¨ç”Ÿæˆçš„<code>AUTO_INCREMENT</code>å€¼çš„è¯­å¥ä¹‹å ï¼Œå¯ä»¥é€šè¿‡å‘å‡ºä»¥ä¸‹å½¢å¼çš„è¯­å¥æ¥æ‰¾åˆ°è¯¥å€¼ï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tbl_name <span class="keyword">WHERE</span> auto_col <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¯¥è¯­å¥è¿”å›ä¸€è¡Œï¼Œåˆ™è¿”å›çš„å€¼ä¸è°ƒç”¨è¯¥<a href="https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_last-insert-id" rel="external nofollow noreferrer"><code>LAST_INSERT_ID()</code></a>å‡½æ•°çš„å€¼ç›¸åŒã€‚<br>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åœ¨å¤šè¡Œæ’å…¥ä¹‹åçš„è¿”å›å€¼ï¼Œè¯·å‚è§<a href="https://dev.mysql.com/doc/refman/8.0/en/information-functions.html" rel="external nofollow noreferrer">ç¬¬12.15èŠ‚â€œä¿¡æ¯å‡½æ•°â€</a>ã€‚å¦‚æœæ²¡æœ‰<code>AUTO_INCREMENT</code>æˆåŠŸæ’å…¥ä»»ä½•<br>å€¼ï¼Œåˆ™è¯¥<a href="https://dev.mysql.com/doc/refman/8.0/en/select.html" rel="external nofollow noreferrer"><code>SELECT</code></a>è¯­å¥ä¸è¿”å›ä»»ä½•è¡Œã€‚</p><p>æŸäº›ODBCç¨‹åºï¼ˆä¾‹å¦‚Accessï¼‰ä½¿ç”¨é€šè¿‡æ¯”è¾ƒæ¥ æ£€ç´¢<code>AUTO_INCREMENT</code>å€¼<br>çš„è¡Œä¸º <a href="https://dev.mysql.com/doc/refman/8.0/en/comparison-operators.html#operator_is-null" rel="external nofollow noreferrer"><code>IS NULL</code></a>ã€‚è¯·å‚é˜… <a href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" rel="external nofollow noreferrer">è·å–è‡ªåŠ¨å¢é‡å€¼</a>ã€‚å¯ä»¥é€šè¿‡è®¾ç½®<a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_sql_auto_is_null" rel="external nofollow noreferrer"><code>sql_auto_is_null</code></a>ä¸º ç¦ç”¨æ­¤è¡Œä¸º <code>OFF</code>ã€‚</p><p>åœ¨æ­¤ä¹‹å‰çš„MySQL 8.0.16ï¼Œæ”¹é€ ï¼Œä»¥ æ‰§è¡Œè¯¥è¯­å¥æ—¶ï¼Œæ‰è¢«æ‰§è¡Œï¼Œè¿™æ ·çš„å€¼<br>æ‰§è¡ŒæœŸé—´ç¡®å®šæŸ¥è¯¢æ˜¯å¦è½¬åŒ–ã€‚åœ¨MySQL 8.0.16åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œè½¬æ¢æ˜¯åœ¨è¯­å¥å‡†å¤‡æœŸé—´æ‰§è¡Œçš„ã€‚ <code>WHERE *</code>auto_col<code>* IS NULL``WHERE *</code>auto_col<code>* = LAST_INSERT_ID()``sql_auto_is_null</code></p><p>é»˜è®¤å€¼ <a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_sql_auto_is_null" rel="external nofollow noreferrer"><code>sql_auto_is_null</code></a>æ˜¯ <code>OFF</code>ã€‚</p></li></ul><h1 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h1><ol><li>æŸ¥çœ‹å½“å‰å‚æ•°å€¼<code>select @@sql_auto_is_null;</code></li><li>è®¾ç½®å‚æ•°ä¸ºå¼€å¯<code>set @@sql_auto_is_null=1;</code><br> 2.1 åˆ›å»ºå¸¦è‡ªå¢é•¿ä¸»é”®çš„è¡¨test1 <code>create table test1 (id int primary key auto_increment, name varchar(255));</code><br> 2.2 æ’å…¥æ•°æ® <code>insert into test1 set name=&#39;booboo&#39;;</code><br> 2.3 æŸ¥çœ‹idä¸ä¸ºnullçš„åˆ— <code>SELECT * FROM fms.test1 WHERE id IS NULL;</code></li><li>è®¾ç½®å‚æ•°ä¸ºå…³é—­<code>set @@sql_auto_is_null=0;</code><br> 3.1 æ’å…¥æ•°æ® <code>insert into test1 set name=&#39;tom&#39;;</code><br> 3.2 æŸ¥çœ‹idä¸ä¸ºnullçš„åˆ— <code>SELECT * FROM fms.test1 WHERE id IS NULL;</code></li></ol><blockquote class="note warn"><strong class="note-title">æ€»ç»“</strong><p>sql_auto_is_null å‚æ•°é»˜è®¤å€¼ä¸ºOFF å…³é—­ 0<br>æŸäº›ODBCç¨‹åºï¼ˆä¾‹å¦‚Accessï¼‰ä½¿ç”¨é€šè¿‡æ¯”è¾ƒæ¥ æ£€ç´¢<code>AUTO_INCREMENT</code>å€¼ çš„è¡Œä¸º [<code>IS NULL</code>]<br>åœ¨å‚æ•°å€¼ä¸ºONçš„æƒ…å†µä¸‹ï¼Œå¯æ‰§è¡Œ<code>select * from table where id is null;</code><br>ä¸å»ºè®®å¼€å¯ã€‚</p></blockquote>    <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt;select @@sql_auto_is_null;</span><br><span class="line">+------------------------------+</span><br><span class="line">| @@sql_auto_is_null           |</span><br><span class="line">+------------------------------+</span><br><span class="line">| 0                            |</span><br><span class="line">+------------------------------+</span><br><span class="line">è¿”å›è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š5 ms.</span><br><span class="line">mysql&gt;<span class="built_in">set</span> @@sql_auto_is_null=1;</span><br><span class="line">æ‰§è¡ŒæˆåŠŸï¼Œè€—æ—¶ï¼š7 ms.</span><br><span class="line">mysql&gt;create table test1 (id int primary key auto_increment, name varchar(255));</span><br><span class="line">æ‰§è¡ŒæˆåŠŸï¼Œè€—æ—¶ï¼š113 ms.</span><br><span class="line">mysql&gt;insert into test1 <span class="built_in">set</span> name=<span class="string">'booboo'</span></span><br><span class="line">å½±å“è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š86 ms.</span><br><span class="line">mysql&gt;select * from test1;</span><br><span class="line">+--------------+----------------+</span><br><span class="line">| id           | name           |</span><br><span class="line">+--------------+----------------+</span><br><span class="line">|            1 | booboo         |</span><br><span class="line">+--------------+----------------+</span><br><span class="line">è¿”å›è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š6 ms.</span><br><span class="line">mysql&gt;select @@sql_auto_is_null;</span><br><span class="line">+------------------------------+</span><br><span class="line">| @@sql_auto_is_null           |</span><br><span class="line">+------------------------------+</span><br><span class="line">| 1                            |</span><br><span class="line">+------------------------------+</span><br><span class="line">è¿”å›è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š4 ms.</span><br><span class="line">mysql&gt;SELECT * FROM fms.test1 WHERE id IS NULL</span><br><span class="line">+--------------+----------------+</span><br><span class="line">| id           | name           |</span><br><span class="line">+--------------+----------------+</span><br><span class="line">|            1 | booboo         |</span><br><span class="line">+--------------+----------------+</span><br><span class="line">è¿”å›è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š16 ms.</span><br><span class="line">mysql&gt;<span class="built_in">set</span> @@sql_auto_is_null=0;</span><br><span class="line">æ‰§è¡ŒæˆåŠŸï¼Œè€—æ—¶ï¼š5 ms.</span><br><span class="line">mysql&gt;insert into test1 <span class="built_in">set</span> name=<span class="string">'tom'</span></span><br><span class="line">å½±å“è¡Œæ•°ï¼š[1]ï¼Œè€—æ—¶ï¼š11 ms.</span><br><span class="line">mysql&gt;SELECT * FROM fms.test1 WHERE id IS NULL</span><br><span class="line">+--------------+----------------+</span><br><span class="line">| id           | name           |</span><br><span class="line">+--------------+----------------+</span><br><span class="line">è¿”å›è¡Œæ•°ï¼š[0]ï¼Œè€—æ—¶ï¼š4 ms.</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;sql-auto-is-null&quot;&gt;&lt;a href=&quot;#sql-auto-is-null&quot; class=&quot;headerlink&quot; title=&quot;sql_auto_is_null&quot;&gt;&lt;/a&gt;sql_auto_is_null&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.toberoot.com/tags/MySQL/"/>
    
      <category term="å‚æ•°" scheme="http://www.toberoot.com/tags/%E5%8F%82%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨Tableæ–¹å¼è®°å½•</title>
    <link href="http://www.toberoot.com/news/2020/06/03/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/06/03/tec-mysql/</id>
    <published>2020-06-03T10:47:33.000Z</published>
    <updated>2020-06-10T06:37:36.889Z</updated>
    
    <content type="html"><![CDATA[<p>é»˜è®¤MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨FILEè®°å½•ï¼Œä¸ºæ–¹ä¾¿æ•°æ®åˆ†æï¼Œæ”¹ä¸ºä½¿ç”¨Tableçš„æ–¹å¼ä¿å­˜ï¼Œæ–¹ä¾¿æ‹‰å–åè¿‡æ»¤åˆ†æã€‚</p><blockquote class="note info"><strong class="note-title">MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨Tableæ–¹å¼è®°å½•</strong><ol><li>å¼€å¯æ…¢æŸ¥è¯¢</li><li>è®¾ç½®å¿…è¦å‚æ•°</li><li>è®¾ç½®é‡‡é›†å™¨</li><li>è®¾ç½®è½®è¯¢</li></ol></blockquote><h2 id="æŸ¥çœ‹æ…¢æŸ¥è¯¢ç›¸å…³å‚æ•°"><a href="#æŸ¥çœ‹æ…¢æŸ¥è¯¢ç›¸å…³å‚æ•°" class="headerlink" title="æŸ¥çœ‹æ…¢æŸ¥è¯¢ç›¸å…³å‚æ•°"></a>æŸ¥çœ‹æ…¢æŸ¥è¯¢ç›¸å…³å‚æ•°</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'slow_query_log'</span> <span class="keyword">as</span>  parameter, </span><br><span class="line">  @@slow_query_log  <span class="keyword">as</span>  <span class="keyword">value</span>, <span class="string">'æ…¢æŸ¥è¯¢æ—¥å¿—å¼€å¯çŠ¶æ€'</span> <span class="keyword">as</span>  info</span><br><span class="line"><span class="keyword">UNION</span>  </span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'long_query_time'</span>, </span><br><span class="line">  @@long_query_time, <span class="string">'æ…¢æŸ¥è¯¢é˜ˆå€¼'</span> </span><br><span class="line"><span class="keyword">UNION</span>  </span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'log_output'</span>, </span><br><span class="line">  @@log_output, </span><br><span class="line">  <span class="string">'æ…¢æŸ¥è¯¢ä¿å­˜æ–¹å¼'</span> </span><br><span class="line"><span class="keyword">UNION</span>  </span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'slow_query_log_file'</span>, </span><br><span class="line">  @@slow_query_log_file, <span class="string">'æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶'</span> </span><br><span class="line"><span class="keyword">UNION</span>  </span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'log_queries_not_using_indexes'</span>, </span><br><span class="line">  @@log_queries_not_using_indexes, </span><br><span class="line">  <span class="string">'æœªä½¿ç”¨ç´¢å¼•æŸ¥è¯¢æ˜¯å¦è®°å½•'</span> </span><br><span class="line"><span class="keyword">UNION</span>  </span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">  <span class="string">'log_slow_admin_statements'</span>, </span><br><span class="line">  @@log_slow_admin_statements, </span><br><span class="line">  <span class="string">'æ˜¯å¦å°†æ…¢ç®¡ç†è¯­å¥åŒ…å«ä¾‹å¦‚analyze'</span>;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p><table><thead><tr><th>parameter</th><th>value</th><th>info</th></tr></thead><tbody><tr><td>slow_query_log</td><td>1</td><td>æ…¢æŸ¥è¯¢æ—¥å¿—å¼€å¯çŠ¶æ€</td></tr><tr><td>long_query_time</td><td>0.1</td><td>æ…¢æŸ¥è¯¢é˜ˆå€¼</td></tr><tr><td>log_output</td><td>TABLE</td><td>æ…¢æŸ¥è¯¢ä¿å­˜æ–¹å¼</td></tr><tr><td>slow_query_log_file</td><td>dataslow.log</td><td>æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶</td></tr><tr><td>log_queries_not_using_indexes</td><td>1</td><td>æœªä½¿ç”¨ç´¢å¼•æŸ¥è¯¢æ˜¯å¦è®°å½•</td></tr><tr><td>log_slow_admin_statements</td><td>1</td><td>æ˜¯å¦å°†æ…¢ç®¡ç†è¯­å¥åŒ…å«ä¾‹å¦‚analyze</td></tr></tbody></table><h2 id="å¼€å¯æ…¢æŸ¥è¯¢Tableæ–¹å¼"><a href="#å¼€å¯æ…¢æŸ¥è¯¢Tableæ–¹å¼" class="headerlink" title="å¼€å¯æ…¢æŸ¥è¯¢Tableæ–¹å¼"></a>å¼€å¯æ…¢æŸ¥è¯¢Tableæ–¹å¼</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'%log%'</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> log_output=<span class="string">'TABLE'</span>;</span><br><span class="line">desc slow_log;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@MySQL-01 11:43:  [(none)]&gt; show variables like <span class="string">'log_output'</span>;</span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| log_output    | FILE  |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:43:  [(none)]&gt; <span class="built_in">set</span> global log_output=<span class="string">'TABLE'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:44:  [(none)]&gt; show variables like <span class="string">'log_output'</span>;</span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| log_output    | TABLE |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:44:  [(none)]&gt; use mysql;</span><br><span class="line">Database changed</span><br><span class="line">root@MySQL-01 11:44:  [mysql]&gt; show tables;</span><br><span class="line">+---------------------------+</span><br><span class="line">| Tables_in_mysql           |</span><br><span class="line">+---------------------------+</span><br><span class="line">| columns_priv              |</span><br><span class="line">| db                        |</span><br><span class="line">| engine_cost               |</span><br><span class="line">| event                     |</span><br><span class="line">| func                      |</span><br><span class="line">| general_log               |</span><br><span class="line">| gtid_executed             |</span><br><span class="line">| help_category             |</span><br><span class="line">| help_keyword              |</span><br><span class="line">| help_relation             |</span><br><span class="line">| help_topic                |</span><br><span class="line">| innodb_index_stats        |</span><br><span class="line">| innodb_table_stats        |</span><br><span class="line">| ndb_binlog_index          |</span><br><span class="line">| plugin                    |</span><br><span class="line">| proc                      |</span><br><span class="line">| procs_priv                |</span><br><span class="line">| proxies_priv              |</span><br><span class="line">| server_cost               |</span><br><span class="line">| servers                   |</span><br><span class="line">| slave_master_info         |</span><br><span class="line">| slave_relay_log_info      |</span><br><span class="line">| slave_worker_info         |</span><br><span class="line">| slow_log                  |</span><br><span class="line">| tables_priv               |</span><br><span class="line">| time_zone                 |</span><br><span class="line">| time_zone_leap_second     |</span><br><span class="line">| time_zone_name            |</span><br><span class="line">| time_zone_transition      |</span><br><span class="line">| time_zone_transition_type |</span><br><span class="line">| user                      |</span><br><span class="line">+---------------------------+</span><br><span class="line">31 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:44:  [mysql]&gt; seledct * from slow_log <span class="built_in">limit</span> 1\G;</span><br><span class="line">ERROR 1064 (42000): You have an error <span class="keyword">in</span> your SQL syntax; check the manual that corresponds to your MySQL server version <span class="keyword">for</span> the right syntax to use near <span class="string">'seledct * from slow_log limit 1'</span> at line 1</span><br><span class="line">ERROR:</span><br><span class="line">No query specified</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:44:  [mysql]&gt; select * from slow_log <span class="built_in">limit</span> 1\G;</span><br><span class="line">Empty <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR:</span><br><span class="line">No query specified</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:44:  [mysql]&gt; desc slow_log</span><br><span class="line">    -&gt; ;</span><br><span class="line">+----------------+---------------------+------+-----+----------------------+--------------------------------+</span><br><span class="line">| Field          | Type                | Null | Key | Default              | Extra                          |</span><br><span class="line">+----------------+---------------------+------+-----+----------------------+--------------------------------+</span><br><span class="line">| start_time     | timestamp(6)        | NO   |     | CURRENT_TIMESTAMP(6) | on update CURRENT_TIMESTAMP(6) |</span><br><span class="line">| user_host      | mediumtext          | NO   |     | NULL                 |                                |</span><br><span class="line">| query_time     | time(6)             | NO   |     | NULL                 |                                |</span><br><span class="line">| lock_time      | time(6)             | NO   |     | NULL                 |                                |</span><br><span class="line">| rows_sent      | int(11)             | NO   |     | NULL                 |                                |</span><br><span class="line">| rows_examined  | int(11)             | NO   |     | NULL                 |                                |</span><br><span class="line">| db             | varchar(512)        | NO   |     | NULL                 |                                |</span><br><span class="line">| last_insert_id | int(11)             | NO   |     | NULL                 |                                |</span><br><span class="line">| insert_id      | int(11)             | NO   |     | NULL                 |                                |</span><br><span class="line">| server_id      | int(10) unsigned    | NO   |     | NULL                 |                                |</span><br><span class="line">| sql_text       | mediumblob          | NO   |     | NULL                 |                                |</span><br><span class="line">| thread_id      | bigint(21) unsigned | NO   |     | NULL                 |                                |</span><br><span class="line">+----------------+---------------------+------+-----+----------------------+--------------------------------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®è½®è¯¢"><a href="#è®¾ç½®è½®è¯¢" class="headerlink" title="è®¾ç½®è½®è¯¢"></a>è®¾ç½®è½®è¯¢</h2><p>å› <code>mysql.slow_log</code>ä½¿ç”¨çš„æ˜¯CSV å­˜å‚¨å¼•æ“ï¼Œä¸åˆ©äºæŸ¥è¯¢åˆ†æï¼Œå› æ­¤æˆ‘ä»¬æ¯æ—¥åˆ›å»ºinnodbå¼•æ“çš„è¡¨å¹¶å°†æ•°æ®å¯¼å…¥æ–°è¡¨ï¼Œå¹¶æ¸…ç©ºæ—¥å¿—è¡¨ã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> booboo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> booboo.<span class="string">`slow_log`</span> (</span><br><span class="line">  <span class="string">`start_time`</span> <span class="built_in">timestamp</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span>(<span class="number">6</span>) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span>(<span class="number">6</span>),</span><br><span class="line">  <span class="string">`user_host`</span> mediumtext <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`query_time`</span> <span class="built_in">time</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`lock_time`</span> <span class="built_in">time</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`rows_sent`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`rows_examined`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`db`</span> <span class="built_in">varchar</span>(<span class="number">512</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`last_insert_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`insert_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`server_id`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`sql_text`</span> mediumblob <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`thread_id`</span> <span class="built_in">bigint</span>(<span class="number">21</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">innodb</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'Slow log'</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> booboo.slow_log  <span class="keyword">select</span> * <span class="keyword">from</span> mysql.slow_log;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> booboo.slow_log <span class="keyword">add</span> <span class="keyword">index</span> idx_dba(start_time,db,query_time);</span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> mysql.slow_log;</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨çš„æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> slow_log <span class="keyword">where</span> start_time &gt; <span class="string">"2020-06-01"</span> <span class="keyword">and</span> db=<span class="string">'test'</span> <span class="keyword">order</span> <span class="keyword">by</span> query_time <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿäº§æ¡ˆä¾‹"><a href="#ç”Ÿäº§æ¡ˆä¾‹" class="headerlink" title="ç”Ÿäº§æ¡ˆä¾‹"></a>ç”Ÿäº§æ¡ˆä¾‹</h2><blockquote class="note warn"><strong class="note-title">RDS For MySQL æ…¢æŸ¥è¯¢æ—¥å¿—æ¸…ç†</strong><ol><li>ç›®å‰mysql.slow_logä¿å­˜äº†ä»2017-4æœˆå¼€å§‹åˆ°ç°åœ¨çš„æ‰€æœ‰æ…¢æ—¥å¿—ï¼Œæ•°æ®é‡å¤§</li><li>è¯¥è¡¨ç›®å‰æ— ç´¢å¼•</li><li>æŒ‰ç…§ <code>query_time</code> æŸ¥è¯¢æ…¢æŸ¥è¯¢éå¸¸æ…¢ï¼Œç›´æ¥æŠ¥é”™</li></ol><p>è§£å†³å»ºè®®ï¼š</p><ol><li>é˜¿é‡Œå·¥å•è¯¢é—®RDS5.7æ˜¯å¦æœ‰å‚æ•°æ§åˆ¶è¯¥è¡¨çš„å®šæœŸåˆ é™¤ï¼Œä¾‹å¦‚åªä¿ç•™7å¤©çš„æ…¢æŸ¥è¯¢(<code>truncate mysql.slow_log;</code>)</li><li>é˜¿é‡Œäº§å“æ²¡æœ‰ç°æˆçš„é…ç½®ï¼Œåˆ™è‡ªå·±å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å®šæœŸæ¸…ç†å³å¯</li></ol></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;é»˜è®¤MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨FILEè®°å½•ï¼Œä¸ºæ–¹ä¾¿æ•°æ®åˆ†æï¼Œæ”¹ä¸ºä½¿ç”¨Tableçš„æ–¹å¼ä¿å­˜ï¼Œæ–¹ä¾¿æ‹‰å–åè¿‡æ»¤åˆ†æã€‚&lt;/p&gt;
&lt;blockquote class=&quot;note info&quot;&gt;&lt;strong class=&quot;note-title&quot;&gt;MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨Tableæ–¹å¼è®°å½•&lt;/st
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.toberoot.com/tags/MySQL/"/>
    
      <category term="æ…¢æŸ¥è¯¢" scheme="http://www.toberoot.com/tags/%E6%85%A2%E6%9F%A5%E8%AF%A2/"/>
    
  </entry>
  
  <entry>
    <title>MySQLæ…¢æŸ¥è¯¢ä½¿ç”¨FILEæ–¹å¼è®°å½•</title>
    <link href="http://www.toberoot.com/news/2020/06/03/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/06/03/tec-mysql/</id>
    <published>2020-06-02T17:47:33.000Z</published>
    <updated>2020-06-02T04:41:48.988Z</updated>
    
    <content type="html"><![CDATA[<p>mysql æ•°æ®åº“æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†ææ˜¯ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½çš„é‡è¦æ–¹å¼ä¹‹ä¸€ï¼Œéšç€æ—¶é—´ç§¯ç´¯ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œä½œä¸€ä¸ªæ¯å¤©è‡ªåŠ¨åˆ‡å‰²çš„ä»»åŠ¡ï¼Œå°†è„šæœ¬æ”¾åœ¨/etc/logrotate.d/ä¸‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><blockquote class="note info"><strong class="note-title">åˆ·æ–°æ…¢æŸ¥è¯¢æ—¥å¿—çš„ä¸€èˆ¬æ­¥éª¤</strong><ol><li>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—è·¯å¾„<code>select @@datadir;</code>ï¼›</li><li>é‡å‘½åæ…¢æŸ¥è¯¢æ—¥å¿—<code>mv a b</code>ï¼›</li><li>ç™»é™†æ•°æ®åº“<code>flush slow logs;</code></li></ol></blockquote><h2 id="logrotateå®ç°"><a href="#logrotateå®ç°" class="headerlink" title="logrotateå®ç°"></a>logrotateå®ç°</h2><p>ä¿®æ”¹<code>my.cnf</code>,æ–¹ä¾¿è‡ªåŠ¨è½®è¯¢æ—¥å¿—æ—¶å€™è‡ªåŠ¨åŠ è½½ç”¨æˆ·åå¯†ç </p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">[client]</span><br><span class="line">user=root</span><br><span class="line">password=123456</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br></pre></td></tr></table></figure><p>åœ¨/etc/logrotate.d/ä¸‹æ–°å»ºä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># vim /etc/logrotate.d/mysql</span></span><br></pre></td></tr></table></figure><p>è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/var/<span class="built_in">log</span>/mysql/*<span class="built_in">log</span> &#123;</span><br><span class="line">    daily</span><br><span class="line">    rotate 7</span><br><span class="line">    missingok</span><br><span class="line">    notifempty</span><br><span class="line">    delaycompress</span><br><span class="line">    create 644 mysql mysql</span><br><span class="line">    postrotate</span><br><span class="line">        MYCNF_FILE=/root/.my.cnf</span><br><span class="line">        MYSQLADMIN=/usr/bin/mysqladmin</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">test</span> -x <span class="variable">$MYSQLADMIN</span> &amp;&amp; <span class="variable">$MYSQLADMIN</span> --defaults-file=<span class="string">"<span class="variable">$MYCNF_FILE</span>"</span> ping &gt;/dev/null</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">            <span class="variable">$MYSQLADMIN</span> --defaults-file=<span class="string">"<span class="variable">$MYCNF_FILE</span>"</span> flush-logs</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°åŠ è½½croné…ç½®</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># service crond reload</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å­å°±æ–°å»ºå¥½äº†æ…¢æŸ¥è¯¢æ—¥å¿—æ¯å¤©åˆ†å‰²ï¼Œä¿ç•™7å¤©</p><h2 id="crontabå®ç°"><a href="#crontabå®ç°" class="headerlink" title="crontabå®ç°"></a>crontabå®ç°</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">mysql=<span class="string">''</span></span><br><span class="line">user=<span class="string">''</span></span><br><span class="line">password=<span class="string">''</span></span><br><span class="line">ip=<span class="string">''</span></span><br><span class="line">archived_log=slow.`date +%Y%m%d%H`.<span class="built_in">log</span></span><br><span class="line">slowlog=`<span class="variable">$mysql</span> -u<span class="variable">$user</span> -p<span class="variable">$password</span> -h<span class="variable">$ip</span> -e<span class="string">"show global variables like 'slow%';"</span> 2&gt; /dev/null | grep <span class="string">'slow_query_log_file'</span> | awk -F <span class="string">' '</span> &#123;<span class="string">'print $2'</span>&#125;`</span><br><span class="line">datadir=`mysql -u<span class="variable">$user</span> -p<span class="variable">$password</span>  -e<span class="string">"show global variables like 'data%';"</span> 2&gt; /dev/null | grep datadir |  awk -F <span class="string">' '</span> &#123;<span class="string">'print $2'</span>&#125;`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$slowlog</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$datadir</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;datadir&#125;</span>/<span class="variable">$&#123;slowlog&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;datadir&#125;</span>/<span class="variable">$&#123;archived_log&#125;</span></span><br><span class="line">mv <span class="variable">$&#123;datadir&#125;</span>/<span class="variable">$&#123;slowlog&#125;</span> <span class="variable">$&#123;datadir&#125;</span>/<span class="variable">$&#123;archived_log&#125;</span></span><br><span class="line"><span class="variable">$mysql</span> -u<span class="variable">$user</span> -p<span class="variable">$password</span> -h<span class="variable">$ip</span> -e<span class="string">"flush slow logs"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"å½’æ¡£æˆåŠŸï¼Œè·¯å¾„ä¸º"</span>&#123;archived_log&#125;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@NB-flexgw1:/root]<span class="comment"># bash -x auto_cut_mysqlslowlog.sh</span></span><br><span class="line">+ mysql=mysql</span><br><span class="line">+ user=root</span><br><span class="line">+ password=root</span><br><span class="line">+ ip=localhost</span><br><span class="line">++ date +%Y%m%d%H</span><br><span class="line">+ archived_log=slow.2020060211.log</span><br><span class="line">++ mysql -uroot -proot -hlocalhost <span class="string">'-eshow global variables like '</span>\<span class="string">''</span>slow%<span class="string">'\'</span><span class="string">';'</span></span><br><span class="line">++ grep slow_query_log_file</span><br><span class="line">++ awk -F <span class="string">' '</span> <span class="string">'&#123;print $2&#125;'</span></span><br><span class="line">+ slowlog=dataslow.log</span><br><span class="line">++ mysql -uroot -proot <span class="string">'-eshow global variables like '</span>\<span class="string">''</span>data%<span class="string">'\'</span><span class="string">';'</span></span><br><span class="line">++ grep datadir</span><br><span class="line">++ awk -F <span class="string">' '</span> <span class="string">'&#123;print $2&#125;'</span></span><br><span class="line">+ datadir=/alidata/mysql/data/</span><br><span class="line">+ <span class="built_in">echo</span> dataslow.log</span><br><span class="line">dataslow.log</span><br><span class="line">+ <span class="built_in">echo</span> /alidata/mysql/data/</span><br><span class="line">/alidata/mysql/data/</span><br><span class="line">+ <span class="built_in">echo</span> /alidata/mysql/data//dataslow.log</span><br><span class="line">/alidata/mysql/data//dataslow.log</span><br><span class="line">+ <span class="built_in">echo</span> /alidata/mysql/data//slow.2020060211.log</span><br><span class="line">/alidata/mysql/data//slow.2020060211.log</span><br><span class="line">+ mv /alidata/mysql/data//dataslow.log /alidata/mysql/data//slow.2020060211.log</span><br><span class="line">+ mysql -uroot -proot -hlocalhost <span class="string">'-eflush slow logs'</span></span><br><span class="line">mysql: [Warning] Using a password on the <span class="built_in">command</span> line interface can be insecure.</span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">'å½’æ¡£æˆåŠŸï¼Œè·¯å¾„ä¸º&#123;archived_log&#125;'</span></span><br><span class="line">å½’æ¡£æˆåŠŸï¼Œè·¯å¾„ä¸º&#123;archived_log&#125;</span><br></pre></td></tr></table></figure><p>æ–°çš„æ…¢æ—¥å¿—äº§ç”Ÿï¼Œå¯¹ç³»ç»Ÿä¸ä¼šé€ æˆå½±å“,æŸ¥çœ‹å½’æ¡£åçš„æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@NB-flexgw1:/root]<span class="comment"># ll /alidata/mysql/data/slow*</span></span><br><span class="line">-rw-r----- 1 mysql mysql 162702214 6æœˆ   2 11:40 /alidata/mysql/data/slow.2020060211.log</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;mysql æ•°æ®åº“æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†ææ˜¯ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½çš„é‡è¦æ–¹å¼ä¹‹ä¸€ï¼Œéšç€æ—¶é—´ç§¯ç´¯ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œä½œä¸€ä¸ªæ¯å¤©è‡ªåŠ¨åˆ‡å‰²çš„ä»»åŠ¡ï¼Œå°†è„šæœ¬æ”¾åœ¨/etc/logrotate.d/ä¸‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote class=&quot;note info&quot;&gt;&lt;strong 
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.toberoot.com/tags/MySQL/"/>
    
      <category term="æ…¢æŸ¥è¯¢" scheme="http://www.toberoot.com/tags/%E6%85%A2%E6%9F%A5%E8%AF%A2/"/>
    
  </entry>
  
  <entry>
    <title>Oracle11gå¸¸ç”¨è§†å›¾</title>
    <link href="http://www.toberoot.com/news/2020/05/29/tec-oracle/"/>
    <id>http://www.toberoot.com/news/2020/05/29/tec-oracle/</id>
    <published>2020-05-28T16:11:33.000Z</published>
    <updated>2020-05-28T08:11:50.904Z</updated>
    
    <content type="html"><![CDATA[<table><thead><tr><th>Oracleå¸¸ç”¨è§†å›¾</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_4045.htm#REFRN23442" rel="external nofollow noreferrer">dba_hist_snapshot</a></td><td>åœ¨å·¥ä½œè´Ÿè½½å­˜å‚¨åº“ä¸­æ˜¾ç¤ºæœ‰å…³å¿«ç…§çš„ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2085.htm" rel="external nofollow noreferrer">v$osstat</a></td><td>æ˜¾ç¤ºæ¥è‡ªæ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿåˆ©ç”¨ç‡ç»Ÿè®¡ä¿¡æ¯ã€‚æ¯ä¸ªç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯è¿”å›ä¸€è¡Œ          * PHYSICAL_MEMORY_BYTES:Total number of bytes of physical memory     * NUM_CPUS:Number of CPUs or processors available</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_1097.htm#REFRN30047" rel="external nofollow noreferrer">v$database</a></td><td>æ˜¾ç¤ºæ§åˆ¶æ–‡ä»¶ä¸­æœ‰å…³æ•°æ®åº“çš„ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2002.htm" rel="external nofollow noreferrer">v$instance</a></td><td>æ˜¾ç¤ºå½“å‰å®ä¾‹çš„çŠ¶æ€ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_4212.htm" rel="external nofollow noreferrer">DBA_REGISTRY_HISTORY</a></td><td>æä¾›æœ‰å…³åœ¨æ•°æ®åº“ä¸Šæ‰§è¡Œçš„å‡çº§ï¼Œé™çº§å’Œé‡è¦è¡¥ä¸æ›´æ–°çš„ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2087.htm#REFRN30176" rel="external nofollow noreferrer">v$parameter</a>      <a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/initparams017.htm#REFRN10006" rel="external nofollow noreferrer">AUDIT_TRAIL</a>     <a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/initparams234.htm" rel="external nofollow noreferrer">SESSIONS</a>      <a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/initparams202.htm#REFRN10175" rel="external nofollow noreferrer">PROCESSES</a></td><td>æ˜¾ç¤ºæœ‰å…³è¯¥ä¼šè¯å½“å‰æœ‰æ•ˆçš„åˆå§‹åŒ–å‚æ•°çš„ä¿¡æ¯ã€‚         <br/> * audit_trail:å¯ç”¨æˆ–ç¦ç”¨æ•°æ®åº“å®¡æ ¸     <br/>* sessions:æŒ‡å®šç³»ç»Ÿä¸­å¯ä»¥åˆ›å»ºçš„æœ€å¤§ä¼šè¯æ•°ã€‚     <br/>* processes:æŒ‡å®šå¯ä»¥åŒæ—¶è¿æ¥åˆ°Oracleçš„æœ€å¤§æ“ä½œç³»ç»Ÿç”¨æˆ·è¿›ç¨‹æ•°ã€‚å®ƒçš„å€¼åº”å…è®¸æ‰€æœ‰åå°è¿›ç¨‹ï¼Œä¾‹å¦‚é”ï¼Œä½œä¸šé˜Ÿåˆ—è¿›ç¨‹å’Œå¹¶è¡Œæ‰§è¡Œè¿›ç¨‹ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_1016.htm#REFRN30011" rel="external nofollow noreferrer">V$ARCHIVED_LOG</a></td><td><code>V$ARCHIVED_LOG</code>æ˜¾ç¤ºæ§åˆ¶æ–‡ä»¶ä¸­çš„å­˜æ¡£æ—¥å¿—ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­˜æ¡£æ—¥å¿—åç§°ã€‚æˆåŠŸå½’æ¡£æˆ–æ¸…é™¤è”æœºé‡åšæ—¥å¿—åï¼Œå°†æ’å…¥å½’æ¡£æ—¥å¿—è®°å½•ï¼ˆ<code>NULL</code>å¦‚æœæ¸…é™¤äº†æ—¥å¿—ï¼Œåˆ™åç§°åˆ—ï¼‰ã€‚å¦‚æœæ—¥å¿—è¢«å½’æ¡£ä¸¤æ¬¡ï¼Œå°±ä¼šå‡ºç°å¸¦æœ‰ä¸¤ä¸ªç›¸åŒçš„å½’æ¡£æ—¥å¿—è®°å½•<code>THREAD#</code>ï¼Œ<code>SEQUENCE#</code>å’Œ<code>FIRST_CHANGE#</code>ï¼Œä½†ä½¿ç”¨ä¸åŒçš„åç§°ã€‚ä»å¤‡ä»½é›†æˆ–å‰¯æœ¬è¿˜åŸå­˜æ¡£æ—¥å¿—æ—¶ï¼Œä»¥åŠä½¿ç”¨RMAN  <code>COPY</code>å‘½ä»¤åˆ›å»ºæ—¥å¿—å‰¯æœ¬æ—¶ï¼Œä¹Ÿä¼šæ’å…¥å­˜æ¡£æ—¥å¿—è®°å½•ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2096.htm#REFRN30180" rel="external nofollow noreferrer">V$PGASTAT</a></td><td></td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_5081.htm#REFRN23302" rel="external nofollow noreferrer">dba_users</a></td><td><code>DBA_USERS</code> æè¿°æ•°æ®åº“çš„æ‰€æœ‰ç”¨æˆ·ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_1158.htm#i1583352" rel="external nofollow noreferrer">DBA_OBJECTS</a></td><td><code>DBA_OBJECTS</code>æè¿°æ•°æ®åº“ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚          <code>V$LOCKED_OBJECT</code>åˆ—å‡ºç³»ç»Ÿä¸Šæ¯ä¸ªäº‹åŠ¡è·å–çš„æ‰€æœ‰é”ã€‚å®ƒæ˜¾ç¤ºå“ªäº›ä¼šè¯åœ¨ä»€ä¹ˆå¯¹è±¡å’Œä»€ä¹ˆæ¨¡å¼ä¸‹æŒæœ‰DMLé”ï¼ˆå³TMç±»å‹çš„é˜Ÿåˆ—ï¼‰ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_3016.htm" rel="external nofollow noreferrer">v$session</a></td><td>æ˜¾ç¤ºæ¯ä¸ªå½“å‰ä¼šè¯çš„ä¼šè¯ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2030.htm#REFRN30125" rel="external nofollow noreferrer">v$locked_object</a></td><td></td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_3118.htm#REFRN30295" rel="external nofollow noreferrer">v$undostat</a></td><td>æ˜¾ç¤ºç»Ÿè®¡æ•°æ®çš„ç›´æ–¹å›¾ä»¥æ˜¾ç¤ºç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µã€‚å¯ç”¨çš„ç»Ÿè®¡ä¿¡æ¯åŒ…æ‹¬æ’¤æ¶ˆç©ºé—´æ¶ˆè€—ï¼Œäº‹åŠ¡å¹¶å‘ä»¥åŠåœ¨å®ä¾‹ä¸­æ‰§è¡Œçš„æŸ¥è¯¢çš„é•¿åº¦ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤è§†å›¾æ¥ä¼°è®¡å½“å‰å·¥ä½œè´Ÿè½½æ‰€éœ€çš„æ’¤æ¶ˆç©ºé—´é‡ã€‚Oracleä½¿ç”¨æ­¤è§†å›¾æ¥è°ƒæ•´ç³»ç»Ÿä¸­çš„æ’¤æ¶ˆä½¿ç”¨æƒ…å†µã€‚å¦‚æœç³»ç»Ÿå¤„äºæ‰‹åŠ¨æ’¤æ¶ˆç®¡ç†æ¨¡å¼ï¼Œåˆ™è¯¥è§†å›¾è¿”å›NULLå€¼ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2031.htm" rel="external nofollow noreferrer">v$log</a></td><td>æ˜¾ç¤ºæ§åˆ¶æ–‡ä»¶ä¸­çš„æ—¥å¿—æ–‡ä»¶ä¿¡æ¯ã€‚          <strong>STATUS</strong>æ—¥å¿—çŠ¶æ€ï¼š          - <code>UNUSED</code>-åœ¨çº¿é‡åšæ—¥å¿—ä»æœªå†™å…¥è¿‡ã€‚è¿™æ˜¯åˆšåˆšæ·»åŠ çš„é‡åšæ—¥å¿—çš„çŠ¶æ€ï¼Œæˆ–è€…<code>RESETLOGS</code>ä¸æ˜¯å½“å‰é‡åšæ—¥å¿—æ—¶åœ¨ä¹‹åçš„çŠ¶æ€ã€‚     - <code>CURRENT</code>-å½“å‰é‡åšæ—¥å¿—ã€‚è¿™æ„å‘³ç€é‡åšæ—¥å¿—å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚é‡åšæ—¥å¿—å¯ä»¥æ‰“å¼€æˆ–å…³é—­ã€‚     - <code>ACTIVE</code>-æ—¥å¿—å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œä½†ä¸æ˜¯å½“å‰æ—¥å¿—ã€‚å´©æºƒæ¢å¤éœ€è¦å®ƒã€‚å®ƒå¯èƒ½æ­£åœ¨ç”¨äºå—æ¢å¤ã€‚å®ƒå¯èƒ½å·²å­˜æ¡£ï¼Œä¹Ÿå¯èƒ½æœªå­˜æ¡£ã€‚     - <code>CLEARING</code>- <code>ALTER DATABASE CLEAR LOGFILE</code>è¯­å¥åï¼Œæ—¥å¿—å°†é‡æ–°åˆ›å»ºä¸ºç©ºæ—¥å¿—ã€‚æ¸…é™¤æ—¥å¿—åï¼ŒçŠ¶æ€å˜ä¸º<code>UNUSED</code>ã€‚     - <code>CLEARING_CURRENT</code>-å½“å‰æ—¥å¿—æ­£åœ¨æ¸…é™¤å…³é—­çš„çº¿ç¨‹ã€‚å¦‚æœäº¤æ¢æœºå‡ºç°æ•…éšœï¼Œä¾‹å¦‚I / Oé”™è¯¯å†™å…¥æ–°çš„æ—¥å¿—å¤´ï¼Œåˆ™æ—¥å¿—å¯ä»¥ä¿æŒæ­¤çŠ¶æ€ã€‚     - <code>INACTIVE</code>-å®ä¾‹æ¢å¤ä¸å†éœ€è¦æ—¥å¿—ã€‚å®ƒå¯èƒ½æ­£åœ¨ç”¨äºä»‹è´¨æ¢å¤ã€‚å®ƒå¯èƒ½å·²å­˜æ¡£ï¼Œä¹Ÿå¯èƒ½æœªå­˜æ¡£ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_1105.htm" rel="external nofollow noreferrer">v$dataguard_status</a></td><td>æ˜¾ç¤ºæœ€è¿‘å†™å…¥è­¦æŠ¥æ—¥å¿—æˆ–æœåŠ¡å™¨è¿›ç¨‹è·Ÿè¸ªæ–‡ä»¶çš„æ¶ˆæ¯ï¼Œè¿™äº›æ¶ˆæ¯ä¸ç‰©ç†å¤‡ç”¨æ•°æ®åº“æˆ–æ‰€æœ‰å¤‡ç”¨æ•°æ®åº“ç±»å‹çš„é‡åšä¼ è¾“æœåŠ¡æœ‰å…³ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2050.htm" rel="external nofollow noreferrer">V$MANAGED_STANDBY</a></td><td>æ˜¾ç¤ºä¸Data Guardç¯å¢ƒä¸­çš„ç‰©ç†å¤‡ç”¨æ•°æ®åº“æœ‰å…³çš„æŸäº›Oracle Databaseè¿›ç¨‹çš„å½“å‰çŠ¶æ€ä¿¡æ¯ã€‚å®ä¾‹å…³é—­åï¼Œè¯¥è§†å›¾ä¸ä¼šç»§ç»­å­˜åœ¨ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_1027.htm#REFRN30171" rel="external nofollow noreferrer">V$ASM_DISKGROUP</a></td><td>V$ASM_DISKGROUP ä¸ºèŠ‚ç‚¹ä¸Šçš„ASMå®ä¾‹å‘ç°çš„æ¯ä¸ªASMç£ç›˜ç»„æ˜¾ç¤ºä¸€è¡Œã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_2125.htm" rel="external nofollow noreferrer">v$recovery_file_dest</a></td><td>åœ¨å¿«é€Ÿæ¢å¤åŒºåŸŸä¸­æ˜¾ç¤ºæœ‰å…³ç£ç›˜é…é¢å’Œå½“å‰ç£ç›˜ä½¿ç”¨æƒ…å†µçš„ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_3194.htm#REFRN23076" rel="external nofollow noreferrer">DBA_FREE_SPACE</a></td><td>æè¿°æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨ç©ºé—´çš„ä½¿ç”¨æƒ…å†µã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_5061.htm" rel="external nofollow noreferrer">dba_temp_files</a></td><td>DBA_TEMP_FILES æè¿°æ•°æ®åº“ä¸­çš„æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶ï¼ˆä¸´æ—¶æ–‡ä»¶ï¼‰ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/statviews_5060.htm#REFRN23287" rel="external nofollow noreferrer">dba_tablespaces</a></td><td>DBA_TABLESPACES æè¿°æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ç©ºé—´ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_3041.htm" rel="external nofollow noreferrer">gv$sort_segment</a></td><td>V$SORT_SEGMENTæ˜¾ç¤ºæœ‰å…³ç»™å®šå®ä¾‹ä¸­æ¯ä¸ªæ’åºæ®µçš„ä¿¡æ¯ã€‚ä»…åœ¨è¡¨ç©ºé—´æ˜¯TEMPORARYç±»å‹æ—¶æ›´æ–°è§†å›¾ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_3114.htm" rel="external nofollow noreferrer">v$transaction</a></td><td>V$TRANSACTION åˆ—å‡ºç³»ç»Ÿä¸­çš„æ´»åŠ¨äº‹åŠ¡ã€‚</td></tr><tr><td><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40402/dynviews_1062.htm#REFRN30371" rel="external nofollow noreferrer">v$backup_set_details</a></td><td>å¤‡ä»½ä¿¡æ¯10g 11g 12c</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Oracleå¸¸ç”¨è§†å›¾&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;https://docs.oracle.com/cd/E11882_01/server.112
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Oracle" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Oracle/"/>
    
    
      <category term="oracle11g" scheme="http://www.toberoot.com/tags/oracle11g/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å°†æ•°æ®åº“æŠ€æœ¯çŸ­è§†é¢‘åŒ–ï¼Ÿ</title>
    <link href="http://www.toberoot.com/news/2020/05/24/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/05/24/tec-mysql/</id>
    <published>2020-05-23T17:47:33.000Z</published>
    <updated>2020-05-22T05:35:44.921Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="æŠ€æœ¯æ€è€ƒ" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/%E6%8A%80%E6%9C%AF%E6%80%9D%E8%80%83/"/>
    
    
      <category term="ç´§æ€¥æ•‘æ´" scheme="http://www.toberoot.com/tags/%E7%B4%A7%E6%80%A5%E6%95%91%E6%8F%B4/"/>
    
      <category term="mysqlbinlog" scheme="http://www.toberoot.com/tags/mysqlbinlog/"/>
    
  </entry>
  
  <entry>
    <title>mysqlbinlogè¿œç¨‹æ‹‰æ—¥å¿—</title>
    <link href="http://www.toberoot.com/news/2020/05/22/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/05/22/tec-mysql/</id>
    <published>2020-05-21T17:47:33.000Z</published>
    <updated>2020-05-21T09:48:15.819Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—"><a href="#è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—" class="headerlink" title="è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—"></a>è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">--rowæ ¼å¼çš„æ—¥å¿—</span><br><span class="line">mysqlbinlog -vv -P 3306 -uxxxx -pxxxx -hxxxx.mysql.rds.aliyuncs.com --read-from-remote-server --start-datetime='2020-05-20 09:00:00' --stop-datetime='2020-05-20 11:00:00' --base64-output=DECODE-ROWS mysql-bin.000xxx &gt; xxxlog.sql</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—&quot;&gt;&lt;a href=&quot;#è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—&quot; class=&quot;headerlink&quot; title=&quot;è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—&quot;&gt;&lt;/a&gt;è·å–è¿œç¨‹MySQLæœåŠ¡å™¨çš„binlogæ—¥å¿—&lt;/
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="ç´§æ€¥æ•‘æ´" scheme="http://www.toberoot.com/tags/%E7%B4%A7%E6%80%A5%E6%95%91%E6%8F%B4/"/>
    
      <category term="mysqlbinlog" scheme="http://www.toberoot.com/tags/mysqlbinlog/"/>
    
  </entry>
  
  <entry>
    <title>rsync + inotify å®ç°å®æ—¶åŒæ­¥</title>
    <link href="http://www.toberoot.com/news/2020/05/20/tec-linux/"/>
    <id>http://www.toberoot.com/news/2020/05/20/tec-linux/</id>
    <published>2020-05-20T11:03:00.000Z</published>
    <updated>2020-05-19T03:11:00.187Z</updated>
    
    <content type="html"><![CDATA[<!-- MDTOC maxdepth:6 firsth1:1 numbering:0 flatten:0 bullets:1 updateOnSave:1 --><ul><li><a href="#rsyncä»‹ç»">rsyncä»‹ç»</a>   <ul><li><a href="#rsyncå…­ç§å‘½ä»¤æ ¼å¼">RSYNCå…­ç§å‘½ä»¤æ ¼å¼</a>   </li><li><a href="#rsyncå®‰è£…">RSYNCå®‰è£…</a>   </li><li><a href="#rsyncæ¡ˆä¾‹">RSYNCæ¡ˆä¾‹</a>   </li><li><a href="#rsyncå‚æ•°">RSYNCå‚æ•°</a>   </li></ul></li><li><a href="#åº”ç”¨åœºæ™¯-linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥">åº”ç”¨åœºæ™¯-Linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥</a>   <ul><li><a href="#serverç«¯é…ç½®">Serverç«¯é…ç½®</a>   <ul><li><a href="#ç¯å¢ƒä»‹ç»">ç¯å¢ƒä»‹ç»</a>   </li><li><a href="#å®‰è£…æ–¹å¼">å®‰è£…æ–¹å¼</a>   </li><li><a href="#é…ç½®">é…ç½®</a>   </li><li><a href="#ç¼–å†™ä¸»é…ç½®æ–‡ä»¶-rsyncdconf">ç¼–å†™ä¸»é…ç½®æ–‡ä»¶ rsyncd.conf</a>   </li><li><a href="#ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶">ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶</a>   </li><li><a href="#å¯åŠ¨æœåŠ¡">å¯åŠ¨æœåŠ¡</a>   </li></ul></li><li><a href="#rsyncå®¢æˆ·ç«¯">rsyncå®¢æˆ·ç«¯</a>   <ul><li><a href="#å®‰è£…æ–¹å¼">å®‰è£…æ–¹å¼</a>   </li><li><a href="#éªŒè¯">éªŒè¯</a>   </li></ul></li><li><a href="#ä½¿ç”¨">ä½¿ç”¨</a>   <ul><li><a href="#æ£€æµ‹åˆ›å»ºäº‹ä»¶">æ£€æµ‹åˆ›å»ºäº‹ä»¶</a>   </li><li><a href="#æ£€æµ‹åˆ é™¤äº‹ä»¶">æ£€æµ‹åˆ é™¤äº‹ä»¶</a>   </li><li><a href="#ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬">ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬</a>   </li></ul></li><li><a href="#éªŒè¯">éªŒè¯</a>   </li></ul></li></ul><!-- /MDTOC --><h2 id="rsyncä»‹ç»"><a href="#rsyncä»‹ç»" class="headerlink" title="rsyncä»‹ç»"></a>rsyncä»‹ç»</h2><p>rsyncï¼Œremote synchronizeé¡¾åæ€æ„å°±çŸ¥é“å®ƒæ˜¯ä¸€æ¬¾å®ç°è¿œç¨‹åŒæ­¥åŠŸèƒ½çš„è½¯ä»¶ï¼Œå®ƒåœ¨åŒæ­¥æ–‡ä»¶çš„åŒæ—¶ï¼Œå¯ä»¥ä¿æŒåŸæ¥æ–‡ä»¶çš„æƒé™ã€æ—¶é—´ã€è½¯ç¡¬é“¾æ¥ç­‰é™„åŠ ä¿¡æ¯ã€‚ rsyncæ˜¯ç”¨ â€œrsync ç®—æ³•â€æä¾›äº†ä¸€ä¸ªå®¢æˆ·æœºå’Œè¿œç¨‹æ–‡ä»¶æœåŠ¡å™¨çš„æ–‡ä»¶åŒæ­¥çš„å¿«é€Ÿæ–¹æ³•ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡sshæ–¹å¼æ¥ä¼ è¾“æ–‡ä»¶ï¼Œè¿™æ ·å…¶ä¿å¯†æ€§ä¹Ÿéå¸¸å¥½ï¼Œå¦å¤–å®ƒè¿˜æ˜¯å…è´¹çš„è½¯ä»¶ã€‚</p><h3 id="RSYNCå…­ç§å‘½ä»¤æ ¼å¼"><a href="#RSYNCå…­ç§å‘½ä»¤æ ¼å¼" class="headerlink" title="RSYNCå…­ç§å‘½ä»¤æ ¼å¼"></a>RSYNCå…­ç§å‘½ä»¤æ ¼å¼</h3><p>Rsyncçš„å‘½ä»¤æ ¼å¼å¯ä»¥ä¸ºä»¥ä¸‹å…­ç§ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rsync [OPTION]... SRC DEST</span><br><span class="line">ã€€ã€€rsync [OPTION]... SRC [USER@]HOST:DEST</span><br><span class="line">ã€€ã€€rsync [OPTION]... [USER@]HOST:SRC DEST</span><br><span class="line">ã€€ã€€rsync [OPTION]... [USER@]HOST::SRC DEST</span><br><span class="line">ã€€ã€€rsync [OPTION]... SRC [USER@]HOST::DEST</span><br><span class="line">ã€€ã€€rsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]</span><br></pre></td></tr></table></figure><p>å¯¹åº”äºä»¥ä¸Šå…­ç§å‘½ä»¤æ ¼å¼ï¼Œrsyncæœ‰å…­ç§ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼š</p><ul><li>æ‹·è´æœ¬åœ°æ–‡ä»¶ã€‚å½“SRCå’ŒDESè·¯å¾„ä¿¡æ¯éƒ½ä¸åŒ…å«æœ‰å•ä¸ªå†’å·â€:â€åˆ†éš”ç¬¦æ—¶å°±å¯åŠ¨è¿™ç§å·¥ä½œæ¨¡å¼ã€‚å¦‚ï¼šrsync -a /data /backup</li><li>ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹shellç¨‹åº(å¦‚rshã€ssh)æ¥å®ç°å°†æœ¬åœ°æœºå™¨çš„å†…å®¹æ‹·è´åˆ°è¿œç¨‹æœºå™¨ã€‚å½“DSTè·¯å¾„åœ°å€åŒ…å«å•ä¸ªå†’å·â€:â€åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚å¦‚ï¼šrsync -avz *.c foo:src</li><li>ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹shellç¨‹åº(å¦‚rshã€ssh)æ¥å®ç°å°†è¿œç¨‹æœºå™¨çš„å†…å®¹æ‹·è´åˆ°æœ¬åœ°æœºå™¨ã€‚å½“SRCåœ°å€è·¯å¾„åŒ…å«å•ä¸ªå†’å·â€:â€åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚å¦‚ï¼šrsync -avz foo:src/bar /data</li><li>ä»è¿œç¨‹rsyncæœåŠ¡å™¨ä¸­æ‹·è´æ–‡ä»¶åˆ°æœ¬åœ°æœºã€‚å½“SRCè·¯å¾„ä¿¡æ¯åŒ…å«â€::â€åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚å¦‚ï¼šrsync -av <a href="mailto:root@172.16.78.192" rel="external nofollow noreferrer">root@172.16.78.192</a>::www /databack</li><li>ä»æœ¬åœ°æœºå™¨æ‹·è´æ–‡ä»¶åˆ°è¿œç¨‹rsyncæœåŠ¡å™¨ä¸­ã€‚å½“DSTè·¯å¾„ä¿¡æ¯åŒ…å«â€::â€åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚å¦‚ï¼šrsync -av /databack <a href="mailto:root@172.16.78.192" rel="external nofollow noreferrer">root@172.16.78.192</a>::www</li><li>åˆ—è¿œç¨‹æœºçš„æ–‡ä»¶åˆ—è¡¨ã€‚è¿™ç±»ä¼¼äºrsyncä¼ è¾“ï¼Œä¸è¿‡åªè¦åœ¨å‘½ä»¤ä¸­çœç•¥æ‰æœ¬åœ°æœºä¿¡æ¯å³å¯ã€‚å¦‚ï¼šrsync -v rsync://172.16.78.192/www</li></ul><h3 id="RSYNCå®‰è£…"><a href="#RSYNCå®‰è£…" class="headerlink" title="RSYNCå®‰è£…"></a>RSYNCå®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ³¨ï¼šåœ¨debianã€ubuntu ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">sudo apt-get install rsync</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³¨ï¼šFedoraã€Redhat ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">yum install rsync</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³¨ï¼šFedoraã€Redhat ç­‰rpmåŒ…å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">rpm -ivh rsync</span><br></pre></td></tr></table></figure><h3 id="RSYNCæ¡ˆä¾‹"><a href="#RSYNCæ¡ˆä¾‹" class="headerlink" title="RSYNCæ¡ˆä¾‹"></a>RSYNCæ¡ˆä¾‹</h3><p>åœ¨æˆ‘ä»¬å†…éƒ¨è·³æ¿æœº1ï¼šæ­å·èŠ‚ç‚¹ï¼ˆä¸»ï¼‰ä¸­ï¼Œå¯¹åº”åœ¨â€œ/etc/ssh/ssh_config.dâ€ä¸­é…ç½®äº†æ¯ä¸ªé¡¹ç›®çš„sshå¿«æ·ç™»é™†ï¼Œæ‰€ä»¥åç»­æˆ‘ä»¬åªéœ€è¦â€œssh &lt;ä¸»æœºå&gt;â€ä¾¿èƒ½ç™»é™†åˆ°å¯¹åº”çš„ç›®æ ‡æœåŠ¡å™¨ä¸­ã€‚<br>ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æ­å·èŠ‚ç‚¹ï¼ˆä¸»ï¼‰ä¸­ï¼Œå¯¹åº”å˜æ›´äº†â€œ/etc/ssh/ssh_config.dâ€çš„é…ç½®ï¼Œé‚£å…¶ä»–è·³æ¿æœºæ€ä¹ˆæ ·åŒæ­¥æ›´æ–°å‘¢ï¼Ÿå…¶å®è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†rsyncçš„æ–¹å¼æ¥åŒæ­¥é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rsync serveré…ç½®</span></span><br><span class="line"><span class="comment"># 1.åœ¨å†…éƒ¨è·³æ¿æœº1ï¼šæ­å·èŠ‚ç‚¹ï¼ˆä¸»ï¼šsrv-zy-ssh1ï¼‰ä¸Šï¼Œç¼–è¾‘é…ç½®æ–‡ä»¶/etc/rsyncd.conf</span></span><br><span class="line">uid=root</span><br><span class="line">git=root</span><br><span class="line">use chroot=no</span><br><span class="line">max connection=0</span><br><span class="line">port=873</span><br><span class="line">pid file=/var/<span class="built_in">log</span>/rsync/rsyncd.pid</span><br><span class="line">lock file=/var/<span class="built_in">log</span>/rsync/rsync.lock</span><br><span class="line"><span class="built_in">log</span> file=/var/<span class="built_in">log</span>/rsync/rsyncd.log</span><br><span class="line">motd file=/var/<span class="built_in">log</span>/rsync/rsyncd.motd</span><br><span class="line">strict modes=yes</span><br><span class="line">[sshconfig]</span><br><span class="line">uid=root</span><br><span class="line">git=root</span><br><span class="line">path=/etc/ssh/ssh_config.d/</span><br><span class="line">comment=rsync ssh_config</span><br><span class="line"><span class="built_in">read</span> only=<span class="literal">false</span></span><br><span class="line">list=<span class="literal">false</span></span><br><span class="line">host allow=ip1 ip2 ip3</span><br><span class="line"><span class="comment">#hosts deny=172.25.0.0/24</span></span><br><span class="line">auth users=sshconfig</span><br><span class="line">secrets file=/etc/rsyncd.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.ç¼–è¾‘/etc/rsyncd.passwd æ–‡ä»¶åŠ å…¥ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">sshconfig:rsync20150128</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.èµ‹æƒï¼ˆå¿…é¡»600æƒé™ï¼Œå¦åˆ™æŠ¥é”™ï¼‰</span></span><br><span class="line">chmod 600 /etc/rsyncd.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.å¯åŠ¨rsync</span></span><br><span class="line">rsync --daemon /etc/rsyncd.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># rsync cilenté…ç½®</span></span><br><span class="line">åˆ†åˆ«åœ¨å…¶ä»–è·³æ¿æœºä¸Šé¢ï¼š</span><br><span class="line">å†…éƒ¨è·³æ¿æœº2ï¼šé’å²›èŠ‚ç‚¹ï¼ˆå¤‡ï¼šsrv-zy-ssh2ï¼‰</span><br><span class="line">å®¢æˆ·è·³æ¿æœº1ï¼šæ­å·èŠ‚ç‚¹ï¼ˆä¸»ï¼šsrv-zy-ssh3ï¼‰</span><br><span class="line">å®¢æˆ·è·³æ¿æœº2ï¼šé’å²›èŠ‚ç‚¹ï¼ˆå¤‡ï¼šsrv-zy-ssh4ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘/etc/rsyncd.passwd æ–‡ä»¶åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line">sshconfig:rsync20150128</span><br><span class="line"></span><br><span class="line"><span class="comment"># èµ‹æƒï¼ˆå¿…é¡»600æƒé™ï¼Œå¦åˆ™æŠ¥é”™ï¼‰:</span></span><br><span class="line">chmod 600 /etc/rsyncd.passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡ŒåŒæ­¥å‘½ä»¤ï¼š</span></span><br><span class="line">rsync -vzrtopg --delete --progress sshconfig@115.29.244.224::sshconfig /etc/ssh/ssh_config.d/ --password-file=/etc/rsyncd.passwd</span><br><span class="line">æˆ–è€…ï¼š</span><br><span class="line">rsync -avz --delete --progress sshconfig@115.29.244.224::sshconfig /etc/ssh/ssh_config.d/ --password-file=/etc/rsyncd.passwd</span><br></pre></td></tr></table></figure><h3 id="RSYNCå‚æ•°"><a href="#RSYNCå‚æ•°" class="headerlink" title="RSYNCå‚æ•°"></a>RSYNCå‚æ•°</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rsyncå‚æ•°çš„å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</span><br><span class="line">-v, --verbose è¯¦ç»†æ¨¡å¼è¾“å‡º</span><br><span class="line">-q, --quiet ç²¾ç®€è¾“å‡ºæ¨¡å¼</span><br><span class="line">-c, --checksum æ‰“å¼€æ ¡éªŒå¼€å…³ï¼Œå¼ºåˆ¶å¯¹æ–‡ä»¶ä¼ è¾“è¿›è¡Œæ ¡éªŒ</span><br><span class="line">-a, --archive å½’æ¡£æ¨¡å¼ï¼Œè¡¨ç¤ºä»¥é€’å½’æ–¹å¼ä¼ è¾“æ–‡ä»¶ï¼Œå¹¶ä¿æŒæ‰€æœ‰æ–‡ä»¶å±æ€§ï¼Œç­‰äº-rlptgoD</span><br><span class="line">-r, --recursive å¯¹å­ç›®å½•ä»¥é€’å½’æ¨¡å¼å¤„ç†</span><br><span class="line">-R, --relative ä½¿ç”¨ç›¸å¯¹è·¯å¾„ä¿¡æ¯</span><br><span class="line">-b, --backup åˆ›å»ºå¤‡ä»½ï¼Œä¹Ÿå°±æ˜¯å¯¹äºç›®çš„å·²ç»å­˜åœ¨æœ‰åŒæ ·çš„æ–‡ä»¶åæ—¶ï¼Œå°†è€çš„æ–‡ä»¶é‡æ–°å‘½åä¸º~filenameã€‚å¯ä»¥ä½¿ç”¨--suffixé€‰é¡¹æ¥æŒ‡å®šä¸åŒçš„å¤‡ä»½æ–‡ä»¶å‰ç¼€ã€‚</span><br><span class="line">--backup-dir å°†å¤‡ä»½æ–‡ä»¶(å¦‚~filename)å­˜æ”¾åœ¨åœ¨ç›®å½•ä¸‹ã€‚</span><br><span class="line">-suffix=SUFFIX å®šä¹‰å¤‡ä»½æ–‡ä»¶å‰ç¼€</span><br><span class="line">-u, --update ä»…ä»…è¿›è¡Œæ›´æ–°ï¼Œä¹Ÿå°±æ˜¯è·³è¿‡æ‰€æœ‰å·²ç»å­˜åœ¨äºDSTï¼Œå¹¶ä¸”æ–‡ä»¶æ—¶é—´æ™šäºè¦å¤‡ä»½çš„æ–‡ä»¶ã€‚(ä¸è¦†ç›–æ›´æ–°çš„æ–‡ä»¶)</span><br><span class="line">-l, --links ä¿ç•™è½¯é“¾ç»“</span><br><span class="line">-L, --copy-links æƒ³å¯¹å¾…å¸¸è§„æ–‡ä»¶ä¸€æ ·å¤„ç†è½¯é“¾ç»“</span><br><span class="line">--copy-unsafe-links ä»…ä»…æ‹·è´æŒ‡å‘SRCè·¯å¾„ç›®å½•æ ‘ä»¥å¤–çš„é“¾ç»“</span><br><span class="line">--safe-links å¿½ç•¥æŒ‡å‘SRCè·¯å¾„ç›®å½•æ ‘ä»¥å¤–çš„é“¾ç»“</span><br><span class="line">-H, --hard-links ä¿ç•™ç¡¬é“¾ç»“ -p, --perms ä¿æŒæ–‡ä»¶æƒé™</span><br><span class="line">-o, --owner ä¿æŒæ–‡ä»¶å±ä¸»ä¿¡æ¯ -g, --group ä¿æŒæ–‡ä»¶å±ç»„ä¿¡æ¯</span><br><span class="line">-D, --devices ä¿æŒè®¾å¤‡æ–‡ä»¶ä¿¡æ¯ -t, --<span class="built_in">times</span> ä¿æŒæ–‡ä»¶æ—¶é—´ä¿¡æ¯</span><br><span class="line">-S, --sparse å¯¹ç¨€ç–æ–‡ä»¶è¿›è¡Œç‰¹æ®Šå¤„ç†ä»¥èŠ‚çœDSTçš„ç©ºé—´</span><br><span class="line">-n, --dry-runç°å®å“ªäº›æ–‡ä»¶å°†è¢«ä¼ è¾“</span><br><span class="line">-W, --whole-file æ‹·è´æ–‡ä»¶ï¼Œä¸è¿›è¡Œå¢é‡æ£€æµ‹</span><br><span class="line">-x, --one-file-system ä¸è¦è·¨è¶Šæ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œ</span><br><span class="line">-B, --block-size=SIZE æ£€éªŒç®—æ³•ä½¿ç”¨çš„å—å°ºå¯¸ï¼Œé»˜è®¤æ˜¯700å­—èŠ‚</span><br><span class="line">-e, --rsh=COMMAND æŒ‡å®šä½¿ç”¨rshã€sshæ–¹å¼è¿›è¡Œæ•°æ®åŒæ­¥</span><br><span class="line">--rsync-path=PATH æŒ‡å®šè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„rsyncå‘½ä»¤æ‰€åœ¨è·¯å¾„ä¿¡æ¯</span><br><span class="line">-C, --cvs-exclude ä½¿ç”¨å’ŒCVSä¸€æ ·çš„æ–¹æ³•è‡ªåŠ¨å¿½ç•¥æ–‡ä»¶ï¼Œç”¨æ¥æ’é™¤é‚£äº›ä¸å¸Œæœ›ä¼ è¾“çš„æ–‡ä»¶</span><br><span class="line">--existing ä»…ä»…æ›´æ–°é‚£äº›å·²ç»å­˜åœ¨äºDSTçš„æ–‡ä»¶ï¼Œè€Œä¸å¤‡ä»½é‚£äº›æ–°åˆ›å»ºçš„æ–‡ä»¶</span><br><span class="line">--delete åˆ é™¤é‚£äº›DSTä¸­SRCæ²¡æœ‰çš„æ–‡ä»¶</span><br><span class="line">--delete-excluded åŒæ ·åˆ é™¤æ¥æ”¶ç«¯é‚£äº›è¢«è¯¥é€‰é¡¹æŒ‡å®šæ’é™¤çš„æ–‡ä»¶</span><br><span class="line">--delete-after ä¼ è¾“ç»“æŸä»¥åå†åˆ é™¤</span><br><span class="line">--ignore-errors åŠæ—¶å‡ºç°IOé”™è¯¯ä¹Ÿè¿›è¡Œåˆ é™¤</span><br><span class="line">--max-delete=NUM æœ€å¤šåˆ é™¤NUMä¸ªæ–‡ä»¶</span><br><span class="line">--partial ä¿ç•™é‚£äº›å› æ•…æ²¡æœ‰å®Œå…¨ä¼ è¾“çš„æ–‡ä»¶ï¼Œä»¥æ˜¯åŠ å¿«éšåçš„å†æ¬¡ä¼ è¾“</span><br><span class="line">--force å¼ºåˆ¶åˆ é™¤ç›®å½•ï¼Œå³ä½¿ä¸ä¸ºç©º</span><br><span class="line">--numeric-ids ä¸å°†æ•°å­—çš„ç”¨æˆ·å’Œç»„IDåŒ¹é…ä¸ºç”¨æˆ·åå’Œç»„å</span><br><span class="line">--timeout=TIME IPè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’</span><br><span class="line">-I, --ignore-times ä¸è·³è¿‡é‚£äº›æœ‰åŒæ ·çš„æ—¶é—´å’Œé•¿åº¦çš„æ–‡ä»¶</span><br><span class="line">--size-only å½“å†³å®šæ˜¯å¦è¦å¤‡ä»½æ–‡ä»¶æ—¶ï¼Œä»…ä»…å¯Ÿçœ‹æ–‡ä»¶å¤§å°è€Œä¸è€ƒè™‘æ–‡ä»¶æ—¶é—´</span><br><span class="line">--modify-window=NUM å†³å®šæ–‡ä»¶æ˜¯å¦æ—¶é—´ç›¸åŒæ—¶ä½¿ç”¨çš„æ—¶é—´æˆ³çª—å£ï¼Œé»˜è®¤ä¸º0</span><br><span class="line">-T --temp-dir=DIR åœ¨DIRä¸­åˆ›å»ºä¸´æ—¶æ–‡ä»¶</span><br><span class="line">--compare-dest=DIR åŒæ ·æ¯”è¾ƒDIRä¸­çš„æ–‡ä»¶æ¥å†³å®šæ˜¯å¦éœ€è¦å¤‡ä»½</span><br><span class="line">-P ç­‰åŒäº --partial</span><br><span class="line">--progress æ˜¾ç¤ºå¤‡ä»½è¿‡ç¨‹</span><br><span class="line">-z, --compress å¯¹å¤‡ä»½çš„æ–‡ä»¶åœ¨ä¼ è¾“æ—¶è¿›è¡Œå‹ç¼©å¤„ç†</span><br><span class="line">--exclude=PATTERN æŒ‡å®šæ’é™¤ä¸éœ€è¦ä¼ è¾“çš„æ–‡ä»¶æ¨¡å¼</span><br><span class="line">--include=PATTERN æŒ‡å®šä¸æ’é™¤è€Œéœ€è¦ä¼ è¾“çš„æ–‡ä»¶æ¨¡å¼</span><br><span class="line">--exclude-from=FILE æ’é™¤FILEä¸­æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶</span><br><span class="line">--include-from=FILE ä¸æ’é™¤FILEæŒ‡å®šæ¨¡å¼åŒ¹é…çš„æ–‡ä»¶</span><br><span class="line">--version æ‰“å°ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">--address ç»‘å®šåˆ°ç‰¹å®šçš„åœ°å€</span><br><span class="line">--config=FILE æŒ‡å®šå…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œä¸ä½¿ç”¨é»˜è®¤çš„rsyncd.confæ–‡ä»¶</span><br><span class="line">--port=PORT æŒ‡å®šå…¶ä»–çš„rsyncæœåŠ¡ç«¯å£</span><br><span class="line">--blocking-io å¯¹è¿œç¨‹shellä½¿ç”¨é˜»å¡IO</span><br><span class="line">-stats ç»™å‡ºæŸäº›æ–‡ä»¶çš„ä¼ è¾“çŠ¶æ€</span><br><span class="line">--progress åœ¨ä¼ è¾“æ—¶ç°å®ä¼ è¾“è¿‡ç¨‹</span><br><span class="line">--<span class="built_in">log</span>-format=formAT æŒ‡å®šæ—¥å¿—æ–‡ä»¶æ ¼å¼</span><br><span class="line">--password-file=FILE ä»FILEä¸­å¾—åˆ°å¯†ç </span><br><span class="line">--bwlimit=KBPS é™åˆ¶I/Oå¸¦å®½ï¼ŒKBytes per second</span><br><span class="line">-h, --<span class="built_in">help</span> æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨åœºæ™¯-Linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥"><a href="#åº”ç”¨åœºæ™¯-Linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥" class="headerlink" title="åº”ç”¨åœºæ™¯-Linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥"></a>åº”ç”¨åœºæ™¯-Linuxç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥</h2><p>åœ¨æˆ‘ä»¬çš„æ—¥å¸¸åœºæ™¯ä¸­ç»å¸¸ä¼šç»å¸¸ç¢°åˆ°æ–‡ä»¶å…±äº«åŒæ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p><ul><li>é›†ç¾¤ï¼Œæä¾›é«˜å¯ç”¨æœåŠ¡ï¼ˆéœ€è¦ç½‘ç«™ä»£ç æˆ–è€…ç›®å½•å®æ—¶åŒæ­¥ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼‰</li><li>è¿ç§»æ•°æ® (å®æ—¶å¢é‡ä¼ è¾“)</li><li>æ–‡ä»¶å¤‡ä»½ï¼ˆå®æ—¶å°†æ•°æ®å¤‡ä»½åˆ°å…¶ä»–è®¾å¤‡ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼‰</li></ul><p>æˆ‘ä»¬é’ˆå¯¹ä»¥ä¸Šåœºæ™¯åœ¨ Linux ç³»ç»Ÿä¸‹å®ç°æ–‡ä»¶å®æ—¶åŒæ­¥</p><h3 id="Serverç«¯é…ç½®"><a href="#Serverç«¯é…ç½®" class="headerlink" title="Serverç«¯é…ç½®"></a>Serverç«¯é…ç½®</h3><h4 id="ç¯å¢ƒä»‹ç»"><a href="#ç¯å¢ƒä»‹ç»" class="headerlink" title="ç¯å¢ƒä»‹ç»"></a>ç¯å¢ƒä»‹ç»</h4><p>ä¿®æ”¹ï¼šè°ƒæ•´äº†ç›®å½•é¡ºåº</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ“ä½œç³»ç»Ÿï¼šCentOS 6.8 rsync: rsync-3.0.6 (yum æºé»˜è®¤å®‰è£…)</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/01.png" alt=""></p><h4 id="å®‰è£…æ–¹å¼"><a href="#å®‰è£…æ–¹å¼" class="headerlink" title="å®‰è£…æ–¹å¼"></a>å®‰è£…æ–¹å¼</h4><p>å®‰è£…æ–¹å¼</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudoapt-get &#96;&#96;installrsync#debianã€ubuntu ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›&#96;&#96;yum &#96;&#96;installrsync#Fedoraã€Redhat ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›&#96;&#96;rpm -ivh &#96;&#96;rsync# Fedoraã€Redhat ç­‰rpmåŒ…å®‰è£…æ–¹æ³•ï¼›&#96;&#96;rpm -qa | &#96;&#96;greprsync# æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><p>ä¿®æ”¹ï¼š æ–‡ä»¶åç¼ºå°‘â€œdâ€ å­—ç¬¦</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod 600 &#x2F;etc&#x2F;rsync.d&#x2F;rsyncd.conf</span><br><span class="line">chmod 600 &#x2F;etc&#x2F;rsync.d&#x2F;rsyncd.pass</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç›¸å…³é…ç½®ç›®å½•å’Œæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir-p &#96;&#96;&#x2F;etc&#x2F;rsync&#96;&#96;.d  &#96;&#96;# rsync é…ç½®æ–‡ä»¶ç›®å½•ï¼Œé»˜è®¤æ²¡æœ‰touch&#x2F;etc&#x2F;rsync&#96;&#96;.d&#96;&#96;&#x2F;rsyncd&#96;&#96;.conf &#96;&#96;# rsyncæœåŠ¡ç«¯é…ç½®æ–‡ä»¶touch&#x2F;etc&#x2F;rsync&#96;&#96;.d&#96;&#96;&#x2F;rsyncd&#96;&#96;.pass &#96;&#96;# å®¢æˆ·ç«¯æ‹‰å–æ–‡ä»¶æ—¶ä½¿ç”¨çš„ç”¨æˆ·å¯†ç chmod600 &#96;&#96;&#x2F;etc&#x2F;rsync&#96;&#96;.d&#96;&#96;&#x2F;rsyncd&#96;&#96;.confchmod600 &#96;&#96;&#x2F;etc&#x2F;rsync&#96;&#96;.d&#96;&#96;&#x2F;rsyncd&#96;&#96;.pass</span><br></pre></td></tr></table></figure><h4 id="ç¼–å†™ä¸»é…ç½®æ–‡ä»¶-rsyncd-conf"><a href="#ç¼–å†™ä¸»é…ç½®æ–‡ä»¶-rsyncd-conf" class="headerlink" title="ç¼–å†™ä¸»é…ç½®æ–‡ä»¶ rsyncd.conf"></a>ç¼–å†™ä¸»é…ç½®æ–‡ä»¶ rsyncd.conf</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ``/etc/rsync``.d``/rsyncd``.conf</span><br></pre></td></tr></table></figure><p>ï¼ˆä»¥ä¸‹æ˜¯é…ç½®æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">log</span> file=/var/<span class="built_in">log</span>/rsyncd.log</span><br><span class="line"></span><br><span class="line">pid file=/var/run/rsyncd.pid</span><br><span class="line"></span><br><span class="line">lock file=/var/run/rsyncd.lock</span><br><span class="line"></span><br><span class="line">motd file = /etc/rsyncd/rsyncd.motd</span><br><span class="line"></span><br><span class="line">uid=root</span><br><span class="line"></span><br><span class="line">gid=root</span><br><span class="line"></span><br><span class="line">max connections=5</span><br><span class="line"></span><br><span class="line">hosts allow=192.168.1.167 <span class="comment"># å…è®¸è®¿é—®çš„IPåœ°å€ï¼Œæˆ‘è¿™é‡Œå¡«å†™çš„æ˜¯æµ‹è¯•çš„å®¢æˆ·ç«¯åœ°å€</span></span><br><span class="line"></span><br><span class="line">hosts deny=*</span><br><span class="line"></span><br><span class="line">secrets file = /etc/rsync.d/rsyncd.pass</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span> = /var/<span class="built_in">log</span>/rsyncd.log l</span><br><span class="line"></span><br><span class="line">og format = %t %a %m %f %b</span><br><span class="line"></span><br><span class="line">syslog facility = local3 timeout = 300</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[handbook]</span><br><span class="line"></span><br><span class="line">path=/handbook/</span><br><span class="line"></span><br><span class="line">comment= handbook</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> auth users=rsync</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/02.png" alt=""></p><p>è¯¦ç»†å‚æ•°å¯å‚è€ƒå®˜ç½‘ <a href="https://download.samba.org/pub/rsync/rsyncd.conf.html" rel="external nofollow noreferrer">rsyncd.conf ä»‹ç» </a></p><h4 id="ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶"><a href="#ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶" class="headerlink" title="ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶"></a>ç¼–å†™ç”¨æˆ·è®¤è¯æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/rsync.d/rsyncd.pass</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ï¼šå°†ä»£ç æ¨¡å¼å»é™¤ï¼Œå¹¶æ·»åŠ æ–‡å­—æè¿°</p><p>è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rsync:cloudcare</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/03.png" alt=""></p><h4 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rsync --daemon --config=/etc/rsync.d/rsyncd.conf</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ï¼š æ·»åŠ äº†â€œç¡®è®¤æœåŠ¡å¯åŠ¨â€ æ ‡é¢˜ï¼Œä»¥åŠç›¸å…³å‘½ä»¤; å°† â€œæ³¨ï¼šrsync æœåŠ¡é»˜è®¤ç«¯å£æ˜¯ 873â€ å‰ç§»  ç¡®è®¤æœåŠ¡å¯åŠ¨</p><p>æ³¨ï¼šrsync æœåŠ¡é»˜è®¤ç«¯å£æ˜¯ 873</p><p>ç¡®è®¤æœåŠ¡å¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps -ef | greprsyncnetstat-nltp | grep7589</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/04.png" alt=""></p><h3 id="rsyncå®¢æˆ·ç«¯"><a href="#rsyncå®¢æˆ·ç«¯" class="headerlink" title="rsyncå®¢æˆ·ç«¯"></a>rsyncå®¢æˆ·ç«¯</h3><p>å®¢æˆ·ç«¯é…ç½®å¾ˆç®€å•ï¼Œåªéœ€è¦å®‰è£… <code>rsync</code> å·¥å…·å³å¯</p><h4 id="å®‰è£…æ–¹å¼-1"><a href="#å®‰è£…æ–¹å¼-1" class="headerlink" title="å®‰è£…æ–¹å¼"></a>å®‰è£…æ–¹å¼</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># debianã€ubuntu ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">sudo apt-get install rsync</span><br><span class="line"><span class="comment"># Fedoraã€Redhat ç­‰åœ¨çº¿å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">yum install rsync</span><br><span class="line"><span class="comment"># Fedoraã€Redhat ç­‰rpmåŒ…å®‰è£…æ–¹æ³•ï¼›</span></span><br><span class="line">rpm -ivh rsync</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬</span></span><br><span class="line">rpm -qa | greprsync</span><br></pre></td></tr></table></figure><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>ä¿®æ”¹ï¼šæ·»åŠ äº†â€œç¤ºä¾‹å†…å®¹â€</p><p>ç¤ºä¾‹ï¼š å°†192.168.1.176 æœåŠ¡å™¨ä¸Šçš„ handbook ï¼ˆè¿™é‡Œæ˜¯å®šä¹‰çš„é¡¹ç›®åç§°ï¼Œå¯ä»¥å‚è€ƒrsync server ç«¯çš„é…ç½®ï¼‰é¡¹ç›®åŒæ­¥åˆ° 192.168.1.167 çš„ /tmp ä¸‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rsync -avzP ``rsync``@192.168.1.176::handbook ``/tmp</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š<br>-a å‚æ•°ï¼Œç›¸å½“äº-rlptgoDï¼Œ<br>-r æ˜¯é€’å½’ -l æ˜¯é“¾æ¥æ–‡ä»¶ï¼Œæ„æ€æ˜¯æ‹·è´é“¾æ¥æ–‡ä»¶ï¼›<br>-p è¡¨ç¤ºä¿æŒæ–‡ä»¶åŸæœ‰æƒé™ï¼›<br>-t ä¿æŒæ–‡ä»¶åŸæœ‰æ—¶é—´ï¼›<br>-g ä¿æŒæ–‡ä»¶åŸæœ‰ç”¨æˆ·ç»„ï¼›<br>-o ä¿æŒæ–‡ä»¶åŸæœ‰å±ä¸»ï¼›<br>-D ç›¸å½“äºå—è®¾å¤‡æ–‡ä»¶ï¼›<br>-z ä¼ è¾“æ—¶å‹ç¼©ï¼›<br>-P ä¼ è¾“è¿›åº¦ï¼›<br>-v ä¼ è¾“æ—¶çš„è¿›åº¦ç­‰ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![](2020-05-20-tec-linux&#x2F;05.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¯¦ç»†å‚æ•°å¯ä»¥å‚è€ƒ: [RSYNC å‚æ•° ](https:&#x2F;&#x2F;confluence.jiagouyun.com&#x2F;pages&#x2F;viewpage.action?pageId&#x3D;15503070)</span><br><span class="line"></span><br><span class="line">å¦‚æœæƒ³æ¯éš”ä¸€æ®µæ—¶é—´åŒæ­¥ä¸€æ¬¡ï¼Œå¯ä»¥é…åˆ crontab æ¥å®ç°ï¼›ä½†æ˜¯å¦‚æœæƒ³å®æ—¶åŒæ­¥ï¼Œé‚£å°±éœ€è¦ç”¨åˆ°inotify å·¥å…·äº†</span><br><span class="line"></span><br><span class="line">## inotify</span><br><span class="line"></span><br><span class="line">&gt; inotifyæ˜¯Linuxæ ¸å¿ƒå­ç³»ç»Ÿä¹‹ä¸€ï¼Œåšä¸ºæ–‡ä»¶ç³»ç»Ÿçš„é™„åŠ åŠŸèƒ½ï¼Œå®ƒå¯ç›‘æ§æ–‡ä»¶ç³»ç»Ÿå¹¶å°†å¼‚åŠ¨é€šçŸ¥åº”ç”¨ç¨‹åºã€‚æ‘˜è‡ª[ç»´åŸºç™¾ç§‘](https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;wiki&#x2F;Inotify) å¯ä»¥é…åˆrsyncåšå®æ—¶åŒæ­¥ï¼Œinotify é€šè¿‡ç›‘æ§æ–‡ä»¶çš„å˜åŒ–ï¼Œç„¶åè§¦å‘åŒæ­¥è„šæœ¬ï¼Œå®ç°å®æ—¶åŒæ­¥ã€‚</span><br><span class="line"></span><br><span class="line">### ä¿®æ”¹æ·»åŠ äº†â€œå®éªŒç›®åœ°â€ å’Œâ€œæ‹“æ‰‘ç¯å¢ƒâ€ ä¸¤ä¸ªé¡¹ç›®</span><br><span class="line"></span><br><span class="line">### å®éªŒç›®çš„</span><br><span class="line"></span><br><span class="line">å°† 192.168.1.167 çš„ &#x2F;handbook ç›®å½•ä¸‹çš„å†…å®¹å®æ—¶åŒæ­¥åˆ° 192.168.1.176 å®šä¹‰çš„ â€œhandbookâ€ ç›®å½•ä¸‹ï¼ˆå®éªŒç¯å¢ƒä¾æ—§é‡‡ç”¨ä¸Šé¢çš„è€ç¯å¢ƒï¼‰</span><br><span class="line"></span><br><span class="line">### æ‹“æ‰‘ç¯å¢ƒ</span><br><span class="line"></span><br><span class="line">![](2020-05-20-tec-linux&#x2F;06.png)</span><br><span class="line"></span><br><span class="line">### å®‰è£…</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">yum install-y inotify-tools</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šinotify å…¶å®ä¸éœ€è¦ä»»ä½•çš„é…ç½®ï¼Œå®‰è£…å¥½ä¹‹åé»˜è®¤æœ‰ä¸¤ä¸ªå‘½ä»¤;</p><blockquote><p>inotifywait : åœ¨è¢«ç›‘æ§çš„æ–‡ä»¶æˆ–ç›®å½•ä¸Šç­‰å¾…ç‰¹å®šæ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ï¼ˆopen close deleteç­‰ï¼‰å‘ç”Ÿ</p><p>inotifywatch :æ”¶é›†è¢«ç›‘æ§çš„æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨çš„ç»Ÿè®¡æ•°æ®,æŒ‡æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°ç»Ÿè®¡</p></blockquote><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><h4 id="æ£€æµ‹åˆ›å»ºäº‹ä»¶"><a href="#æ£€æµ‹åˆ›å»ºäº‹ä»¶" class="headerlink" title="æ£€æµ‹åˆ›å»ºäº‹ä»¶"></a>æ£€æµ‹åˆ›å»ºäº‹ä»¶</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inotifywait -mrq &#96;&#96;&#x2F;handbook&#x2F;cd&#x2F;handbook&#x2F;touch1</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/07.png" alt=""></p><h4 id="æ£€æµ‹åˆ é™¤äº‹ä»¶"><a href="#æ£€æµ‹åˆ é™¤äº‹ä»¶" class="headerlink" title="æ£€æµ‹åˆ é™¤äº‹ä»¶"></a>æ£€æµ‹åˆ é™¤äº‹ä»¶</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inotifywait -mrq &#x2F;handbook --timefmt &quot;%d-%m-%y %H:%M&quot; --format &quot;%T %w%f äº‹ ä»¶ æ¯: %e&quot; -e delete cd &#x2F;handbook&#x2F; rm -rf 1 4</span><br></pre></td></tr></table></figure><p><img src="2020-05-20-tec-linux/08.png" alt=""></p><h4 id="ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬"><a href="#ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬" class="headerlink" title="ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬"></a>ç¼–å†™å®æ—¶åŒæ­¥è„šæœ¬</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">more rsync-handbook.sh</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">inotifywait -mrq &#x2F;handbook&#x2F; --format &quot;%w%f&quot; -e create,delete,moved_to,close_write | while read line do rsync -az &#x2F;handbook&#x2F; rsync@192.168.1.176::handbook --password-file&#x3D;&#x2F;root&#x2F;handbook.pw done</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼š å…¶ä¸­â€“password-file æ˜¯æŒ‡å®š <code>handbook</code>æ¨¡å—è®¤ç”¨æˆ·è®¤è¯çš„å¯†ç æ–‡ä»¶</em></p><h3 id="éªŒè¯-1"><a href="#éªŒè¯-1" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p><img src="2020-05-20-tec-linux/09.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- MDTOC maxdepth:6 firsth1:1 numbering:0 flatten:0 bullets:1 updateOnSave:1 --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#rsyncä»‹ç»&quot;&gt;rsyncä»‹ç»&lt;/a&gt;   &lt;ul&gt;
&lt;li&gt;&lt;a hr
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Linux" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Linux/"/>
    
    
      <category term="Linux" scheme="http://www.toberoot.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡grepå‘½ä»¤å¸¸ç”¨æ–¹æ³•å¸¦æ–‡ä»¶åå’Œè¡Œæ•°</title>
    <link href="http://www.toberoot.com/news/2020/05/19/tec-linux/"/>
    <id>http://www.toberoot.com/news/2020/05/19/tec-linux/</id>
    <published>2020-05-19T10:24:00.000Z</published>
    <updated>2020-05-19T02:41:42.544Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>æ‰¾åˆ°æŒ‡å®šç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¸­åŒ…å«å­—ç¬¦<code>nav-item dropdown</code>çš„æ–‡ä»¶å’Œè¡Œæ•°ã€‚</p><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for i in $(find `pwd` -type f); do grep -H -n "2020-05-19" $i; done 2&gt; /dev/null</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;éœ€æ±‚&quot;&gt;&lt;a href=&quot;#éœ€æ±‚&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚&quot;&gt;&lt;/a&gt;éœ€æ±‚&lt;/h2&gt;&lt;p&gt;æ‰¾åˆ°æŒ‡å®šç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¸­åŒ…å«å­—ç¬¦&lt;code&gt;nav-item dropdown&lt;/code&gt;çš„æ–‡ä»¶å’Œè¡Œæ•°ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å‘½ä»¤&quot;
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Linux" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Linux/"/>
    
    
      <category term="Linux" scheme="http://www.toberoot.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linuxç³»ç»Ÿä¸€æ¬¡æ€§åŒæ­¥æ—¶é—´</title>
    <link href="http://www.toberoot.com/news/2020/05/14/tec-linux/"/>
    <id>http://www.toberoot.com/news/2020/05/14/tec-linux/</id>
    <published>2020-05-13T16:30:00.000Z</published>
    <updated>2020-05-13T08:31:58.187Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æµ‹è¯•æœåŠ¡å™¨ç‰©ç†æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´éƒ½ä¸æ­£ç¡®ï¼Œéœ€è¦è°ƒæ•´</p></blockquote><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… ntp </span></span><br><span class="line">yum install -y ntp</span><br><span class="line"><span class="comment"># åŒæ­¥é˜¿é‡Œäº‘æ—¶é—´åŒæ­¥æœåŠ¡å™¨</span></span><br><span class="line">ntpdate ntp1.aliyun.com</span><br><span class="line"><span class="comment"># ç‰©ç†æ—¶é—´åŒæ­¥ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line">hwclock -w</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;æµ‹è¯•æœåŠ¡å™¨ç‰©ç†æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´éƒ½ä¸æ­£ç¡®ï¼Œéœ€è¦è°ƒæ•´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ­¥éª¤&quot;&gt;&lt;a href=&quot;#æ­¥éª¤&quot; class=&quot;headerlink&quot; title=&quot;æ­¥éª¤&quot;&gt;&lt;/a&gt;æ­¥éª¤&lt;/h2&gt;&lt;figure class=&quot;
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Linux" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Linux/"/>
    
    
      <category term="CentOS" scheme="http://www.toberoot.com/tags/CentOS/"/>
    
      <category term="ntp" scheme="http://www.toberoot.com/tags/ntp/"/>
    
  </entry>
  
  <entry>
    <title>åˆ¶ä½œRedHatæ•™å­¦ç³»ç»Ÿè£…æœºUç›˜</title>
    <link href="http://www.toberoot.com/news/2020/05/13/tec-redhat/"/>
    <id>http://www.toberoot.com/news/2020/05/13/tec-redhat/</id>
    <published>2020-05-13T15:33:00.000Z</published>
    <updated>2020-05-13T07:35:23.562Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>çº¢å¸½å®˜æ–¹æ•™å­¦ç³»ç»Ÿ</p></blockquote><h2 id="æ ¼å¼åŒ–uç›˜"><a href="#æ ¼å¼åŒ–uç›˜" class="headerlink" title="æ ¼å¼åŒ–uç›˜"></a>æ ¼å¼åŒ–uç›˜</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@foundation0 ~]# mount |tail -n 1</span><br><span class="line">/dev/sdb1 on /run/media/kiosk/U type vfat (rw,nosuid,nodev,relatime,uid=1000,gid=1000,fmask=0022,dmask=0077,codepage=437,iocharset=ascii,shortname=mixed,showexec,utf8,flush,errors=remount-ro,uhelper=udisks2)</span><br><span class="line">[root@foundation0 ~]# umount /dev/sdb1</span><br><span class="line">[root@foundation0 ~]# partprobe /dev/sdb1</span><br><span class="line">[root@foundation0 ~]# mkfs.ext4 /dev/sdb1</span><br><span class="line">mke2fs 1.42.9 (28-Dec-2013)</span><br><span class="line">Filesystem label=</span><br><span class="line">OS type: Linux</span><br><span class="line">Block size=4096 (log=2)</span><br><span class="line">Fragment size=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">932064 inodes, 3722784 blocks</span><br><span class="line">186139 blocks (5.00%) reserved for the super user</span><br><span class="line">First data block=0</span><br><span class="line">Maximum filesystem blocks=2151677952</span><br><span class="line">114 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8176 inodes per group</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208</span><br><span class="line"></span><br><span class="line">Allocating group tables: done                            </span><br><span class="line">Writing inode tables: done                            </span><br><span class="line">Creating journal (32768 blocks): done</span><br><span class="line">Writing superblocks and filesystem accounting information: done</span><br></pre></td></tr></table></figure><h2 id="åˆ¶ä½œuç›˜å¯åŠ¨"><a href="#åˆ¶ä½œuç›˜å¯åŠ¨" class="headerlink" title="åˆ¶ä½œuç›˜å¯åŠ¨"></a>åˆ¶ä½œuç›˜å¯åŠ¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@foundation0 ~]# rht-usb usbformat /dev/sdb1</span><br><span class="line">INFO     Configuration file: /root/.icrm/config.yml</span><br><span class="line">INFO     Formatting USB Device: /dev/sdb1</span><br><span class="line">Confirm reformatting /dev/sdb1 (y/N) y</span><br><span class="line">INFO     mkfs.ext4 64-bit support</span><br><span class="line">INFO     /dev/sdb1: format OK</span><br><span class="line">INFO     Appear to have properly formatted USB device.</span><br><span class="line"></span><br><span class="line">[root@foundation0 ~]# cd /home/kiosk/booboo/cache</span><br><span class="line">[root@foundation0 cache]# ll</span><br><span class="line">total 4038772</span><br><span class="line">-rw------- 1 kiosk kiosk      27967 Mar  3  2016 ClassPrep-7.x-4.r35344.txt</span><br><span class="line">-rw------- 1 kiosk kiosk      16186 Mar  3  2016 ClassroomReset-7.x-4.r35344.txt</span><br><span class="line">-rw------- 1 kiosk kiosk      38605 Mar  3  2016 ClassroomSetup-7.x-4.r35344.txt</span><br><span class="line">-rw------- 1 kiosk kiosk      27054 Mar  3  2016 ClassroomTroubleshooting-7.x-4.r35344.txt</span><br><span class="line">-rw------- 1 kiosk kiosk      75892 Mar  3  2016 foundation0-config-7.x-4.r35344.noarch.rpm</span><br><span class="line">-rw------- 1 kiosk kiosk      27568 Mar  3  2016 foundation-config-7.x-4.r35344.noarch.rpm</span><br><span class="line">-rw------- 1 kiosk kiosk     189984 Mar  3  2016 redhat-survey-7.x-55.1.noarch.rpm</span><br><span class="line">-rw------- 1 kiosk kiosk   91254784 Mar  4  2016 rhci-foundation-7.2-4.r35344.iso</span><br><span class="line">-rw------- 1 kiosk kiosk       2775 May  9 11:02 RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf</span><br><span class="line">-rw------- 1 kiosk kiosk     621805 Oct 20  2014 RHEL7å’ŒCentOS7æ‰“å¼€å±å¹•VNC.pdf</span><br><span class="line">-rw------- 1 kiosk kiosk 4043309056 Mar  4  2016 rhel-server-7.2-x86_64-dvd.iso</span><br><span class="line">-rw------- 1 kiosk kiosk      96050 Mar  3  2016 rht-usb-7.x-4.r35344</span><br><span class="line"></span><br><span class="line">[root@foundation0 cache]# vim /root/.icrm/config.yml</span><br><span class="line">---</span><br><span class="line">repository: /root/.icrm/repository</span><br><span class="line">repository: /home/kiosk/booboo/cache</span><br><span class="line"></span><br><span class="line">[root@foundation0 cache]# rht-usb verify *.icmf</span><br><span class="line">INFO     Configuration file: /root/.icrm/config.yml</span><br><span class="line">INFO     Verifying Cache Directory: /home/kiosk/booboo/cache</span><br><span class="line"></span><br><span class="line">Verifying manifest file RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf</span><br><span class="line">  Publish date: 2016-02-24 20:43:25</span><br><span class="line">  type        md5sum  artifact-name</span><br><span class="line">  ----------- ------- -----------------------------------------------</span><br><span class="line">  content     CORRUPT rhel-server-7.2-x86_64-dvd.iso</span><br><span class="line">  content     GOODSUM foundation-config-7.x-4.r35344.noarch.rpm</span><br><span class="line">  content     GOODSUM foundation0-config-7.x-4.r35344.noarch.rpm</span><br><span class="line">  content     GOODSUM redhat-survey-7.x-55.1.noarch.rpm</span><br><span class="line">  content     GOODSUM rhci-foundation-7.2-4.r35344.iso</span><br><span class="line">  content     GOODSUM rht-usb-7.x-4.r35344</span><br><span class="line">  content     GOODSUM ClassroomSetup-7.x-4.r35344.txt</span><br><span class="line">  content     GOODSUM ClassroomReset-7.x-4.r35344.txt</span><br><span class="line">  content     GOODSUM ClassroomTroubleshooting-7.x-4.r35344.txt</span><br><span class="line">  content     GOODSUM ClassPrep-7.x-4.r35344.txt</span><br><span class="line">  content     GOODSUM RHEL7å’ŒCentOS7æ‰“å¼€å±å¹•VNC.pdf</span><br><span class="line">=====================================================================</span><br><span class="line">WARNING  Manifest RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf failed.</span><br><span class="line"></span><br><span class="line">WARNING  Verification FAILED - look above for problem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@foundation0 cache]# rht-usb usbadd RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf</span><br><span class="line">INFO     Configuration file: /root/.icrm/config.yml</span><br><span class="line">INFO     Adding to USB: RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf</span><br><span class="line">INFO     New files needed space is 3.9G out of 3.9G</span><br><span class="line">INFO     Calculation finds we need: 4135687726 bytes (3.9G)</span><br><span class="line">INFO     USB space Total: 14.2G  Used: 35.5M  Free: 13.4G</span><br><span class="line">INFO     Starting copy of RHCIfoundation-RHEL72-4.r35344.1-ILT-7-en_US.icmf</span><br><span class="line">INFO     Copying artifact: rhel-server-7.2-x86_64-dvd.iso</span><br><span class="line">INFO     Copying /home/kiosk/booboo/cache/rhel-server-7.2-x86_64-dvd.iso (3.8G) to /tmp/tmpKRYNm9/rhel7.2/x86_64/isos/rhel-server-7.2-x86_64-dvd.iso</span><br><span class="line"></span><br><span class="line">rht-usb usbmkboot</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;çº¢å¸½å®˜æ–¹æ•™å­¦ç³»ç»Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ ¼å¼åŒ–uç›˜&quot;&gt;&lt;a href=&quot;#æ ¼å¼åŒ–uç›˜&quot; class=&quot;headerlink&quot; title=&quot;æ ¼å¼åŒ–uç›˜&quot;&gt;&lt;/a&gt;æ ¼å¼åŒ–uç›˜&lt;/h2&gt;&lt;figure class=&quot;hig
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="RedHat" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/RedHat/"/>
    
    
      <category term="RedHat" scheme="http://www.toberoot.com/tags/RedHat/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0.16ä½¿ç”¨pt-online-schema-changeåœ¨çº¿æ·»åŠ ç´¢å¼•æŠ¥é”™å¤„ç†</title>
    <link href="http://www.toberoot.com/news/2020/05/12/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/05/12/tec-mysql/</id>
    <published>2020-05-12T12:59:00.000Z</published>
    <updated>2020-05-12T05:43:47.631Z</updated>
    
    <content type="html"><![CDATA[<!-- MDTOC maxdepth:6 firsth1:1 numbering:0 flatten:0 bullets:1 updateOnSave:1 --><ul><li><a href="#åœ¨çº¿mysql80ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥">åœ¨çº¿MySQL8.0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥</a>   <ul><li><a href="#æŠ¥é”™æ˜ç»†">æŠ¥é”™æ˜ç»†</a>   </li><li><a href="#è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</a>   </li><li><a href="#æµ‹è¯•ç¯å¢ƒ">æµ‹è¯•ç¯å¢ƒ</a>   <ul><li><a href="#mysqlæµ‹è¯•æ•°æ®">MySQLæµ‹è¯•æ•°æ®</a>   </li><li><a href="#pt-online-ddl">pt-online-ddl</a>   </li><li><a href="#æ‰§è¡Œç»“æœ">æ‰§è¡Œç»“æœ</a>   </li></ul></li><li><a href="#æ€»ç»“">æ€»ç»“</a>   </li></ul></li></ul><!-- /MDTOC --><h1 id="åœ¨çº¿MySQL8-0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥"><a href="#åœ¨çº¿MySQL8-0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥" class="headerlink" title="åœ¨çº¿MySQL8.0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥"></a>åœ¨çº¿MySQL8.0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥</h1><table><thead><tr><th align="left">è½¯ä»¶</th><th align="left">ç‰ˆæœ¬</th></tr></thead><tbody><tr><td align="left">mysql-server</td><td align="left">8.0.16</td></tr><tr><td align="left">pt-tools</td><td align="left">3.2.0</td></tr></tbody></table><h2 id="æŠ¥é”™æ˜ç»†"><a href="#æŠ¥é”™æ˜ç»†" class="headerlink" title="æŠ¥é”™æ˜ç»†"></a>æŠ¥é”™æ˜ç»†</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@node2 install]<span class="comment"># pt-online-schema-change --port=3306 --host=localhost --user=root --password=xxx --alter="add index TMS_LEG_IDS (ID,CHANGE_ORG_ID,FROM_RECEIVER_ID,TO_RECEIVER_ID,TO_REGIONZONE_ID)" D=wlyotwb,t=tms_leg_test --no-version-check --execute --charset=utf8</span></span><br><span class="line">No slaves found.  See --recursion-method <span class="keyword">if</span> host node2 has slaves.</span><br><span class="line">Not checking slave lag because no slaves were found and --check-slave-lag was not specified.</span><br><span class="line">Operation, tries, <span class="built_in">wait</span>:</span><br><span class="line">  analyze_table, 10, 1</span><br><span class="line">  copy_rows, 10, 0.25</span><br><span class="line">  create_triggers, 10, 1</span><br><span class="line">  drop_triggers, 10, 1</span><br><span class="line">  swap_tables, 10, 1</span><br><span class="line">  update_foreign_keys, 10, 1</span><br><span class="line">There is an error <span class="keyword">in</span> MySQL that makes the server to die when trying to rename a table with FKs. See https://bugs.mysql.com/bug.php?id=96145</span><br><span class="line">Since pt-online-schema change needs to rename the old &lt;-&gt; new tables as the final step, and the requested table has FKs, it cannot be executed under the current MySQL version</span><br></pre></td></tr></table></figure><p><a href="https://jira.percona.com/browse/PT-1782" rel="external nofollow noreferrer">https://jira.percona.com/browse/PT-1782</a></p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><ul><li>pt-toolsè½¯ä»¶ç‰ˆæœ¬ä½¿ç”¨ <code>3.0.13</code></li></ul><p>æˆ–è€…</p><ul><li><code>mysql-server</code>ç‰ˆæœ¬å‡çº§åˆ° <code>8.0.20</code></li></ul><h2 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h2><h3 id="MySQLæµ‹è¯•æ•°æ®"><a href="#MySQLæµ‹è¯•æ•°æ®" class="headerlink" title="MySQLæµ‹è¯•æ•°æ®"></a>MySQLæµ‹è¯•æ•°æ®</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> root@<span class="string">'localhost'</span> <span class="keyword">identified</span> <span class="keyword">WITH</span> mysql_native_password <span class="keyword">by</span> <span class="string">'Zyadmin123'</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> booboo;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> booboo.t1 (<span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> booboo.t1 <span class="keyword">values</span> (<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h3 id="pt-online-ddl"><a href="#pt-online-ddl" class="headerlink" title="pt-online-ddl"></a>pt-online-ddl</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum localinstall -y percona-toolkit-3.2.0-1.el7.x86_64.rpm</span><br><span class="line">pt-online-schema-change --port=3306 --host=localhost --user=root --password=Zyadmin123 --alter=<span class="string">"add column name varchar(22)"</span> D=booboo,t=t1 --no-version-check --execute --charset=utf8</span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œç»“æœ"><a href="#æ‰§è¡Œç»“æœ" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@node2 install]<span class="comment"># pt-online-schema-change --port=3306 --host=localhost --user=root --password=Zyadmin123 --alter="add column name varchar(22)" D=booboo,t=t1 --no-version-check --execute --charset=utf8</span></span><br><span class="line">No slaves found.  See --recursion-method <span class="keyword">if</span> host node2 has slaves.</span><br><span class="line">Not checking slave lag because no slaves were found and --check-slave-lag was not specified.</span><br><span class="line">Operation, tries, <span class="built_in">wait</span>:</span><br><span class="line">  analyze_table, 10, 1</span><br><span class="line">  copy_rows, 10, 0.25</span><br><span class="line">  create_triggers, 10, 1</span><br><span class="line">  drop_triggers, 10, 1</span><br><span class="line">  swap_tables, 10, 1</span><br><span class="line">  update_foreign_keys, 10, 1</span><br><span class="line">Altering `booboo`.`t1`...</span><br><span class="line">Creating new table...</span><br><span class="line">Created new table booboo._t1_new OK.</span><br><span class="line">Altering new table...</span><br><span class="line">Altered `booboo`.`_t1_new` OK.</span><br><span class="line">2020-05-12T21:26:08 Creating triggers...</span><br><span class="line">2020-05-12T21:26:08 Created triggers OK.</span><br><span class="line">2020-05-12T21:26:08 Copying approximately 1 rows...</span><br><span class="line">2020-05-12T21:26:08 Copied rows OK.</span><br><span class="line">2020-05-12T21:26:08 Analyzing new table...</span><br><span class="line">2020-05-12T21:26:09 Swapping tables...</span><br><span class="line">2020-05-12T21:26:09 Swapped original and new tables OK.</span><br><span class="line">2020-05-12T21:26:09 Dropping old table...</span><br><span class="line">2020-05-12T21:26:09 Dropped old table `booboo`.`_t1_old` OK.</span><br><span class="line">2020-05-12T21:26:09 Dropping triggers...</span><br><span class="line">2020-05-12T21:26:09 Dropped triggers OK.</span><br><span class="line">Successfully altered `booboo`.`t1`.</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸åŒçš„æ•°æ®åº“ç‰ˆæœ¬å¯¹åº”çš„ptå·¥å…·ç‰ˆæœ¬ä¼šæœ‰åŒºåˆ«ï¼Œå…·ä½“å¯ä»¥è®¿é—®<a href="https://www.percona.com/doc/percona-toolkit/LATEST/index.html" rel="external nofollow noreferrer">percona-toolkit</a></p><h3 id="v3-2-0-released-2019-04-20"><a href="#v3-2-0-released-2019-04-20" class="headerlink" title="v3.2.0 released 2019-04-20"></a>v3.2.0 released 2019-04-20</h3><p>Improvements:</p><ul><li><a href="https://jira.percona.com/browse/PT-1773" rel="external nofollow noreferrer">PT-1773</a>: Donâ€™t make the foreign key check in <code>pt-online-schema-change</code> if not needed.</li><li><a href="https://jira.percona.com/browse/PT-1757" rel="external nofollow noreferrer">PT-1757</a>: <code>pt-table-checksum</code> can now handle small tables as a single chunk.</li><li><a href="https://jira.percona.com/browse/PT-1813" rel="external nofollow noreferrer">PT-1813</a>: MariaDB 10.4 is now supported.</li></ul><p>Bug fixes:</p><ul><li><a href="https://jira.percona.com/browse/PT-1782" rel="external nofollow noreferrer">PT-1782</a>: <code>pt-online-schema-change</code> declined to handle tables because of foreign keys even when there were no foreign keys with some MariaDB 10.2 and MySQL 8 versions.</li><li><a href="https://jira.percona.com/browse/PT-1759" rel="external nofollow noreferrer">PT-1759</a>: <code>pt-stalk</code> with <code>--mysql-only</code> option didnâ€™t collect MySQL Status variables.</li><li><a href="https://jira.percona.com/browse/PT-1802" rel="external nofollow noreferrer">PT-1802</a>: <code>pt-online-schema-change</code> didnâ€™t handle self-referencing foreign keys properly which caused an unnecessarily high resource consumption.</li><li><a href="https://jira.percona.com/browse/PT-1766" rel="external nofollow noreferrer">PT-1766</a>: <code>pt-table-checksum</code> <code>DIFF_ROWS</code> was not computed correctly.</li><li><a href="https://jira.percona.com/browse/PT-1760" rel="external nofollow noreferrer">PT-1760</a>: <code>pt-online-schema-change</code> regression caused it to hang for a stopped replica when using replication channels on the slave.</li><li><a href="https://jira.percona.com/browse/PT-1707" rel="external nofollow noreferrer">PT-1707</a>: A number of the Percona Toolkit tools failed to operate in the IPv6 environment if the host address specified as a parameter was not enclosed in square brackets.</li><li><a href="https://jira.percona.com/browse/PT-1502" rel="external nofollow noreferrer">PT-1502</a>: <code>pt-online-schema-change</code> was not recognizing the slave with multi-source replication active.</li><li><a href="https://jira.percona.com/browse/PT-1824" rel="external nofollow noreferrer">PT-1824</a>: <code>pt-online-schema-change</code> allowed the name of a constraint to exceed 64 characters when <code>--alter-foreign-keys-method=rebuild_constraints</code> was used. (Thank you, Iwo Panowicz.)</li><li><a href="https://jira.percona.com/browse/PT-1765" rel="external nofollow noreferrer">PT-1765</a>: Documentation for <code>DIFF_ROWS</code> doesnâ€™t exist.</li><li><a href="https://jira.percona.com/browse/PT-297" rel="external nofollow noreferrer">PT-297</a>: <code>pt-online-schema-change</code> could break replication.</li><li><a href="https://jira.percona.com/browse/PT-1768" rel="external nofollow noreferrer">PT-1768</a>: Source code for <code>src/go/pt-mongodb-query-digest/pt-mongodb-query-digest</code> was missing in the official source tar ball.</li><li><a href="https://jira.percona.com/browse/PT-1576" rel="external nofollow noreferrer">PT-1576</a>: <code>pt-stalk</code> with ``â€“mysql-only<code>option was not adding MySQL</code>processlist` information to the output file.</li><li><a href="https://jira.percona.com/browse/PT-1793" rel="external nofollow noreferrer">PT-1793</a>: <code>pt-query-digest</code> was unable to handle the year 2020 because of wrong <code>tcpdump</code> parsing. (Thank you, Kei Tsuchiya.)</li></ul><h3 id="v3-0-13-released-2019-01-03"><a href="#v3-0-13-released-2019-01-03" class="headerlink" title="v3.0.13 released 2019-01-03"></a>v3.0.13 released 2019-01-03</h3><p>Improvements</p><ul><li><a href="https://jira.percona.com/browse/PT-1340" rel="external nofollow noreferrer">PT-1340</a>: <code>pt-stalk</code> now doesnâ€™t call <code>mysqladmin debug</code> command by default to avoid flooding in the error log when not needed. <code>CMD_MYSQLADMIN=&quot;mysqladmin debug&quot;</code> environment variable reverts <code>pt-stalk</code> to the previous way of operation.</li><li><a href="https://jira.percona.com/browse/PT-1637" rel="external nofollow noreferrer">PT-1637</a>: A new <code>--fail-on-stopped-replication</code> option allows <code>pt-table-checksum</code> to detect failing slave nodes.</li></ul><p>Fixed bugs</p><ul><li><a href="https://jira.percona.com/browse/PT-1673" rel="external nofollow noreferrer">PT-1673</a>: <code>pt-show-grants</code> was incompatible with MariaDB 10+ (thanks <a href="https://github.com/pysysops" rel="external nofollow noreferrer">Tim Birkett</a>)</li><li><a href="https://jira.percona.com/browse/PT-1638" rel="external nofollow noreferrer">PT-1638</a>: <code>pt-online-schema-change</code> was erroneously taking MariaDB 10.x for MySQL 8.0 and rejecting to work with it to avoid the upstream bug <a href="https://bugs.mysql.com/bug.php?id=89441" rel="external nofollow noreferrer">#89441</a> scope.</li><li><a href="https://jira.percona.com/browse/PT-1616" rel="external nofollow noreferrer">PT-1616</a>: <code>pt-table-checksum</code> failed to resume on large tables with binary strings containing invalid UTF-8 characters.</li><li><a href="https://jira.percona.com/browse/PT-1573" rel="external nofollow noreferrer">PT-1573</a>: <code>pt-query-digest</code> didnâ€™t work in case of <code>log_timestamps = SYSTEM</code> my.cnf option.</li><li><a href="https://jira.percona.com/browse/PT-1114" rel="external nofollow noreferrer">PT-1114</a>: <code>pt-table-checksum</code> failed when the table was empty.</li><li><a href="https://jira.percona.com/browse/PT-157" rel="external nofollow noreferrer">PT-157</a>: Specifying a non-primary key index with the <code>i</code> part of the <code>--source</code> argument made <code>pt-archiver</code> to ignore the <code>--primary-key-only</code> option presence.</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- MDTOC maxdepth:6 firsth1:1 numbering:0 flatten:0 bullets:1 updateOnSave:1 --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#åœ¨çº¿mysql80ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥&quot;&gt;åœ¨çº¿MySQL8.0ç»“æ„å˜æ›´é—®é¢˜æ’æŸ¥
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="åœ¨çº¿DDL" scheme="http://www.toberoot.com/tags/%E5%9C%A8%E7%BA%BFDDL/"/>
    
      <category term="é˜¿é‡Œäº‘" scheme="http://www.toberoot.com/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
      <category term="pt-online-schema-change" scheme="http://www.toberoot.com/tags/pt-online-schema-change/"/>
    
      <category term="Percona" scheme="http://www.toberoot.com/tags/Percona/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“å¤§è¡¨å¸¸ç”¨æ“ä½œè€—æ—¶è®°å½•</title>
    <link href="http://www.toberoot.com/news/2020/05/11/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/05/11/tec-mysql/</id>
    <published>2020-05-11T10:28:11.000Z</published>
    <updated>2020-05-11T04:05:53.794Z</updated>
    
    <content type="html"><![CDATA[<table><thead><tr><th align="center">å¤§è¡¨æ“ä½œ</th><th align="center">è¡¨å¤§å°</th><th align="center">ç´¢å¼•å¤§å°</th><th align="center">æ€»å¤§å°</th><th align="center">æ“ä½œè¡Œæ•°</th><th align="center">å®ä¾‹è§„æ ¼</th><th align="center">è€—æ—¶</th><th align="center">èµ„æºå½±å“</th></tr></thead><tbody><tr><td align="center">è¡¨å¤§å°</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">2.73 äº¿è¡Œ</td><td align="center">8æ ¸32G RDS</td><td align="center"></td><td align="center"></td></tr><tr><td align="center">åˆ›å»ºç´¢å¼•</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">4 äº¿</td><td align="center">8æ ¸32G RDS</td><td align="center">2å°æ—¶</td><td align="center"></td></tr><tr><td align="center">åˆ›å»ºç´¢å¼•</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">2.73 äº¿</td><td align="center">8æ ¸32G RDS</td><td align="center">27åˆ†é’Ÿ18.94ç§’</td><td align="center"></td></tr><tr><td align="center">æŸ¥è¯¢4æœˆä»½æ•°æ®</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">0.4 äº¿</td><td align="center">8æ ¸32G RDS</td><td align="center">1åˆ†13.62ç§’</td><td align="center"></td></tr><tr><td align="center">è®¡ç®—4æœˆä»½æ•°æ®</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">0.4 äº¿</td><td align="center">8æ ¸32G RDS</td><td align="center">çº¦25åˆ†é’Ÿ</td><td align="center"></td></tr><tr><td align="center">éœ€æ”¹åˆ—æ•°æ®ç±»å‹</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">8 äº¿</td><td align="center"></td><td align="center">14å°æ—¶16åˆ†é’Ÿ</td><td align="center">IOPSæ‰“æ»¡5000 CPUå†…å­˜æœ‰å°å¹…åº¦ä¸Šå‡</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;å¤§è¡¨æ“ä½œ&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;è¡¨å¤§å°&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;ç´¢å¼•å¤§å°&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;æ€»å¤§å°&lt;/th&gt;
&lt;th a
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="åœ¨çº¿DDL" scheme="http://www.toberoot.com/tags/%E5%9C%A8%E7%BA%BFDDL/"/>
    
      <category term="é˜¿é‡Œäº‘" scheme="http://www.toberoot.com/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
  </entry>
  
  <entry>
    <title>JIRAä¸­çš„å²è¯—ã€æ•…äº‹ã€ç‰ˆæœ¬ä¸å†²åˆº</title>
    <link href="http://www.toberoot.com/news/2020/05/06/tec-jira-md/"/>
    <id>http://www.toberoot.com/news/2020/05/06/tec-jira-md/</id>
    <published>2020-05-06T10:39:14.000Z</published>
    <updated>2020-05-06T02:41:50.527Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å²è¯—-æ•…äº‹-ç‰ˆæœ¬ä¸å†²åˆº"><a href="#å²è¯—-æ•…äº‹-ç‰ˆæœ¬ä¸å†²åˆº" class="headerlink" title="å²è¯—, æ•…äº‹, ç‰ˆæœ¬ä¸å†²åˆº"></a>å²è¯—, æ•…äº‹, ç‰ˆæœ¬ä¸å†²åˆº</h2><p>ã€€ã€€<br>è¿™å››é©¾é©¬è½¦èƒ½å¤Ÿä¼˜é›…åœ°ç®¡ç†æ•æ·è¿‡ç¨‹çš„èŒƒå›´å’Œæ—¶é—´è¡¨ã€‚å¹¶æ„å»ºå·¥ä½œã€‚</p><p>Jiraå²è¯—(Epic)æ˜¯ä¸€ä¸ªå¤§å‹ç”¨æˆ·æ•…äº‹ï¼Œæ ¹æ®å®¢æˆ·æˆ–æœ€ç»ˆç”¨æˆ·éœ€æ±‚åˆ†è§£ä¸ºè¾ƒå°çš„ä»»åŠ¡(ç”¨æˆ·æ•…äº‹)ã€‚</p><ul><li>æ ¹æ®å®¢æˆ·éœ€æ±‚ï¼Œæ ¹æ®éœ€è¦åœ¨å²è¯—ä¸­æ·»åŠ æˆ–åˆ é™¤ä»»åŠ¡ã€‚</li><li>Epicç”¨äºç»„ç»‡å·¥ä½œå’Œåˆ›å»ºå±‚æ¬¡ç»“æ„ã€‚ã€‚</li><li>Epicé€šè¿‡å°†æ›´å¤§çš„ä»»åŠ¡ç»„ç»‡æˆæ›´å°çš„ä»»åŠ¡æ¥ä¿æŒæ•æ·æ€§ã€‚ã€‚</li><li>Epicæ˜¯å·¥ä½œå±‚æ¬¡ç»“æ„çš„é¡¶å±‚ï¼Œå¼€å‘äººå‘˜ä½¿ç”¨å®ƒã€‚ã€‚</li><li>Epicæ˜¯æ›´å¤§çš„æ•…äº‹ï¼Œå…·æœ‰æ˜æ˜¾çš„å¼€å§‹å’Œç»“æŸã€‚ã€‚</li><li>Epicå¯ä»¥è·¨è¶Šå¤šä¸ªå†²åˆºï¼Œå³ï¼Œå²è¯—æ˜¯é€šè¿‡å¤šä¸ªå†²åˆºä¼ é€’çš„ã€‚ã€‚</li><li>Epicå¯ä»¥åŒ…å«æ•…äº‹ï¼Œé”™è¯¯å’Œä»»åŠ¡ï¼Œå¹¶å°†å®ƒä»¬åˆ†ç»„æˆä¸€ä¸ªå¤§æ•…äº‹ã€‚ã€‚</li><li>å½“EpicåŒ…å«æ•…äº‹ï¼Œé”™è¯¯æˆ–ä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰è¿™äº›é—®é¢˜ç±»å‹éƒ½è¡¨ç¤ºåœ¨Jiraçš„å±‚æ¬¡ç»“æ„ä¸­çš„åŒä¸€çº§åˆ«ã€‚ã€‚</li><li>æ•…äº‹ï¼Œé”™è¯¯ï¼Œä»»åŠ¡ä»£è¡¨å•ä»¶ä½œå“ï¼Œè€Œå²è¯—åˆ™æ˜¯ä¸€ç»„ç›¸å…³é—®é¢˜ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å²è¯—-æ•…äº‹-ç‰ˆæœ¬ä¸å†²åˆº&quot;&gt;&lt;a href=&quot;#å²è¯—-æ•…äº‹-ç‰ˆæœ¬ä¸å†²åˆº&quot; class=&quot;headerlink&quot; title=&quot;å²è¯—, æ•…äº‹, ç‰ˆæœ¬ä¸å†²åˆº&quot;&gt;&lt;/a&gt;å²è¯—, æ•…äº‹, ç‰ˆæœ¬ä¸å†²åˆº&lt;/h2&gt;&lt;p&gt;ã€€ã€€&lt;br&gt;è¿™å››é©¾é©¬è½¦èƒ½å¤Ÿä¼˜é›…åœ°ç®¡ç†æ•æ·è¿‡ç¨‹çš„èŒƒå›´å’Œæ—¶é—´è¡¨ã€‚
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="jira" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/jira/"/>
    
    
      <category term="jira" scheme="http://www.toberoot.com/tags/jira/"/>
    
      <category term="é¡¹ç›®ç®¡ç†" scheme="http://www.toberoot.com/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/"/>
    
      <category term="æ•æ·å¼€å‘" scheme="http://www.toberoot.com/tags/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>æ¯”æŠ€æœ¯æ›´é‡è¦çš„äº‹æƒ…</title>
    <link href="http://www.toberoot.com/news/2020/04/24/tec-rds-md/"/>
    <id>http://www.toberoot.com/news/2020/04/24/tec-rds-md/</id>
    <published>2020-04-24T11:44:33.000Z</published>
    <updated>2020-05-02T18:08:12.219Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><div class="jumbotron">  <h1 class="display-4">ä¸ä»¥è§„çŸ©ï¼Œä¸èƒ½æˆæ–¹åœ†</h1>  <p class="lead">å› ä¸€ä¸ªå¥½å¿ƒåŠåäº‹çš„æ‚²æƒ¨æ•…äº‹å¼•å‘çš„æ€è€ƒã€‚</p>  <hr class="my-4">  <p>  `æ•°æ®åº“ä»åˆ åº“è·‘è·¯` ç»å¸¸è¢«DBAã€è¿ç»´è°ƒä¾ƒã€‚å› ä¸ºè¿™ä¸ªæ“ä½œæ˜¯è‡´å‘½çš„ï¼<br/><ul><li>å¦‚æœä½ åœ¨ç”²æ–¹ï¼Œé‚£ä¹ˆèƒ½é‡åˆ°åˆ åº“è·‘è·¯çš„æœºä¼šè¿˜æ˜¯å¾ˆå°‘çš„ï¼Œä¸‰å¹´é‡åˆ°ä¸€æ¬¡é‚£éƒ½ç®—å¤šçš„ï¼›<br/></li><li>ä½†å¦‚æœä½ åœ¨ä¹™æ–¹ï¼Œé‚£ä¹ˆä¸€ä¸ªæœˆä¸€æ¬¡éƒ½ç®—å°‘çš„ã€‚ã€‚ã€‚<br/></li><li>åœ¨ä¹™æ–¹ï¼Œä¼šé‡åˆ°å¤§å…¬å¸ï¼Œå°å…¬å¸ï¼Œå¾®å‹å…¬å¸ğŸ˜‚ï¼›æœ‰è§„èŒƒçš„æ•°æ®åº“å¤‡ä»½ç­–ç•¥ï¼Œä¹Ÿæœ‰å‹æ ¹å„¿å°±ä¸çŸ¥å¤‡ä»½ä¸ºä½•ç‰©çš„ã€‚<br/></p><a class="btn btn-primary btn-lg" href="#" role="button">å‘¼åDBAæé«˜è‡ªèº«ä¿®å…»ï¼ŒéDBAä¹Ÿè¦æ“ä½œè°¨æ…ã€‚</a></div></li></ul><h3 id="å„ç§å¥‡è‘©çš„â€äººä¸ºè¯¯æ“ä½œâ€ï¼š"><a href="#å„ç§å¥‡è‘©çš„â€äººä¸ºè¯¯æ“ä½œâ€ï¼š" class="headerlink" title="å„ç§å¥‡è‘©çš„â€äººä¸ºè¯¯æ“ä½œâ€ï¼š"></a>å„ç§å¥‡è‘©çš„â€äººä¸ºè¯¯æ“ä½œâ€ï¼š</h3><ul><li>æŸæ–°é›¶å”®ç§‘æŠ€å…¬å¸-è‡ªå»ºMySQL5.7-è¯¯æ“ä½œ<code>Truncate</code>å¯¼è‡´ä¸šåŠ¡æ•…éšœ</li><li>æŸåŸºé‡‘å…¬å¸-é˜¿é‡Œäº‘RDS For MySQL5.7-è¯¯æ“ä½œ<code>Update</code>å¯¼è‡´ä¸šåŠ¡æ•°æ®é”™ä¹±</li><li>æŸåŒ–å¦†å“å…¬å¸-é˜¿é‡Œäº‘RDS For MySQL5.7-è¯¯æ“ä½œ<code>Alter</code>å¯¼è‡´ä¸šåŠ¡æ•°æ®é”™ä¹±</li><li>æŸå…¬å¸-è‡ªå»ºMySQL5.7-æ•°æ®åº“æœåŠ¡å™¨å› ç£ç›˜ç©ºé—´å¼‚å¸¸å®•æœºåè¯¯æ“ä½œ<code>rm -rf æ•°æ®åº“çš„æ•°æ®ç›®å½•</code>å¯¼è‡´æ•°æ®åº“æ— æ³•å¯åŠ¨</li><li>æŸé‡‘èå…¬å¸-è‡ªå»ºMySQL5.7-æ•°æ®åº“æœåŠ¡å™¨å¼‚å¸¸æ–­ç”µåæ•°æ®è¡¨ç©ºé—´æŸåï¼ˆæ•°æ®é‡2Tï¼‰</li></ul><h3 id="å„ç§å¥‡è‘©çš„â€å¤‡ä»½å¤±æ•ˆâ€"><a href="#å„ç§å¥‡è‘©çš„â€å¤‡ä»½å¤±æ•ˆâ€" class="headerlink" title="å„ç§å¥‡è‘©çš„â€å¤‡ä»½å¤±æ•ˆâ€"></a>å„ç§å¥‡è‘©çš„â€å¤‡ä»½å¤±æ•ˆâ€</h3><ul><li>æˆ‘ä»¥ä¸ºæˆ‘å¤‡ä»½äº†ï¼Œå…¶å®å¤‡ä»½è„šæœ¬å‹æ ¹å°±æ²¡æœ‰è·‘</li><li>æˆ‘ä»¥ä¸ºæˆ‘å¤‡ä»½äº†ï¼Œå…¶å®æœ€è¿‘ä¸€æ¬¡å¤‡ä»½æ˜¯ä¸€ä¸ªæœˆå‰</li><li>æˆ‘ä»¥ä¸ºæˆ‘å¤‡ä»½äº†ï¼Œå…¶å®ä¸ä»…æ²¡æœ‰å¤‡ä»½ï¼Œè¿binlogéƒ½æ²¡å¼€ï¼Œå¼€äº†ä¹Ÿæ²¡æœ‰è®¾ç½®rowæ ¼å¼ã€‚</li><li>æˆ‘ä»¥ä¸ºæˆ‘å¤‡ä»½äº†ï¼Œä¹Ÿå¼€äº†binlogæ—¥å¿—ï¼Œå…¶å®binlogæ—¥å¿—åªä¿ç•™1å¤©ï¼Œå…¨å¤‡ä»½æ˜¯7å¤©å‰çš„ã€‚</li><li>æˆ‘ä»¥ä¸ºæˆ‘çš„æ•°æ®ä¸é‡è¦ï¼Œæ²¡æœ‰å¤‡ä»½ï¼Œæˆ‘åˆ äº†ï¼Œä¸šåŠ¡å‘Šè¯‰æˆ‘æ•°æ®è¿˜è¦ã€‚</li></ul><p>ğŸ‘æ¬¢è¿è¡¥å……å¥‡è‘©å¤‡ä»½å¤±è´¥æ¡ˆä¾‹ã€‚</p><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>ä»Šå¤©æˆ‘ä»¬é‡åˆ°çš„æ¡ˆä¾‹æ˜¯ä¸€ä¸ªå¥½å¿ƒåŠåäº‹çš„æ‚²æƒ¨æ•…äº‹ã€‚</p><p>æˆ‘ä»¬æš‚ä¸”ç§°ä¸»äººå…¬å«å°Aå§ï½</p><p>å°Aæœ€è¿‘åœ¨åšä¸€ä¸ªé¡¹ç›®ï¼šé˜¿é‡Œäº‘é‡‘èäº‘ä¸Šå°†UATç¯å¢ƒçš„ä¸šåŠ¡P ä»æ·±åœ³ï¼ˆåå—2ï¼‰è¿ç§»åˆ° ï¼ˆä¸Šæµ·ï¼‰åä¸œ2ã€‚</p><p>æ•…äº‹çš„æ—¶é—´çº¿ğŸ§µå¦‚ä¸‹ï¼š</p><ul><li>2020å¹´4æœˆ22æ—¥æ™šï¼šä¸šåŠ¡åº”ç”¨å·²ç»è¿ç§»åˆ°äº†ä¸Šæµ·ï¼Œæ•°æ®åº“ä¹Ÿè¿ç§»è¿‡å»äº†ï¼Œä½†æ˜¯ä¸šåŠ¡å¿˜è®°åˆ‡æ¢æ•°æ®åº“äº†ï¼ˆè¿™é‡Œæœ‰å‘ğŸŒï¼‰ã€‚</li><li>2020å¹´4æœˆ23æ—¥æ™š7ç‚¹57åˆ†ï¼šä¸šåŠ¡åé¦ˆæ— æ³•è®¿é—®æ•°æ®åº“</li><li>2020å¹´4æœˆ23æ—¥æ™š7ç‚¹58åˆ†ï¼šè¿ç»´å°Aåé¦ˆï¼šâ€æˆ‘ä»¥ä¸ºä¸šåŠ¡å·²ç»åˆ‡äº†ï¼Œå°±å°†æ·±åœ³çš„æ•°æ®åº“å®ä¾‹çš„ ä¸šåŠ¡è´¦å·å’Œdb1åº“å’Œdb2åº“ éƒ½åœ¨æ§åˆ¶å°ä¸Šåˆ é™¤äº†â€</li><li>2020å¹´4æœˆ23æ—¥æ™š8ç‚¹00åˆ†ï¼šè¿ç»´åŒå­¦å‘ç°ï¼šä¸šåŠ¡è¿˜è¿ç€æ·±åœ³çš„åº“ï¼Œå‹æ ¹æ²¡åˆ‡åˆ°ä¸Šæµ·å»ã€‚</li></ul><h3 id="ä¸‰é—®å°A"><a href="#ä¸‰é—®å°A" class="headerlink" title="ä¸‰é—®å°A"></a>ä¸‰é—®å°A</h3><div class="alert alert-success" role="alert">é—®ï¼šæ˜¯è°å‘å‡ºäº†æŒ‡ä»¤è¦æ±‚å°Aå»åˆ ç”¨æˆ·åˆ åº“ï¼Ÿ<br/>å›ç­”ï¼š æ²¡æœ‰äºº</div><div class="alert alert-success" role="alert">é—®ï¼šæ²¡æœ‰äººè®©ä½ åšï¼Œä½ ä¸ºä»€ä¹ˆè¦åšï¼Ÿ<br/>å›ç­”ï¼šæˆ‘ä»¥ä¸ºä¸šåŠ¡å·²ç»æ­£å¸¸è¿ç§»èµ°äº†ï¼Œä¸éœ€è¦äº†ï¼Œå¯ä»¥é‡Šæ”¾ç©ºé—´ï¼Œæ‰€ä»¥å°±åšäº†ã€‚</div><div class="alert alert-success" role="alert">é—®ï¼šä½ çŸ¥é“å…¬å¸çš„æµç¨‹è§„èŒƒå—ï¼Ÿ<br/>å›ç­”ï¼šçŸ¥é“ï¼Œä½†æ˜¯è¿˜æ˜¯åšäº†ã€‚</div><h3 id="æ•…äº‹åˆ†æ"><a href="#æ•…äº‹åˆ†æ" class="headerlink" title="æ•…äº‹åˆ†æ"></a>æ•…äº‹åˆ†æ</h3><p>æ•…äº‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ</p><div class="alert alert-warning" role="alert">"ä¸ä»¥è§„çŸ©ï¼Œä¸èƒ½æˆæ–¹åœ†" â€”â€” å­Ÿå­<br/><hr/>1. è¿ç§»UATç¯å¢ƒï¼Œä»¥ä¸ºéç”Ÿäº§ç¯å¢ƒä¸éœ€è¦è§„èŒƒåŒ–æ“ä½œï¼Œå› æ­¤è¿ç§»æ²¡æœ‰åƒç”Ÿäº§ç¯å¢ƒé‚£æ ·ä¸¥æ ¼æŒ‰ç…§è¿ç§»è§„èŒƒæ“ä½œï¼Œç¼ºå°‘äº†åº”ç”¨è¿ç§»çš„é¢„æ¼”å’ŒéªŒè¯ã€‚<br/>2. è¿ç»´åŒå­¦å°Aï¼Œä¸ºäº†èŠ‚çº¦æ·±åœ³çš„èµ„æºç©ºé—´ï¼Œè‡ªä½œä¸»å¼ å»åˆ ç”¨æˆ·ï¼Œåˆ åº“ï¼Œç¼ºå°‘äº†è¿ç»´è§„èŒƒçš„çº¦æŸï¼Œæ˜¯ä¸çŸ¥é“è§„èŒƒï¼Ÿè¿˜æ˜¯çº¦æŸåŠ›ä¸å¤Ÿï¼Ÿ<br/>åœ¨ä¼ä¸šä¸­æ²¡æœ‰å¥½å¿ƒï¼Œåªæœ‰è§„èŒƒå’Œæµç¨‹ã€‚</div><h2 id="æ•‘æ´æ­¥éª¤"><a href="#æ•‘æ´æ­¥éª¤" class="headerlink" title="æ•‘æ´æ­¥éª¤"></a>æ•‘æ´æ­¥éª¤</h2><div class="alert alert-info" role="alert">  1. ç¡®è®¤è¯¯æ“ä½œå‰çš„æ—¶é—´ç‚¹<br/>  2. é˜¿é‡Œäº‘æ§åˆ¶å°é€šè¿‡å•åº“é€»è¾‘å¤‡ä»½+æ—¶é—´ç‚¹çš„æ–¹å¼æ¢å¤åˆ°æ–°å®ä¾‹<br/>  3. è¡¥äº‹åŠ¡<br/>  4. DTSæˆ–é€»è¾‘å¯¼å…¥æºå®ä¾‹<br/></div><p>  <a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">    è¡¥äº‹åŠ¡å…·ä½“æ­¥éª¤  </a>  <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample">    ä¸€äº›é˜¿é‡Œçš„å‘  </button></p><div class="collapse" id="collapseExample">  <div class="card card-body">    1. è§£æbinlogæ—¥å¿—ï¼Œç¡®å®šè¯¯æ“ä½œçš„ä¸¤ä¸ªæ—¶é—´ç‚¹(å…ˆååˆ é™¤äº†ä¸¤ä¸ªåº“ğŸ‚)<br/>    2. ä»å¤‡ä»½æ¢å¤çš„æ—¶é—´ç‚¹å¼€å§‹æ¢å¤æ—¥å¿—ï¼Œå¹¶è·³è¿‡è¯¯æ“ä½œ<br/>    3. å¯¼å…¥æµ‹è¯•å®ä¾‹ï¼ŒéªŒè¯è¡¨è¡Œæ•°ï¼Œå¼€å‘ä¾§éªŒè¯æ•°æ®<br/>  </div></div><div class="collapse" id="collapseExample2">  <div class="card card-body">    1. å®ä¾‹å¼€ä¸å‡ºæ¥ï¼Œæœ€ç»ˆé€‰æ‹©äº†ä¸€å°å·²å­˜åœ¨çš„æµ‹è¯•å®ä¾‹<br/>    2. 200Mçš„æ•°æ®é‡é€šè¿‡æ§åˆ¶å°æ¢å¤åˆ°æŒ‡å®šæ—¶é—´ç‚¹è€—æ—¶è¾ƒé•¿2å°æ—¶<br/>  </div></div><h2 id="é˜¿é‡Œäº‘RDS-For-MySQLå¸¸ç”¨æ¢å¤æ–¹æ³•"><a href="#é˜¿é‡Œäº‘RDS-For-MySQLå¸¸ç”¨æ¢å¤æ–¹æ³•" class="headerlink" title="é˜¿é‡Œäº‘RDS For MySQLå¸¸ç”¨æ¢å¤æ–¹æ³•"></a>é˜¿é‡Œäº‘RDS For MySQLå¸¸ç”¨æ¢å¤æ–¹æ³•</h2><h3 id="æ“ä½œè§„èŒƒ"><a href="#æ“ä½œè§„èŒƒ" class="headerlink" title="æ“ä½œè§„èŒƒ"></a>æ“ä½œè§„èŒƒ</h3><div class="accordion" id="accordionExample">  <div class="card">    <div class="card-header" id="headingOne">      <h2 class="mb-0">        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">          ä¸å®¢æˆ·æ²Ÿé€šæ•…éšœæ—¶é—´        </button>      </h2>    </div>    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">      <div class="card-body">            * è¯¯æ“ä½œäººåªèƒ½çŸ¥é“å¤§è‡´çš„è¯¯æ“ä½œæ—¶é—´<br>            * æ ¹æ®å¤§è‡´æ—¶é—´è¿‡æ»¤æ•°æ®<br>            * æ ¹æ®æ•°æ®é‡å–è¯¯æ“ä½œå‰åå¤šé•¿æ—¶é—´ï¼ˆé»˜è®¤10åˆ†é’Ÿï¼‰<br>      </div>    </div>  </div>  <div class="card">    <div class="card-header" id="headingTwo">      <h2 class="mb-0">        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">          ä¸å®¢æˆ·æ²Ÿé€šè¯¯æ“ä½œçš„å†…å®¹        </button>      </h2>    </div>    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">      <div class="card-body">            * è¯¯æ“ä½œè¡¨<br>            * è¯¯æ“ä½œæ‰§è¡Œè¯­å¥<br>      </div>    </div>  </div>  <div class="card">    <div class="card-header" id="headingThree">      <h2 class="mb-0">        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">         å°†æ‰§è¡ŒæœåŠ¡å™¨ECSå…è®¸è¿æ¥MySQL        </button>      </h2>    </div>    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">      <div class="card-body">            * è‡ªå»ºæ•°æ®åº“æˆæƒ<br>            * RDSæ·»åŠ ç™½åå•<br>      </div>    </div>  </div>  <div class="card">    <div class="card-header" id="headingFour">      <h2 class="mb-0">        <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">         åˆ©ç”¨å·¥å…·ç´§æ€¥æ•‘æ´        </button>      </h2>    </div>    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">      <div class="card-body">            * è·å–è¯¯æ“ä½œSQLæ‰§è¡Œå…·ä½“æ—¶é—´<br>            * è·å–è¯¯æ“ä½œSQLæ‰§è¡Œå…·ä½“ä½ç½®<br>            * å…¨å¤‡ä»½æ¢å¤+è§£æSQL<br>            * è§£æSQL+å›æ»šSQL<br>    </div>    </div>  </div></div><h3 id="æ“ä½œå·¥å…·"><a href="#æ“ä½œå·¥å…·" class="headerlink" title="æ“ä½œå·¥å…·"></a>æ“ä½œå·¥å…·</h3><img src='https://i.loli.net/2020/04/24/NkIwmhsDJV5dAEK.jpg' alt='NkIwmhsDJV5dAEK'/><h4 id="é˜¿é‡Œäº‘å·¥å…·"><a href="#é˜¿é‡Œäº‘å·¥å…·" class="headerlink" title="é˜¿é‡Œäº‘å·¥å…·"></a>é˜¿é‡Œäº‘å·¥å…·</h4><p>ä¸å¾—ä¸è¯´é˜¿é‡Œäº‘çš„æ­£å‘æ¢å¤å·¥å…·è¶Šæ¥è¶Šå®Œå–„ï¼Œç›®å‰å·²æ”¯æŒï¼š</p><ol><li>å…¨åº“ç‰©ç†å¤‡ä»½+binlog æ¢å¤æ–¹å¼ï¼šæ§åˆ¶å°-å…‹éš†å®ä¾‹-æŒ‡å®šå¤‡ä»½é›†/æŒ‡å®šæ—¶é—´ç‚¹</li><li>å•åº“é€»è¾‘å¤‡ä»½+binlog æ¢å¤æ–¹å¼ï¼šæ§åˆ¶å°-å¤‡ä»½æ¢å¤-å•åº“æ¢å¤-æŒ‡å®šå¤‡ä»½é›†/æŒ‡å®šæ—¶é—´ç‚¹/æŒ‡å®šæ¢å¤ç›®æ ‡ï¼ˆæ–°å®ä¾‹ï¼Œæœ¬å®ä¾‹ä¸åŒåº“åï¼‰</li></ol><p>å¦å¤–é˜¿é‡Œè¿˜æä¾›é¢å¤–ä»˜è´¹çš„DBSå¤‡ä»½å·¥å…·ï¼ˆé€»è¾‘å¤‡ä»½ï¼‰ï¼šå•åº“/å…¨åº“ ä¸€é”®æ¢å¤åˆ°æŒ‡å®šæ—¶é—´ç‚¹</p><h2 id="å¼€æºå·¥å…·-binlog2sqlå·¥å…·"><a href="#å¼€æºå·¥å…·-binlog2sqlå·¥å…·" class="headerlink" title="å¼€æºå·¥å…·-binlog2sqlå·¥å…·"></a>å¼€æºå·¥å…·-binlog2sqlå·¥å…·</h2><p>ä»MySQL binlogè§£æå‡ºä½ è¦çš„SQLã€‚æ ¹æ®ä¸åŒé€‰é¡¹ï¼Œä½ å¯ä»¥å¾—åˆ°åŸå§‹SQLã€å›æ»šSQLã€å»é™¤ä¸»é”®çš„INSERT SQLç­‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;&lt;a href=&quot;#å†™åœ¨å‰é¢&quot; class=&quot;headerlink&quot; title=&quot;å†™åœ¨å‰é¢&quot;&gt;&lt;/a&gt;å†™åœ¨å‰é¢&lt;/h2&gt;&lt;div class=&quot;jumbotron&quot;&gt;
  &lt;h1 class=&quot;display-4&quot;&gt;ä¸ä»¥è§„çŸ©ï¼Œä¸èƒ½æˆæ–¹åœ†&lt;/h1&gt;
 
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="æŠ€æœ¯æ€è€ƒ" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/%E6%8A%80%E6%9C%AF%E6%80%9D%E8%80%83/"/>
    
    
      <category term="ç´§æ€¥æ•‘æ´" scheme="http://www.toberoot.com/tags/%E7%B4%A7%E6%80%A5%E6%95%91%E6%8F%B4/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>å¼€æºå·¥å…·-binlog2sqlå·¥å…·</title>
    <link href="http://www.toberoot.com/news/2020/04/24/tec-mysql/"/>
    <id>http://www.toberoot.com/news/2020/04/24/tec-mysql/</id>
    <published>2020-04-24T10:44:33.000Z</published>
    <updated>2020-04-24T05:54:27.062Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€æºå·¥å…·-binlog2sqlå·¥å…·"><a href="#å¼€æºå·¥å…·-binlog2sqlå·¥å…·" class="headerlink" title="å¼€æºå·¥å…·-binlog2sqlå·¥å…·"></a>å¼€æºå·¥å…·-binlog2sqlå·¥å…·</h2><p>ä»MySQL binlogè§£æå‡ºä½ è¦çš„SQLã€‚æ ¹æ®ä¸åŒé€‰é¡¹ï¼Œä½ å¯ä»¥å¾—åˆ°åŸå§‹SQLã€å›æ»šSQLã€å»é™¤ä¸»é”®çš„INSERT SQLç­‰ã€‚</p><h3 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h3><ul><li>æ•°æ®å¿«é€Ÿå›æ»šï¼ˆé—ªå›ï¼‰</li><li>ä¸»ä»åˆ‡æ¢åmasterä¸¢æ•°æ®çš„ä¿®å¤</li><li>ä»binlogç”Ÿæˆæ ‡å‡†SQLï¼Œå¸¦æ¥çš„è¡ç”ŸåŠŸèƒ½</li></ul><h3 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h3><ul><li>mysql serverå¿…é¡»å¼€å¯ï¼Œç¦»çº¿æ¨¡å¼ä¸‹ä¸èƒ½è§£æ</li><li>å‚æ•° binlog_row_image å¿…é¡»ä¸ºFULLï¼Œæš‚ä¸æ”¯æŒMINIMAL</li><li>è§£æé€Ÿåº¦ä¸å¦‚mysqlbinlog</li></ul><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># centos7</span></span><br><span class="line"><span class="comment"># python2.7</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/danfengcao/binlog2sql.git &amp;&amp; <span class="built_in">cd</span> binlog2sql</span><br><span class="line">yum -y install epel-release</span><br><span class="line">yum -y install python-pip</span><br><span class="line">pip install --upgrade pip</span><br><span class="line">pip install -r requirements.txt </span><br></pre></td></tr></table></figure><h3 id="å¯¹MySQLçš„ä½¿ç”¨é™åˆ¶"><a href="#å¯¹MySQLçš„ä½¿ç”¨é™åˆ¶" class="headerlink" title="å¯¹MySQLçš„ä½¿ç”¨é™åˆ¶"></a>å¯¹MySQLçš„ä½¿ç”¨é™åˆ¶</h3><p>MySQL serverå¿…é¡»è®¾ç½®ä»¥ä¸‹å‚æ•°:</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">server_id = 1</span><br><span class="line">log_bin = /var/log/mysql/mysql-bin.log</span><br><span class="line">max_binlog_size = 1G</span><br><span class="line">binlog_format = row</span><br><span class="line">binlog_row_image = full</span><br></pre></td></tr></table></figure><p>useréœ€è¦çš„æœ€å°æƒé™é›†åˆï¼š</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span>, super/<span class="keyword">replication</span> <span class="keyword">client</span>, <span class="keyword">replication</span> <span class="keyword">slave</span></span><br></pre></td></tr></table></figure><p>å»ºè®®æˆæƒ</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">REPLICATION</span> <span class="keyword">SLAVE</span>, <span class="keyword">REPLICATION</span> <span class="keyword">CLIENT</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> </span><br></pre></td></tr></table></figure><h2 id="binlog2sqlå¸®åŠ©"><a href="#binlog2sqlå¸®åŠ©" class="headerlink" title="binlog2sqlå¸®åŠ©"></a>binlog2sqlå¸®åŠ©</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqlè¿æ¥é…ç½®</span><br><span class="line">-h host; -P port; -u user; -p password</span><br><span class="line">è§£ææ¨¡å¼</span><br><span class="line">--stop-never æŒç»­åŒæ­¥binlogã€‚å¯é€‰ã€‚ä¸åŠ åˆ™åŒæ­¥è‡³æ‰§è¡Œå‘½ä»¤æ—¶æœ€æ–°çš„binlogä½ç½®ã€‚</span><br><span class="line">-K, --no-primary-key å¯¹INSERTè¯­å¥å»é™¤ä¸»é”®ã€‚å¯é€‰ã€‚</span><br><span class="line">-B, --flashback ç”Ÿæˆå›æ»šè¯­å¥ï¼Œå¯è§£æå¤§æ–‡ä»¶ï¼Œä¸å—å†…å­˜é™åˆ¶ï¼Œæ¯æ‰“å°ä¸€åƒè¡ŒåŠ ä¸€å¥SLEEP SELECT(1)ã€‚å¯é€‰ã€‚ä¸stop-neveræˆ–no-primary-keyä¸èƒ½åŒæ—¶æ·»åŠ ã€‚</span><br><span class="line">è§£æèŒƒå›´æ§åˆ¶</span><br><span class="line">--start-file èµ·å§‹è§£ææ–‡ä»¶ã€‚å¿…é¡»ã€‚</span><br><span class="line">--start-position/--start-pos start-fileçš„èµ·å§‹è§£æä½ç½®ã€‚å¯é€‰ã€‚é»˜è®¤ä¸ºstart-fileçš„èµ·å§‹ä½ç½®ã€‚</span><br><span class="line">--stop-file/--end-file æœ«å°¾è§£ææ–‡ä»¶ã€‚å¯é€‰ã€‚é»˜è®¤ä¸ºstart-fileåŒä¸€ä¸ªæ–‡ä»¶ã€‚è‹¥è§£ææ¨¡å¼ä¸ºstop-neverï¼Œæ­¤é€‰é¡¹å¤±æ•ˆã€‚</span><br><span class="line">--stop-position/--end-pos stop-fileçš„æœ«å°¾è§£æä½ç½®ã€‚å¯é€‰ã€‚é»˜è®¤ä¸ºstop-fileçš„æœ€æœ«ä½ç½®ï¼›è‹¥è§£ææ¨¡å¼ä¸ºstop-neverï¼Œæ­¤é€‰é¡¹å¤±æ•ˆã€‚</span><br><span class="line">--start-datetime ä»å“ªä¸ªæ—¶é—´ç‚¹çš„binlogå¼€å§‹è§£æï¼Œæ ¼å¼å¿…é¡»ä¸ºdatetimeï¼Œå¦‚<span class="string">'2016-11-11 11:11:11'</span>ã€‚å¯é€‰ã€‚é»˜è®¤ä¸è¿‡æ»¤ã€‚</span><br><span class="line">--stop-datetime åˆ°å“ªä¸ªæ—¶é—´ç‚¹çš„binlogåœæ­¢è§£æï¼Œæ ¼å¼å¿…é¡»ä¸ºdatetimeï¼Œå¦‚<span class="string">'2016-11-11 11:11:11'</span>ã€‚å¯é€‰ã€‚é»˜è®¤ä¸è¿‡æ»¤ã€‚</span><br><span class="line">å¯¹è±¡è¿‡æ»¤</span><br><span class="line">-d, --databases åªè¾“å‡ºç›®æ ‡dbçš„sqlã€‚å¯é€‰ã€‚é»˜è®¤ä¸ºç©ºã€‚</span><br><span class="line">-t, --tables åªè¾“å‡ºç›®æ ‡tablesçš„sqlã€‚å¯é€‰ã€‚é»˜è®¤ä¸ºç©ºã€‚</span><br></pre></td></tr></table></figure><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><h4 id="è§£ææ ‡å‡†SQL"><a href="#è§£ææ ‡å‡†SQL" class="headerlink" title="è§£ææ ‡å‡†SQL"></a>è§£ææ ‡å‡†SQL</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python binlog2sql.py -h127.0.0.1 -P3306 -uroot -dhjxdb -t user --start-file=<span class="string">'mysql-bin.000001'</span> --start-datetime=<span class="string">'2017-09-14 13:50:00'</span> --stop-datetime=<span class="string">'2017-09-14 14:10:00'</span></span><br></pre></td></tr></table></figure><h3 id="è§£æå‡ºå›æ»šSQL"><a href="#è§£æå‡ºå›æ»šSQL" class="headerlink" title="è§£æå‡ºå›æ»šSQL"></a>è§£æå‡ºå›æ»šSQL</h3><ul><li><code>-B</code>: å‚æ•°ä»£è¡¨å›æ»š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python binlog2sql.py -h127.0.0.1 -P3306 -uroot -dhjxdb -t user --start-file=<span class="string">'mysql-bin.000001'</span> --start-position=4946 --stop-position=5921 -B </span><br></pre></td></tr></table></figure><p>å·¥å…·æ˜¯ç»™äººç”¨çš„ï¼Œå…³é”®è¿˜å¾—æœ‰æ€è·¯ã€‚åŠ æ²¹â›½ï¸</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¼€æºå·¥å…·-binlog2sqlå·¥å…·&quot;&gt;&lt;a href=&quot;#å¼€æºå·¥å…·-binlog2sqlå·¥å…·&quot; class=&quot;headerlink&quot; title=&quot;å¼€æºå·¥å…·-binlog2sqlå·¥å…·&quot;&gt;&lt;/a&gt;å¼€æºå·¥å…·-binlog2sqlå·¥å…·&lt;/h2&gt;&lt;p&gt;ä»MySQL bin
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="ç´§æ€¥æ•‘æ´" scheme="http://www.toberoot.com/tags/%E7%B4%A7%E6%80%A5%E6%95%91%E6%8F%B4/"/>
    
      <category term="binlog2sql" scheme="http://www.toberoot.com/tags/binlog2sql/"/>
    
  </entry>
  
</feed>
